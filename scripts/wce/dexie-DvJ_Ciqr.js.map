{"version":3,"file":"dexie-DvJ_Ciqr.js","sources":["../node_modules/dexie/dist/dexie.mjs"],"sourcesContent":["/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version 4.0.5, Sat May 25 2024\n *\n * https://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n \n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nvar extendStatics = function(d, b) {\n    extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n    return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n    if (typeof b !== \"function\" && b !== null)\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function() {\n    __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nfunction __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nvar _global = typeof globalThis !== 'undefined' ? globalThis :\n    typeof self !== 'undefined' ? self :\n        typeof window !== 'undefined' ? window :\n            global;\n\nvar keys = Object.keys;\nvar isArray = Array.isArray;\nif (typeof Promise !== 'undefined' && !_global.Promise) {\n    _global.Promise = Promise;\n}\nfunction extend(obj, extension) {\n    if (typeof extension !== 'object')\n        return obj;\n    keys(extension).forEach(function (key) {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\nvar getProto = Object.getPrototypeOf;\nvar _hasOwn = {}.hasOwnProperty;\nfunction hasOwn(obj, prop) {\n    return _hasOwn.call(obj, prop);\n}\nfunction props(proto, extension) {\n    if (typeof extension === 'function')\n        extension = extension(getProto(proto));\n    (typeof Reflect === \"undefined\" ? keys : Reflect.ownKeys)(extension).forEach(function (key) {\n        setProp(proto, key, extension[key]);\n    });\n}\nvar defineProperty = Object.defineProperty;\nfunction setProp(obj, prop, functionOrGetSet, options) {\n    defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n        { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } :\n        { value: functionOrGetSet, configurable: true, writable: true }, options));\n}\nfunction derive(Child) {\n    return {\n        from: function (Parent) {\n            Child.prototype = Object.create(Parent.prototype);\n            setProp(Child.prototype, \"constructor\", Child);\n            return {\n                extend: props.bind(null, Child.prototype)\n            };\n        }\n    };\n}\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nfunction getPropertyDescriptor(obj, prop) {\n    var pd = getOwnPropertyDescriptor(obj, prop);\n    var proto;\n    return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n}\nvar _slice = [].slice;\nfunction slice(args, start, end) {\n    return _slice.call(args, start, end);\n}\nfunction override(origFunc, overridedFactory) {\n    return overridedFactory(origFunc);\n}\nfunction assert(b) {\n    if (!b)\n        throw new Error(\"Assertion Failed\");\n}\nfunction asap$1(fn) {\n    if (_global.setImmediate)\n        setImmediate(fn);\n    else\n        setTimeout(fn, 0);\n}\nfunction arrayToObject(array, extractor) {\n    return array.reduce(function (result, item, i) {\n        var nameAndValue = extractor(item, i);\n        if (nameAndValue)\n            result[nameAndValue[0]] = nameAndValue[1];\n        return result;\n    }, {});\n}\nfunction getByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string' && hasOwn(obj, keyPath))\n        return obj[keyPath];\n    if (!keyPath)\n        return obj;\n    if (typeof keyPath !== 'string') {\n        var rv = [];\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            var val = getByKeyPath(obj, keyPath[i]);\n            rv.push(val);\n        }\n        return rv;\n    }\n    var period = keyPath.indexOf('.');\n    if (period !== -1) {\n        var innerObj = obj[keyPath.substr(0, period)];\n        return innerObj == null ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n    }\n    return undefined;\n}\nfunction setByKeyPath(obj, keyPath, value) {\n    if (!obj || keyPath === undefined)\n        return;\n    if ('isFrozen' in Object && Object.isFrozen(obj))\n        return;\n    if (typeof keyPath !== 'string' && 'length' in keyPath) {\n        assert(typeof value !== 'string' && 'length' in value);\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            setByKeyPath(obj, keyPath[i], value[i]);\n        }\n    }\n    else {\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var currentKeyPath = keyPath.substr(0, period);\n            var remainingKeyPath = keyPath.substr(period + 1);\n            if (remainingKeyPath === \"\")\n                if (value === undefined) {\n                    if (isArray(obj) && !isNaN(parseInt(currentKeyPath)))\n                        obj.splice(currentKeyPath, 1);\n                    else\n                        delete obj[currentKeyPath];\n                }\n                else\n                    obj[currentKeyPath] = value;\n            else {\n                var innerObj = obj[currentKeyPath];\n                if (!innerObj || !hasOwn(obj, currentKeyPath))\n                    innerObj = (obj[currentKeyPath] = {});\n                setByKeyPath(innerObj, remainingKeyPath, value);\n            }\n        }\n        else {\n            if (value === undefined) {\n                if (isArray(obj) && !isNaN(parseInt(keyPath)))\n                    obj.splice(keyPath, 1);\n                else\n                    delete obj[keyPath];\n            }\n            else\n                obj[keyPath] = value;\n        }\n    }\n}\nfunction delByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string')\n        setByKeyPath(obj, keyPath, undefined);\n    else if ('length' in keyPath)\n        [].map.call(keyPath, function (kp) {\n            setByKeyPath(obj, kp, undefined);\n        });\n}\nfunction shallowClone(obj) {\n    var rv = {};\n    for (var m in obj) {\n        if (hasOwn(obj, m))\n            rv[m] = obj[m];\n    }\n    return rv;\n}\nvar concat = [].concat;\nfunction flatten(a) {\n    return concat.apply([], a);\n}\nvar intrinsicTypeNames = \"BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey\"\n    .split(',').concat(flatten([8, 16, 32, 64].map(function (num) { return [\"Int\", \"Uint\", \"Float\"].map(function (t) { return t + num + \"Array\"; }); }))).filter(function (t) { return _global[t]; });\nvar intrinsicTypes = new Set(intrinsicTypeNames.map(function (t) { return _global[t]; }));\nfunction cloneSimpleObjectTree(o) {\n    var rv = {};\n    for (var k in o)\n        if (hasOwn(o, k)) {\n            var v = o[k];\n            rv[k] = !v || typeof v !== 'object' || intrinsicTypes.has(v.constructor) ? v : cloneSimpleObjectTree(v);\n        }\n    return rv;\n}\nfunction objectIsEmpty(o) {\n    for (var k in o)\n        if (hasOwn(o, k))\n            return false;\n    return true;\n}\nvar circularRefs = null;\nfunction deepClone(any) {\n    circularRefs = new WeakMap();\n    var rv = innerDeepClone(any);\n    circularRefs = null;\n    return rv;\n}\nfunction innerDeepClone(x) {\n    if (!x || typeof x !== 'object')\n        return x;\n    var rv = circularRefs.get(x);\n    if (rv)\n        return rv;\n    if (isArray(x)) {\n        rv = [];\n        circularRefs.set(x, rv);\n        for (var i = 0, l = x.length; i < l; ++i) {\n            rv.push(innerDeepClone(x[i]));\n        }\n    }\n    else if (intrinsicTypes.has(x.constructor)) {\n        rv = x;\n    }\n    else {\n        var proto = getProto(x);\n        rv = proto === Object.prototype ? {} : Object.create(proto);\n        circularRefs.set(x, rv);\n        for (var prop in x) {\n            if (hasOwn(x, prop)) {\n                rv[prop] = innerDeepClone(x[prop]);\n            }\n        }\n    }\n    return rv;\n}\nvar toString = {}.toString;\nfunction toStringTag(o) {\n    return toString.call(o).slice(8, -1);\n}\nvar iteratorSymbol = typeof Symbol !== 'undefined' ?\n    Symbol.iterator :\n    '@@iterator';\nvar getIteratorOf = typeof iteratorSymbol === \"symbol\" ? function (x) {\n    var i;\n    return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n} : function () { return null; };\nfunction delArrayItem(a, x) {\n    var i = a.indexOf(x);\n    if (i >= 0)\n        a.splice(i, 1);\n    return i >= 0;\n}\nvar NO_CHAR_ARRAY = {};\nfunction getArrayOf(arrayLike) {\n    var i, a, x, it;\n    if (arguments.length === 1) {\n        if (isArray(arrayLike))\n            return arrayLike.slice();\n        if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string')\n            return [arrayLike];\n        if ((it = getIteratorOf(arrayLike))) {\n            a = [];\n            while ((x = it.next()), !x.done)\n                a.push(x.value);\n            return a;\n        }\n        if (arrayLike == null)\n            return [arrayLike];\n        i = arrayLike.length;\n        if (typeof i === 'number') {\n            a = new Array(i);\n            while (i--)\n                a[i] = arrayLike[i];\n            return a;\n        }\n        return [arrayLike];\n    }\n    i = arguments.length;\n    a = new Array(i);\n    while (i--)\n        a[i] = arguments[i];\n    return a;\n}\nvar isAsyncFunction = typeof Symbol !== 'undefined'\n    ? function (fn) { return fn[Symbol.toStringTag] === 'AsyncFunction'; }\n    : function () { return false; };\n\nvar dexieErrorNames = [\n    'Modify',\n    'Bulk',\n    'OpenFailed',\n    'VersionChange',\n    'Schema',\n    'Upgrade',\n    'InvalidTable',\n    'MissingAPI',\n    'NoSuchDatabase',\n    'InvalidArgument',\n    'SubTransaction',\n    'Unsupported',\n    'Internal',\n    'DatabaseClosed',\n    'PrematureCommit',\n    'ForeignAwait'\n];\nvar idbDomErrorNames = [\n    'Unknown',\n    'Constraint',\n    'Data',\n    'TransactionInactive',\n    'ReadOnly',\n    'Version',\n    'NotFound',\n    'InvalidState',\n    'InvalidAccess',\n    'Abort',\n    'Timeout',\n    'QuotaExceeded',\n    'Syntax',\n    'DataClone'\n];\nvar errorList = dexieErrorNames.concat(idbDomErrorNames);\nvar defaultTexts = {\n    VersionChanged: \"Database version changed by other database connection\",\n    DatabaseClosed: \"Database has been closed\",\n    Abort: \"Transaction aborted\",\n    TransactionInactive: \"Transaction has already completed or failed\",\n    MissingAPI: \"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb\"\n};\nfunction DexieError(name, msg) {\n    this.name = name;\n    this.message = msg;\n}\nderive(DexieError).from(Error).extend({\n    toString: function () { return this.name + \": \" + this.message; }\n});\nfunction getMultiErrorMessage(msg, failures) {\n    return msg + \". Errors: \" + Object.keys(failures)\n        .map(function (key) { return failures[key].toString(); })\n        .filter(function (v, i, s) { return s.indexOf(v) === i; })\n        .join('\\n');\n}\nfunction ModifyError(msg, failures, successCount, failedKeys) {\n    this.failures = failures;\n    this.failedKeys = failedKeys;\n    this.successCount = successCount;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(ModifyError).from(DexieError);\nfunction BulkError(msg, failures) {\n    this.name = \"BulkError\";\n    this.failures = Object.keys(failures).map(function (pos) { return failures[pos]; });\n    this.failuresByPos = failures;\n    this.message = getMultiErrorMessage(msg, this.failures);\n}\nderive(BulkError).from(DexieError);\nvar errnames = errorList.reduce(function (obj, name) { return (obj[name] = name + \"Error\", obj); }, {});\nvar BaseException = DexieError;\nvar exceptions = errorList.reduce(function (obj, name) {\n    var fullName = name + \"Error\";\n    function DexieError(msgOrInner, inner) {\n        this.name = fullName;\n        if (!msgOrInner) {\n            this.message = defaultTexts[name] || fullName;\n            this.inner = null;\n        }\n        else if (typeof msgOrInner === 'string') {\n            this.message = \"\".concat(msgOrInner).concat(!inner ? '' : '\\n ' + inner);\n            this.inner = inner || null;\n        }\n        else if (typeof msgOrInner === 'object') {\n            this.message = \"\".concat(msgOrInner.name, \" \").concat(msgOrInner.message);\n            this.inner = msgOrInner;\n        }\n    }\n    derive(DexieError).from(BaseException);\n    obj[name] = DexieError;\n    return obj;\n}, {});\nexceptions.Syntax = SyntaxError;\nexceptions.Type = TypeError;\nexceptions.Range = RangeError;\nvar exceptionMap = idbDomErrorNames.reduce(function (obj, name) {\n    obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfunction mapError(domError, message) {\n    if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n        return domError;\n    var rv = new exceptionMap[domError.name](message || domError.message, domError);\n    if (\"stack\" in domError) {\n        setProp(rv, \"stack\", { get: function () {\n                return this.inner.stack;\n            } });\n    }\n    return rv;\n}\nvar fullNameExceptions = errorList.reduce(function (obj, name) {\n    if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1)\n        obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfullNameExceptions.ModifyError = ModifyError;\nfullNameExceptions.DexieError = DexieError;\nfullNameExceptions.BulkError = BulkError;\n\nfunction nop() { }\nfunction mirror(val) { return val; }\nfunction pureFunctionChain(f1, f2) {\n    if (f1 == null || f1 === mirror)\n        return f2;\n    return function (val) {\n        return f2(f1(val));\n    };\n}\nfunction callBoth(on1, on2) {\n    return function () {\n        on1.apply(this, arguments);\n        on2.apply(this, arguments);\n    };\n}\nfunction hookCreatingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res !== undefined)\n            arguments[0] = res;\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res2 !== undefined ? res2 : res;\n    };\n}\nfunction hookDeletingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        f1.apply(this, arguments);\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = this.onerror = null;\n        f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    };\n}\nfunction hookUpdatingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function (modifications) {\n        var res = f1.apply(this, arguments);\n        extend(modifications, res);\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res === undefined ?\n            (res2 === undefined ? undefined : res2) :\n            (extend(res, res2));\n    };\n}\nfunction reverseStoppableEventChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        if (f2.apply(this, arguments) === false)\n            return false;\n        return f1.apply(this, arguments);\n    };\n}\nfunction promisableChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res && typeof res.then === 'function') {\n            var thiz = this, i = arguments.length, args = new Array(i);\n            while (i--)\n                args[i] = arguments[i];\n            return res.then(function () {\n                return f2.apply(thiz, args);\n            });\n        }\n        return f2.apply(this, arguments);\n    };\n}\n\nvar debug = typeof location !== 'undefined' &&\n    /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\nfunction setDebug(value, filter) {\n    debug = value;\n}\n\nvar INTERNAL = {};\nvar ZONE_ECHO_LIMIT = 100, _a$1 = typeof Promise === 'undefined' ?\n    [] :\n    (function () {\n        var globalP = Promise.resolve();\n        if (typeof crypto === 'undefined' || !crypto.subtle)\n            return [globalP, getProto(globalP), globalP];\n        var nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n        return [\n            nativeP,\n            getProto(nativeP),\n            globalP\n        ];\n    })(), resolvedNativePromise = _a$1[0], nativePromiseProto = _a$1[1], resolvedGlobalPromise = _a$1[2], nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\nvar NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\nvar patchGlobalPromise = !!resolvedGlobalPromise;\nfunction schedulePhysicalTick() {\n    queueMicrotask(physicalTick);\n}\nvar asap = function (callback, args) {\n    microtickQueue.push([callback, args]);\n    if (needsNewPhysicalTick) {\n        schedulePhysicalTick();\n        needsNewPhysicalTick = false;\n    }\n};\nvar isOutsideMicroTick = true,\nneedsNewPhysicalTick = true,\nunhandledErrors = [],\nrejectingErrors = [],\nrejectionMapper = mirror;\nvar globalPSD = {\n    id: 'global',\n    global: true,\n    ref: 0,\n    unhandleds: [],\n    onunhandled: nop,\n    pgp: false,\n    env: {},\n    finalize: nop\n};\nvar PSD = globalPSD;\nvar microtickQueue = [];\nvar numScheduledCalls = 0;\nvar tickFinalizers = [];\nfunction DexiePromise(fn) {\n    if (typeof this !== 'object')\n        throw new TypeError('Promises must be constructed via new');\n    this._listeners = [];\n    this._lib = false;\n    var psd = (this._PSD = PSD);\n    if (typeof fn !== 'function') {\n        if (fn !== INTERNAL)\n            throw new TypeError('Not a function');\n        this._state = arguments[1];\n        this._value = arguments[2];\n        if (this._state === false)\n            handleRejection(this, this._value);\n        return;\n    }\n    this._state = null;\n    this._value = null;\n    ++psd.ref;\n    executePromiseTask(this, fn);\n}\nvar thenProp = {\n    get: function () {\n        var psd = PSD, microTaskId = totalEchoes;\n        function then(onFulfilled, onRejected) {\n            var _this = this;\n            var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n            var cleanup = possibleAwait && !decrementExpectedAwaits();\n            var rv = new DexiePromise(function (resolve, reject) {\n                propagateToListener(_this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait, cleanup), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait, cleanup), resolve, reject, psd));\n            });\n            if (this._consoleTask)\n                rv._consoleTask = this._consoleTask;\n            return rv;\n        }\n        then.prototype = INTERNAL;\n        return then;\n    },\n    set: function (value) {\n        setProp(this, 'then', value && value.prototype === INTERNAL ?\n            thenProp :\n            {\n                get: function () {\n                    return value;\n                },\n                set: thenProp.set\n            });\n    }\n};\nprops(DexiePromise.prototype, {\n    then: thenProp,\n    _then: function (onFulfilled, onRejected) {\n        propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n    },\n    catch: function (onRejected) {\n        if (arguments.length === 1)\n            return this.then(null, onRejected);\n        var type = arguments[0], handler = arguments[1];\n        return typeof type === 'function' ? this.then(null, function (err) {\n            return err instanceof type ? handler(err) : PromiseReject(err);\n        })\n            : this.then(null, function (err) {\n                return err && err.name === type ? handler(err) : PromiseReject(err);\n            });\n    },\n    finally: function (onFinally) {\n        return this.then(function (value) {\n            return DexiePromise.resolve(onFinally()).then(function () { return value; });\n        }, function (err) {\n            return DexiePromise.resolve(onFinally()).then(function () { return PromiseReject(err); });\n        });\n    },\n    timeout: function (ms, msg) {\n        var _this = this;\n        return ms < Infinity ?\n            new DexiePromise(function (resolve, reject) {\n                var handle = setTimeout(function () { return reject(new exceptions.Timeout(msg)); }, ms);\n                _this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n            }) : this;\n    }\n});\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n    setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\nglobalPSD.env = snapShot();\nfunction Listener(onFulfilled, onRejected, resolve, reject, zone) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.psd = zone;\n}\nprops(DexiePromise, {\n    all: function () {\n        var values = getArrayOf.apply(null, arguments)\n            .map(onPossibleParallellAsync);\n        return new DexiePromise(function (resolve, reject) {\n            if (values.length === 0)\n                resolve([]);\n            var remaining = values.length;\n            values.forEach(function (a, i) { return DexiePromise.resolve(a).then(function (x) {\n                values[i] = x;\n                if (!--remaining)\n                    resolve(values);\n            }, reject); });\n        });\n    },\n    resolve: function (value) {\n        if (value instanceof DexiePromise)\n            return value;\n        if (value && typeof value.then === 'function')\n            return new DexiePromise(function (resolve, reject) {\n                value.then(resolve, reject);\n            });\n        var rv = new DexiePromise(INTERNAL, true, value);\n        return rv;\n    },\n    reject: PromiseReject,\n    race: function () {\n        var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n        return new DexiePromise(function (resolve, reject) {\n            values.map(function (value) { return DexiePromise.resolve(value).then(resolve, reject); });\n        });\n    },\n    PSD: {\n        get: function () { return PSD; },\n        set: function (value) { return PSD = value; }\n    },\n    totalEchoes: { get: function () { return totalEchoes; } },\n    newPSD: newScope,\n    usePSD: usePSD,\n    scheduler: {\n        get: function () { return asap; },\n        set: function (value) { asap = value; }\n    },\n    rejectionMapper: {\n        get: function () { return rejectionMapper; },\n        set: function (value) { rejectionMapper = value; }\n    },\n    follow: function (fn, zoneProps) {\n        return new DexiePromise(function (resolve, reject) {\n            return newScope(function (resolve, reject) {\n                var psd = PSD;\n                psd.unhandleds = [];\n                psd.onunhandled = reject;\n                psd.finalize = callBoth(function () {\n                    var _this = this;\n                    run_at_end_of_this_or_next_physical_tick(function () {\n                        _this.unhandleds.length === 0 ? resolve() : reject(_this.unhandleds[0]);\n                    });\n                }, psd.finalize);\n                fn();\n            }, zoneProps, resolve, reject);\n        });\n    }\n});\nif (NativePromise) {\n    if (NativePromise.allSettled)\n        setProp(DexiePromise, \"allSettled\", function () {\n            var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve) {\n                if (possiblePromises.length === 0)\n                    resolve([]);\n                var remaining = possiblePromises.length;\n                var results = new Array(remaining);\n                possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return results[i] = { status: \"fulfilled\", value: value }; }, function (reason) { return results[i] = { status: \"rejected\", reason: reason }; })\n                    .then(function () { return --remaining || resolve(results); }); });\n            });\n        });\n    if (NativePromise.any && typeof AggregateError !== 'undefined')\n        setProp(DexiePromise, \"any\", function () {\n            var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                if (possiblePromises.length === 0)\n                    reject(new AggregateError([]));\n                var remaining = possiblePromises.length;\n                var failures = new Array(remaining);\n                possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return resolve(value); }, function (failure) {\n                    failures[i] = failure;\n                    if (!--remaining)\n                        reject(new AggregateError(failures));\n                }); });\n            });\n        });\n}\nfunction executePromiseTask(promise, fn) {\n    try {\n        fn(function (value) {\n            if (promise._state !== null)\n                return;\n            if (value === promise)\n                throw new TypeError('A promise cannot be resolved with itself.');\n            var shouldExecuteTick = promise._lib && beginMicroTickScope();\n            if (value && typeof value.then === 'function') {\n                executePromiseTask(promise, function (resolve, reject) {\n                    value instanceof DexiePromise ?\n                        value._then(resolve, reject) :\n                        value.then(resolve, reject);\n                });\n            }\n            else {\n                promise._state = true;\n                promise._value = value;\n                propagateAllListeners(promise);\n            }\n            if (shouldExecuteTick)\n                endMicroTickScope();\n        }, handleRejection.bind(null, promise));\n    }\n    catch (ex) {\n        handleRejection(promise, ex);\n    }\n}\nfunction handleRejection(promise, reason) {\n    rejectingErrors.push(reason);\n    if (promise._state !== null)\n        return;\n    var shouldExecuteTick = promise._lib && beginMicroTickScope();\n    reason = rejectionMapper(reason);\n    promise._state = false;\n    promise._value = reason;\n    addPossiblyUnhandledError(promise);\n    propagateAllListeners(promise);\n    if (shouldExecuteTick)\n        endMicroTickScope();\n}\nfunction propagateAllListeners(promise) {\n    var listeners = promise._listeners;\n    promise._listeners = [];\n    for (var i = 0, len = listeners.length; i < len; ++i) {\n        propagateToListener(promise, listeners[i]);\n    }\n    var psd = promise._PSD;\n    --psd.ref || psd.finalize();\n    if (numScheduledCalls === 0) {\n        ++numScheduledCalls;\n        asap(function () {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n        }, []);\n    }\n}\nfunction propagateToListener(promise, listener) {\n    if (promise._state === null) {\n        promise._listeners.push(listener);\n        return;\n    }\n    var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n    if (cb === null) {\n        return (promise._state ? listener.resolve : listener.reject)(promise._value);\n    }\n    ++listener.psd.ref;\n    ++numScheduledCalls;\n    asap(callListener, [cb, promise, listener]);\n}\nfunction callListener(cb, promise, listener) {\n    try {\n        var ret, value = promise._value;\n        if (!promise._state && rejectingErrors.length)\n            rejectingErrors = [];\n        ret = debug && promise._consoleTask ? promise._consoleTask.run(function () { return cb(value); }) : cb(value);\n        if (!promise._state && rejectingErrors.indexOf(value) === -1) {\n            markErrorAsHandled(promise);\n        }\n        listener.resolve(ret);\n    }\n    catch (e) {\n        listener.reject(e);\n    }\n    finally {\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n        --listener.psd.ref || listener.psd.finalize();\n    }\n}\nfunction physicalTick() {\n    usePSD(globalPSD, function () {\n        beginMicroTickScope() && endMicroTickScope();\n    });\n}\nfunction beginMicroTickScope() {\n    var wasRootExec = isOutsideMicroTick;\n    isOutsideMicroTick = false;\n    needsNewPhysicalTick = false;\n    return wasRootExec;\n}\nfunction endMicroTickScope() {\n    var callbacks, i, l;\n    do {\n        while (microtickQueue.length > 0) {\n            callbacks = microtickQueue;\n            microtickQueue = [];\n            l = callbacks.length;\n            for (i = 0; i < l; ++i) {\n                var item = callbacks[i];\n                item[0].apply(null, item[1]);\n            }\n        }\n    } while (microtickQueue.length > 0);\n    isOutsideMicroTick = true;\n    needsNewPhysicalTick = true;\n}\nfunction finalizePhysicalTick() {\n    var unhandledErrs = unhandledErrors;\n    unhandledErrors = [];\n    unhandledErrs.forEach(function (p) {\n        p._PSD.onunhandled.call(null, p._value, p);\n    });\n    var finalizers = tickFinalizers.slice(0);\n    var i = finalizers.length;\n    while (i)\n        finalizers[--i]();\n}\nfunction run_at_end_of_this_or_next_physical_tick(fn) {\n    function finalizer() {\n        fn();\n        tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n    }\n    tickFinalizers.push(finalizer);\n    ++numScheduledCalls;\n    asap(function () {\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n    }, []);\n}\nfunction addPossiblyUnhandledError(promise) {\n    if (!unhandledErrors.some(function (p) { return p._value === promise._value; }))\n        unhandledErrors.push(promise);\n}\nfunction markErrorAsHandled(promise) {\n    var i = unhandledErrors.length;\n    while (i)\n        if (unhandledErrors[--i]._value === promise._value) {\n            unhandledErrors.splice(i, 1);\n            return;\n        }\n}\nfunction PromiseReject(reason) {\n    return new DexiePromise(INTERNAL, false, reason);\n}\nfunction wrap(fn, errorCatcher) {\n    var psd = PSD;\n    return function () {\n        var wasRootExec = beginMicroTickScope(), outerScope = PSD;\n        try {\n            switchToZone(psd, true);\n            return fn.apply(this, arguments);\n        }\n        catch (e) {\n            errorCatcher && errorCatcher(e);\n        }\n        finally {\n            switchToZone(outerScope, false);\n            if (wasRootExec)\n                endMicroTickScope();\n        }\n    };\n}\nvar task = { awaits: 0, echoes: 0, id: 0 };\nvar taskCounter = 0;\nvar zoneStack = [];\nvar zoneEchoes = 0;\nvar totalEchoes = 0;\nvar zone_id_counter = 0;\nfunction newScope(fn, props, a1, a2) {\n    var parent = PSD, psd = Object.create(parent);\n    psd.parent = parent;\n    psd.ref = 0;\n    psd.global = false;\n    psd.id = ++zone_id_counter;\n    globalPSD.env;\n    psd.env = patchGlobalPromise ? {\n        Promise: DexiePromise,\n        PromiseProp: { value: DexiePromise, configurable: true, writable: true },\n        all: DexiePromise.all,\n        race: DexiePromise.race,\n        allSettled: DexiePromise.allSettled,\n        any: DexiePromise.any,\n        resolve: DexiePromise.resolve,\n        reject: DexiePromise.reject,\n    } : {};\n    if (props)\n        extend(psd, props);\n    ++parent.ref;\n    psd.finalize = function () {\n        --this.parent.ref || this.parent.finalize();\n    };\n    var rv = usePSD(psd, fn, a1, a2);\n    if (psd.ref === 0)\n        psd.finalize();\n    return rv;\n}\nfunction incrementExpectedAwaits() {\n    if (!task.id)\n        task.id = ++taskCounter;\n    ++task.awaits;\n    task.echoes += ZONE_ECHO_LIMIT;\n    return task.id;\n}\nfunction decrementExpectedAwaits() {\n    if (!task.awaits)\n        return false;\n    if (--task.awaits === 0)\n        task.id = 0;\n    task.echoes = task.awaits * ZONE_ECHO_LIMIT;\n    return true;\n}\nif (('' + nativePromiseThen).indexOf('[native code]') === -1) {\n    incrementExpectedAwaits = decrementExpectedAwaits = nop;\n}\nfunction onPossibleParallellAsync(possiblePromise) {\n    if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n        incrementExpectedAwaits();\n        return possiblePromise.then(function (x) {\n            decrementExpectedAwaits();\n            return x;\n        }, function (e) {\n            decrementExpectedAwaits();\n            return rejection(e);\n        });\n    }\n    return possiblePromise;\n}\nfunction zoneEnterEcho(targetZone) {\n    ++totalEchoes;\n    if (!task.echoes || --task.echoes === 0) {\n        task.echoes = task.awaits = task.id = 0;\n    }\n    zoneStack.push(PSD);\n    switchToZone(targetZone, true);\n}\nfunction zoneLeaveEcho() {\n    var zone = zoneStack[zoneStack.length - 1];\n    zoneStack.pop();\n    switchToZone(zone, false);\n}\nfunction switchToZone(targetZone, bEnteringZone) {\n    var currentZone = PSD;\n    if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n        queueMicrotask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n    }\n    if (targetZone === PSD)\n        return;\n    PSD = targetZone;\n    if (currentZone === globalPSD)\n        globalPSD.env = snapShot();\n    if (patchGlobalPromise) {\n        var GlobalPromise = globalPSD.env.Promise;\n        var targetEnv = targetZone.env;\n        if (currentZone.global || targetZone.global) {\n            Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n            GlobalPromise.all = targetEnv.all;\n            GlobalPromise.race = targetEnv.race;\n            GlobalPromise.resolve = targetEnv.resolve;\n            GlobalPromise.reject = targetEnv.reject;\n            if (targetEnv.allSettled)\n                GlobalPromise.allSettled = targetEnv.allSettled;\n            if (targetEnv.any)\n                GlobalPromise.any = targetEnv.any;\n        }\n    }\n}\nfunction snapShot() {\n    var GlobalPromise = _global.Promise;\n    return patchGlobalPromise ? {\n        Promise: GlobalPromise,\n        PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n        all: GlobalPromise.all,\n        race: GlobalPromise.race,\n        allSettled: GlobalPromise.allSettled,\n        any: GlobalPromise.any,\n        resolve: GlobalPromise.resolve,\n        reject: GlobalPromise.reject,\n    } : {};\n}\nfunction usePSD(psd, fn, a1, a2, a3) {\n    var outerScope = PSD;\n    try {\n        switchToZone(psd, true);\n        return fn(a1, a2, a3);\n    }\n    finally {\n        switchToZone(outerScope, false);\n    }\n}\nfunction nativeAwaitCompatibleWrap(fn, zone, possibleAwait, cleanup) {\n    return typeof fn !== 'function' ? fn : function () {\n        var outerZone = PSD;\n        if (possibleAwait)\n            incrementExpectedAwaits();\n        switchToZone(zone, true);\n        try {\n            return fn.apply(this, arguments);\n        }\n        finally {\n            switchToZone(outerZone, false);\n            if (cleanup)\n                queueMicrotask(decrementExpectedAwaits);\n        }\n    };\n}\nfunction execInGlobalContext(cb) {\n    if (Promise === NativePromise && task.echoes === 0) {\n        if (zoneEchoes === 0) {\n            cb();\n        }\n        else {\n            enqueueNativeMicroTask(cb);\n        }\n    }\n    else {\n        setTimeout(cb, 0);\n    }\n}\nvar rejection = DexiePromise.reject;\n\nfunction tempTransaction(db, mode, storeNames, fn) {\n    if (!db.idbdb || (!db._state.openComplete && (!PSD.letThrough && !db._vip))) {\n        if (db._state.openComplete) {\n            return rejection(new exceptions.DatabaseClosed(db._state.dbOpenError));\n        }\n        if (!db._state.isBeingOpened) {\n            if (!db._state.autoOpen)\n                return rejection(new exceptions.DatabaseClosed());\n            db.open().catch(nop);\n        }\n        return db._state.dbReadyPromise.then(function () { return tempTransaction(db, mode, storeNames, fn); });\n    }\n    else {\n        var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n        try {\n            trans.create();\n            db._state.PR1398_maxLoop = 3;\n        }\n        catch (ex) {\n            if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                console.warn('Dexie: Need to reopen db');\n                db.close({ disableAutoOpen: false });\n                return db.open().then(function () { return tempTransaction(db, mode, storeNames, fn); });\n            }\n            return rejection(ex);\n        }\n        return trans._promise(mode, function (resolve, reject) {\n            return newScope(function () {\n                PSD.trans = trans;\n                return fn(resolve, reject, trans);\n            });\n        }).then(function (result) {\n            if (mode === 'readwrite')\n                try {\n                    trans.idbtrans.commit();\n                }\n                catch (_a) { }\n            return mode === 'readonly' ? result : trans._completion.then(function () { return result; });\n        });\n    }\n}\n\nvar DEXIE_VERSION = '4.0.5';\nvar maxString = String.fromCharCode(65535);\nvar minKey = -Infinity;\nvar INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\nvar STRING_EXPECTED = \"String expected.\";\nvar connections = [];\nvar DBNAMES_DB = '__dbnames';\nvar READONLY = 'readonly';\nvar READWRITE = 'readwrite';\n\nfunction combine(filter1, filter2) {\n    return filter1 ?\n        filter2 ?\n            function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n            filter1 :\n        filter2;\n}\n\nvar AnyRange = {\n    type: 3 ,\n    lower: -Infinity,\n    lowerOpen: false,\n    upper: [[]],\n    upperOpen: false\n};\n\nfunction workaroundForUndefinedPrimKey(keyPath) {\n    return typeof keyPath === \"string\" && !/\\./.test(keyPath)\n        ? function (obj) {\n            if (obj[keyPath] === undefined && (keyPath in obj)) {\n                obj = deepClone(obj);\n                delete obj[keyPath];\n            }\n            return obj;\n        }\n        : function (obj) { return obj; };\n}\n\nfunction Entity() {\n    throw exceptions.Type();\n}\n\nfunction cmp(a, b) {\n    try {\n        var ta = type(a);\n        var tb = type(b);\n        if (ta !== tb) {\n            if (ta === 'Array')\n                return 1;\n            if (tb === 'Array')\n                return -1;\n            if (ta === 'binary')\n                return 1;\n            if (tb === 'binary')\n                return -1;\n            if (ta === 'string')\n                return 1;\n            if (tb === 'string')\n                return -1;\n            if (ta === 'Date')\n                return 1;\n            if (tb !== 'Date')\n                return NaN;\n            return -1;\n        }\n        switch (ta) {\n            case 'number':\n            case 'Date':\n            case 'string':\n                return a > b ? 1 : a < b ? -1 : 0;\n            case 'binary': {\n                return compareUint8Arrays(getUint8Array(a), getUint8Array(b));\n            }\n            case 'Array':\n                return compareArrays(a, b);\n        }\n    }\n    catch (_a) { }\n    return NaN;\n}\nfunction compareArrays(a, b) {\n    var al = a.length;\n    var bl = b.length;\n    var l = al < bl ? al : bl;\n    for (var i = 0; i < l; ++i) {\n        var res = cmp(a[i], b[i]);\n        if (res !== 0)\n            return res;\n    }\n    return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction compareUint8Arrays(a, b) {\n    var al = a.length;\n    var bl = b.length;\n    var l = al < bl ? al : bl;\n    for (var i = 0; i < l; ++i) {\n        if (a[i] !== b[i])\n            return a[i] < b[i] ? -1 : 1;\n    }\n    return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction type(x) {\n    var t = typeof x;\n    if (t !== 'object')\n        return t;\n    if (ArrayBuffer.isView(x))\n        return 'binary';\n    var tsTag = toStringTag(x);\n    return tsTag === 'ArrayBuffer' ? 'binary' : tsTag;\n}\nfunction getUint8Array(a) {\n    if (a instanceof Uint8Array)\n        return a;\n    if (ArrayBuffer.isView(a))\n        return new Uint8Array(a.buffer, a.byteOffset, a.byteLength);\n    return new Uint8Array(a);\n}\n\nvar Table =  (function () {\n    function Table() {\n    }\n    Table.prototype._trans = function (mode, fn, writeLocked) {\n        var trans = this._tx || PSD.trans;\n        var tableName = this.name;\n        var task = debug && typeof console !== 'undefined' && console.createTask && console.createTask(\"Dexie: \".concat(mode === 'readonly' ? 'read' : 'write', \" \").concat(this.name));\n        function checkTableInTransaction(resolve, reject, trans) {\n            if (!trans.schema[tableName])\n                throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n            return fn(trans.idbtrans, trans);\n        }\n        var wasRootExec = beginMicroTickScope();\n        try {\n            var p = trans && trans.db._novip === this.db._novip ?\n                trans === PSD.trans ?\n                    trans._promise(mode, checkTableInTransaction, writeLocked) :\n                    newScope(function () { return trans._promise(mode, checkTableInTransaction, writeLocked); }, { trans: trans, transless: PSD.transless || PSD }) :\n                tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n            if (task) {\n                p._consoleTask = task;\n                p = p.catch(function (err) {\n                    console.trace(err);\n                    return rejection(err);\n                });\n            }\n            return p;\n        }\n        finally {\n            if (wasRootExec)\n                endMicroTickScope();\n        }\n    };\n    Table.prototype.get = function (keyOrCrit, cb) {\n        var _this = this;\n        if (keyOrCrit && keyOrCrit.constructor === Object)\n            return this.where(keyOrCrit).first(cb);\n        if (keyOrCrit == null)\n            return rejection(new exceptions.Type(\"Invalid argument to Table.get()\"));\n        return this._trans('readonly', function (trans) {\n            return _this.core.get({ trans: trans, key: keyOrCrit })\n                .then(function (res) { return _this.hook.reading.fire(res); });\n        }).then(cb);\n    };\n    Table.prototype.where = function (indexOrCrit) {\n        if (typeof indexOrCrit === 'string')\n            return new this.db.WhereClause(this, indexOrCrit);\n        if (isArray(indexOrCrit))\n            return new this.db.WhereClause(this, \"[\".concat(indexOrCrit.join('+'), \"]\"));\n        var keyPaths = keys(indexOrCrit);\n        if (keyPaths.length === 1)\n            return this\n                .where(keyPaths[0])\n                .equals(indexOrCrit[keyPaths[0]]);\n        var compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(function (ix) {\n            if (ix.compound &&\n                keyPaths.every(function (keyPath) { return ix.keyPath.indexOf(keyPath) >= 0; })) {\n                for (var i = 0; i < keyPaths.length; ++i) {\n                    if (keyPaths.indexOf(ix.keyPath[i]) === -1)\n                        return false;\n                }\n                return true;\n            }\n            return false;\n        }).sort(function (a, b) { return a.keyPath.length - b.keyPath.length; })[0];\n        if (compoundIndex && this.db._maxKey !== maxString) {\n            var keyPathsInValidOrder = compoundIndex.keyPath.slice(0, keyPaths.length);\n            return this\n                .where(keyPathsInValidOrder)\n                .equals(keyPathsInValidOrder.map(function (kp) { return indexOrCrit[kp]; }));\n        }\n        if (!compoundIndex && debug)\n            console.warn(\"The query \".concat(JSON.stringify(indexOrCrit), \" on \").concat(this.name, \" would benefit from a \") +\n                \"compound index [\".concat(keyPaths.join('+'), \"]\"));\n        var idxByName = this.schema.idxByName;\n        var idb = this.db._deps.indexedDB;\n        function equals(a, b) {\n            return idb.cmp(a, b) === 0;\n        }\n        var _a = keyPaths.reduce(function (_a, keyPath) {\n            var prevIndex = _a[0], prevFilterFn = _a[1];\n            var index = idxByName[keyPath];\n            var value = indexOrCrit[keyPath];\n            return [\n                prevIndex || index,\n                prevIndex || !index ?\n                    combine(prevFilterFn, index && index.multi ?\n                        function (x) {\n                            var prop = getByKeyPath(x, keyPath);\n                            return isArray(prop) && prop.some(function (item) { return equals(value, item); });\n                        } : function (x) { return equals(value, getByKeyPath(x, keyPath)); })\n                    : prevFilterFn\n            ];\n        }, [null, null]), idx = _a[0], filterFunction = _a[1];\n        return idx ?\n            this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n                .filter(filterFunction) :\n            compoundIndex ?\n                this.filter(filterFunction) :\n                this.where(keyPaths).equals('');\n    };\n    Table.prototype.filter = function (filterFunction) {\n        return this.toCollection().and(filterFunction);\n    };\n    Table.prototype.count = function (thenShortcut) {\n        return this.toCollection().count(thenShortcut);\n    };\n    Table.prototype.offset = function (offset) {\n        return this.toCollection().offset(offset);\n    };\n    Table.prototype.limit = function (numRows) {\n        return this.toCollection().limit(numRows);\n    };\n    Table.prototype.each = function (callback) {\n        return this.toCollection().each(callback);\n    };\n    Table.prototype.toArray = function (thenShortcut) {\n        return this.toCollection().toArray(thenShortcut);\n    };\n    Table.prototype.toCollection = function () {\n        return new this.db.Collection(new this.db.WhereClause(this));\n    };\n    Table.prototype.orderBy = function (index) {\n        return new this.db.Collection(new this.db.WhereClause(this, isArray(index) ?\n            \"[\".concat(index.join('+'), \"]\") :\n            index));\n    };\n    Table.prototype.reverse = function () {\n        return this.toCollection().reverse();\n    };\n    Table.prototype.mapToClass = function (constructor) {\n        var _a = this, db = _a.db, tableName = _a.name;\n        this.schema.mappedClass = constructor;\n        if (constructor.prototype instanceof Entity) {\n            constructor =  (function (_super) {\n                __extends(class_1, _super);\n                function class_1() {\n                    return _super !== null && _super.apply(this, arguments) || this;\n                }\n                Object.defineProperty(class_1.prototype, \"db\", {\n                    get: function () { return db; },\n                    enumerable: false,\n                    configurable: true\n                });\n                class_1.prototype.table = function () { return tableName; };\n                return class_1;\n            }(constructor));\n        }\n        var inheritedProps = new Set();\n        for (var proto = constructor.prototype; proto; proto = getProto(proto)) {\n            Object.getOwnPropertyNames(proto).forEach(function (propName) { return inheritedProps.add(propName); });\n        }\n        var readHook = function (obj) {\n            if (!obj)\n                return obj;\n            var res = Object.create(constructor.prototype);\n            for (var m in obj)\n                if (!inheritedProps.has(m))\n                    try {\n                        res[m] = obj[m];\n                    }\n                    catch (_) { }\n            return res;\n        };\n        if (this.schema.readHook) {\n            this.hook.reading.unsubscribe(this.schema.readHook);\n        }\n        this.schema.readHook = readHook;\n        this.hook(\"reading\", readHook);\n        return constructor;\n    };\n    Table.prototype.defineClass = function () {\n        function Class(content) {\n            extend(this, content);\n        }\n        return this.mapToClass(Class);\n    };\n    Table.prototype.add = function (obj, key) {\n        var _this = this;\n        var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n        var objToAdd = obj;\n        if (keyPath && auto) {\n            objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n        }\n        return this._trans('readwrite', function (trans) {\n            return _this.core.mutate({ trans: trans, type: 'add', keys: key != null ? [key] : null, values: [objToAdd] });\n        }).then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n            .then(function (lastResult) {\n            if (keyPath) {\n                try {\n                    setByKeyPath(obj, keyPath, lastResult);\n                }\n                catch (_) { }\n            }\n            return lastResult;\n        });\n    };\n    Table.prototype.update = function (keyOrObject, modifications) {\n        if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n            var key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n            if (key === undefined)\n                return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n            return this.where(\":id\").equals(key).modify(modifications);\n        }\n        else {\n            return this.where(\":id\").equals(keyOrObject).modify(modifications);\n        }\n    };\n    Table.prototype.put = function (obj, key) {\n        var _this = this;\n        var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n        var objToAdd = obj;\n        if (keyPath && auto) {\n            objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n        }\n        return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'put', values: [objToAdd], keys: key != null ? [key] : null }); })\n            .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n            .then(function (lastResult) {\n            if (keyPath) {\n                try {\n                    setByKeyPath(obj, keyPath, lastResult);\n                }\n                catch (_) { }\n            }\n            return lastResult;\n        });\n    };\n    Table.prototype.delete = function (key) {\n        var _this = this;\n        return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'delete', keys: [key] }); })\n            .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n    };\n    Table.prototype.clear = function () {\n        var _this = this;\n        return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'deleteRange', range: AnyRange }); })\n            .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n    };\n    Table.prototype.bulkGet = function (keys) {\n        var _this = this;\n        return this._trans('readonly', function (trans) {\n            return _this.core.getMany({\n                keys: keys,\n                trans: trans\n            }).then(function (result) { return result.map(function (res) { return _this.hook.reading.fire(res); }); });\n        });\n    };\n    Table.prototype.bulkAdd = function (objects, keysOrOptions, options) {\n        var _this = this;\n        var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n        options = options || (keys ? undefined : keysOrOptions);\n        var wantResults = options ? options.allKeys : undefined;\n        return this._trans('readwrite', function (trans) {\n            var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            if (keyPath && keys)\n                throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n            if (keys && keys.length !== objects.length)\n                throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n            var numObjects = objects.length;\n            var objectsToAdd = keyPath && auto ?\n                objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                objects;\n            return _this.core.mutate({ trans: trans, type: 'add', keys: keys, values: objectsToAdd, wantResults: wantResults })\n                .then(function (_a) {\n                var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                var result = wantResults ? results : lastResult;\n                if (numFailures === 0)\n                    return result;\n                throw new BulkError(\"\".concat(_this.name, \".bulkAdd(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n            });\n        });\n    };\n    Table.prototype.bulkPut = function (objects, keysOrOptions, options) {\n        var _this = this;\n        var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n        options = options || (keys ? undefined : keysOrOptions);\n        var wantResults = options ? options.allKeys : undefined;\n        return this._trans('readwrite', function (trans) {\n            var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            if (keyPath && keys)\n                throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n            if (keys && keys.length !== objects.length)\n                throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n            var numObjects = objects.length;\n            var objectsToPut = keyPath && auto ?\n                objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                objects;\n            return _this.core.mutate({ trans: trans, type: 'put', keys: keys, values: objectsToPut, wantResults: wantResults })\n                .then(function (_a) {\n                var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                var result = wantResults ? results : lastResult;\n                if (numFailures === 0)\n                    return result;\n                throw new BulkError(\"\".concat(_this.name, \".bulkPut(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n            });\n        });\n    };\n    Table.prototype.bulkUpdate = function (keysAndChanges) {\n        var _this = this;\n        var coreTable = this.core;\n        var keys = keysAndChanges.map(function (entry) { return entry.key; });\n        var changeSpecs = keysAndChanges.map(function (entry) { return entry.changes; });\n        var offsetMap = [];\n        return this._trans('readwrite', function (trans) {\n            return coreTable.getMany({ trans: trans, keys: keys, cache: 'clone' }).then(function (objs) {\n                var resultKeys = [];\n                var resultObjs = [];\n                keysAndChanges.forEach(function (_a, idx) {\n                    var key = _a.key, changes = _a.changes;\n                    var obj = objs[idx];\n                    if (obj) {\n                        for (var _i = 0, _b = Object.keys(changes); _i < _b.length; _i++) {\n                            var keyPath = _b[_i];\n                            var value = changes[keyPath];\n                            if (keyPath === _this.schema.primKey.keyPath) {\n                                if (cmp(value, key) !== 0) {\n                                    throw new exceptions.Constraint(\"Cannot update primary key in bulkUpdate()\");\n                                }\n                            }\n                            else {\n                                setByKeyPath(obj, keyPath, value);\n                            }\n                        }\n                        offsetMap.push(idx);\n                        resultKeys.push(key);\n                        resultObjs.push(obj);\n                    }\n                });\n                var numEntries = resultKeys.length;\n                return coreTable\n                    .mutate({\n                    trans: trans,\n                    type: 'put',\n                    keys: resultKeys,\n                    values: resultObjs,\n                    updates: {\n                        keys: keys,\n                        changeSpecs: changeSpecs\n                    }\n                })\n                    .then(function (_a) {\n                    var numFailures = _a.numFailures, failures = _a.failures;\n                    if (numFailures === 0)\n                        return numEntries;\n                    for (var _i = 0, _b = Object.keys(failures); _i < _b.length; _i++) {\n                        var offset = _b[_i];\n                        var mappedOffset = offsetMap[Number(offset)];\n                        if (mappedOffset != null) {\n                            var failure = failures[offset];\n                            delete failures[offset];\n                            failures[mappedOffset] = failure;\n                        }\n                    }\n                    throw new BulkError(\"\".concat(_this.name, \".bulkUpdate(): \").concat(numFailures, \" of \").concat(numEntries, \" operations failed\"), failures);\n                });\n            });\n        });\n    };\n    Table.prototype.bulkDelete = function (keys) {\n        var _this = this;\n        var numKeys = keys.length;\n        return this._trans('readwrite', function (trans) {\n            return _this.core.mutate({ trans: trans, type: 'delete', keys: keys });\n        }).then(function (_a) {\n            var numFailures = _a.numFailures, lastResult = _a.lastResult, failures = _a.failures;\n            if (numFailures === 0)\n                return lastResult;\n            throw new BulkError(\"\".concat(_this.name, \".bulkDelete(): \").concat(numFailures, \" of \").concat(numKeys, \" operations failed\"), failures);\n        });\n    };\n    return Table;\n}());\n\nfunction Events(ctx) {\n    var evs = {};\n    var rv = function (eventName, subscriber) {\n        if (subscriber) {\n            var i = arguments.length, args = new Array(i - 1);\n            while (--i)\n                args[i - 1] = arguments[i];\n            evs[eventName].subscribe.apply(null, args);\n            return ctx;\n        }\n        else if (typeof (eventName) === 'string') {\n            return evs[eventName];\n        }\n    };\n    rv.addEventType = add;\n    for (var i = 1, l = arguments.length; i < l; ++i) {\n        add(arguments[i]);\n    }\n    return rv;\n    function add(eventName, chainFunction, defaultFunction) {\n        if (typeof eventName === 'object')\n            return addConfiguredEvents(eventName);\n        if (!chainFunction)\n            chainFunction = reverseStoppableEventChain;\n        if (!defaultFunction)\n            defaultFunction = nop;\n        var context = {\n            subscribers: [],\n            fire: defaultFunction,\n            subscribe: function (cb) {\n                if (context.subscribers.indexOf(cb) === -1) {\n                    context.subscribers.push(cb);\n                    context.fire = chainFunction(context.fire, cb);\n                }\n            },\n            unsubscribe: function (cb) {\n                context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n            }\n        };\n        evs[eventName] = rv[eventName] = context;\n        return context;\n    }\n    function addConfiguredEvents(cfg) {\n        keys(cfg).forEach(function (eventName) {\n            var args = cfg[eventName];\n            if (isArray(args)) {\n                add(eventName, cfg[eventName][0], cfg[eventName][1]);\n            }\n            else if (args === 'asap') {\n                var context = add(eventName, mirror, function fire() {\n                    var i = arguments.length, args = new Array(i);\n                    while (i--)\n                        args[i] = arguments[i];\n                    context.subscribers.forEach(function (fn) {\n                        asap$1(function fireEvent() {\n                            fn.apply(null, args);\n                        });\n                    });\n                });\n            }\n            else\n                throw new exceptions.InvalidArgument(\"Invalid event config\");\n        });\n    }\n}\n\nfunction makeClassConstructor(prototype, constructor) {\n    derive(constructor).from({ prototype: prototype });\n    return constructor;\n}\n\nfunction createTableConstructor(db) {\n    return makeClassConstructor(Table.prototype, function Table(name, tableSchema, trans) {\n        this.db = db;\n        this._tx = trans;\n        this.name = name;\n        this.schema = tableSchema;\n        this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n            \"creating\": [hookCreatingChain, nop],\n            \"reading\": [pureFunctionChain, mirror],\n            \"updating\": [hookUpdatingChain, nop],\n            \"deleting\": [hookDeletingChain, nop]\n        });\n    });\n}\n\nfunction isPlainKeyRange(ctx, ignoreLimitFilter) {\n    return !(ctx.filter || ctx.algorithm || ctx.or) &&\n        (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n}\nfunction addFilter(ctx, fn) {\n    ctx.filter = combine(ctx.filter, fn);\n}\nfunction addReplayFilter(ctx, factory, isLimitFilter) {\n    var curr = ctx.replayFilter;\n    ctx.replayFilter = curr ? function () { return combine(curr(), factory()); } : factory;\n    ctx.justLimit = isLimitFilter && !curr;\n}\nfunction addMatchFilter(ctx, fn) {\n    ctx.isMatch = combine(ctx.isMatch, fn);\n}\nfunction getIndexOrStore(ctx, coreSchema) {\n    if (ctx.isPrimKey)\n        return coreSchema.primaryKey;\n    var index = coreSchema.getIndexByKeyPath(ctx.index);\n    if (!index)\n        throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n    return index;\n}\nfunction openCursor(ctx, coreTable, trans) {\n    var index = getIndexOrStore(ctx, coreTable.schema);\n    return coreTable.openCursor({\n        trans: trans,\n        values: !ctx.keysOnly,\n        reverse: ctx.dir === 'prev',\n        unique: !!ctx.unique,\n        query: {\n            index: index,\n            range: ctx.range\n        }\n    });\n}\nfunction iter(ctx, fn, coreTrans, coreTable) {\n    var filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n    if (!ctx.or) {\n        return iterate(openCursor(ctx, coreTable, coreTrans), combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n    }\n    else {\n        var set_1 = {};\n        var union = function (item, cursor, advance) {\n            if (!filter || filter(cursor, advance, function (result) { return cursor.stop(result); }, function (err) { return cursor.fail(err); })) {\n                var primaryKey = cursor.primaryKey;\n                var key = '' + primaryKey;\n                if (key === '[object ArrayBuffer]')\n                    key = '' + new Uint8Array(primaryKey);\n                if (!hasOwn(set_1, key)) {\n                    set_1[key] = true;\n                    fn(item, cursor, advance);\n                }\n            }\n        };\n        return Promise.all([\n            ctx.or._iterate(union, coreTrans),\n            iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)\n        ]);\n    }\n}\nfunction iterate(cursorPromise, filter, fn, valueMapper) {\n    var mappedFn = valueMapper ? function (x, c, a) { return fn(valueMapper(x), c, a); } : fn;\n    var wrappedFn = wrap(mappedFn);\n    return cursorPromise.then(function (cursor) {\n        if (cursor) {\n            return cursor.start(function () {\n                var c = function () { return cursor.continue(); };\n                if (!filter || filter(cursor, function (advancer) { return c = advancer; }, function (val) { cursor.stop(val); c = nop; }, function (e) { cursor.fail(e); c = nop; }))\n                    wrappedFn(cursor.value, cursor, function (advancer) { return c = advancer; });\n                c();\n            });\n        }\n    });\n}\n\nvar PropModSymbol = Symbol();\nvar PropModification =  (function () {\n    function PropModification(spec) {\n        Object.assign(this, spec);\n    }\n    PropModification.prototype.execute = function (value) {\n        var _a;\n        if (this.add !== undefined) {\n            var term = this.add;\n            if (isArray(term)) {\n                return __spreadArray(__spreadArray([], (isArray(value) ? value : []), true), term, true).sort();\n            }\n            if (typeof term === 'number')\n                return (Number(value) || 0) + term;\n            if (typeof term === 'bigint') {\n                try {\n                    return BigInt(value) + term;\n                }\n                catch (_b) {\n                    return BigInt(0) + term;\n                }\n            }\n            throw new TypeError(\"Invalid term \".concat(term));\n        }\n        if (this.remove !== undefined) {\n            var subtrahend_1 = this.remove;\n            if (isArray(subtrahend_1)) {\n                return isArray(value) ? value.filter(function (item) { return !subtrahend_1.includes(item); }).sort() : [];\n            }\n            if (typeof subtrahend_1 === 'number')\n                return Number(value) - subtrahend_1;\n            if (typeof subtrahend_1 === 'bigint') {\n                try {\n                    return BigInt(value) - subtrahend_1;\n                }\n                catch (_c) {\n                    return BigInt(0) - subtrahend_1;\n                }\n            }\n            throw new TypeError(\"Invalid subtrahend \".concat(subtrahend_1));\n        }\n        var prefixToReplace = (_a = this.replacePrefix) === null || _a === void 0 ? void 0 : _a[0];\n        if (prefixToReplace && typeof value === 'string' && value.startsWith(prefixToReplace)) {\n            return this.replacePrefix[1] + value.substring(prefixToReplace.length);\n        }\n        return value;\n    };\n    return PropModification;\n}());\n\nvar Collection =  (function () {\n    function Collection() {\n    }\n    Collection.prototype._read = function (fn, cb) {\n        var ctx = this._ctx;\n        return ctx.error ?\n            ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n            ctx.table._trans('readonly', fn).then(cb);\n    };\n    Collection.prototype._write = function (fn) {\n        var ctx = this._ctx;\n        return ctx.error ?\n            ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n            ctx.table._trans('readwrite', fn, \"locked\");\n    };\n    Collection.prototype._addAlgorithm = function (fn) {\n        var ctx = this._ctx;\n        ctx.algorithm = combine(ctx.algorithm, fn);\n    };\n    Collection.prototype._iterate = function (fn, coreTrans) {\n        return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n    };\n    Collection.prototype.clone = function (props) {\n        var rv = Object.create(this.constructor.prototype), ctx = Object.create(this._ctx);\n        if (props)\n            extend(ctx, props);\n        rv._ctx = ctx;\n        return rv;\n    };\n    Collection.prototype.raw = function () {\n        this._ctx.valueMapper = null;\n        return this;\n    };\n    Collection.prototype.each = function (fn) {\n        var ctx = this._ctx;\n        return this._read(function (trans) { return iter(ctx, fn, trans, ctx.table.core); });\n    };\n    Collection.prototype.count = function (cb) {\n        var _this = this;\n        return this._read(function (trans) {\n            var ctx = _this._ctx;\n            var coreTable = ctx.table.core;\n            if (isPlainKeyRange(ctx, true)) {\n                return coreTable.count({\n                    trans: trans,\n                    query: {\n                        index: getIndexOrStore(ctx, coreTable.schema),\n                        range: ctx.range\n                    }\n                }).then(function (count) { return Math.min(count, ctx.limit); });\n            }\n            else {\n                var count = 0;\n                return iter(ctx, function () { ++count; return false; }, trans, coreTable)\n                    .then(function () { return count; });\n            }\n        }).then(cb);\n    };\n    Collection.prototype.sortBy = function (keyPath, cb) {\n        var parts = keyPath.split('.').reverse(), lastPart = parts[0], lastIndex = parts.length - 1;\n        function getval(obj, i) {\n            if (i)\n                return getval(obj[parts[i]], i - 1);\n            return obj[lastPart];\n        }\n        var order = this._ctx.dir === \"next\" ? 1 : -1;\n        function sorter(a, b) {\n            var aVal = getval(a, lastIndex), bVal = getval(b, lastIndex);\n            return aVal < bVal ? -order : aVal > bVal ? order : 0;\n        }\n        return this.toArray(function (a) {\n            return a.sort(sorter);\n        }).then(cb);\n    };\n    Collection.prototype.toArray = function (cb) {\n        var _this = this;\n        return this._read(function (trans) {\n            var ctx = _this._ctx;\n            if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                var valueMapper_1 = ctx.valueMapper;\n                var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                return ctx.table.core.query({\n                    trans: trans,\n                    limit: ctx.limit,\n                    values: true,\n                    query: {\n                        index: index,\n                        range: ctx.range\n                    }\n                }).then(function (_a) {\n                    var result = _a.result;\n                    return valueMapper_1 ? result.map(valueMapper_1) : result;\n                });\n            }\n            else {\n                var a_1 = [];\n                return iter(ctx, function (item) { return a_1.push(item); }, trans, ctx.table.core).then(function () { return a_1; });\n            }\n        }, cb);\n    };\n    Collection.prototype.offset = function (offset) {\n        var ctx = this._ctx;\n        if (offset <= 0)\n            return this;\n        ctx.offset += offset;\n        if (isPlainKeyRange(ctx)) {\n            addReplayFilter(ctx, function () {\n                var offsetLeft = offset;\n                return function (cursor, advance) {\n                    if (offsetLeft === 0)\n                        return true;\n                    if (offsetLeft === 1) {\n                        --offsetLeft;\n                        return false;\n                    }\n                    advance(function () {\n                        cursor.advance(offsetLeft);\n                        offsetLeft = 0;\n                    });\n                    return false;\n                };\n            });\n        }\n        else {\n            addReplayFilter(ctx, function () {\n                var offsetLeft = offset;\n                return function () { return (--offsetLeft < 0); };\n            });\n        }\n        return this;\n    };\n    Collection.prototype.limit = function (numRows) {\n        this._ctx.limit = Math.min(this._ctx.limit, numRows);\n        addReplayFilter(this._ctx, function () {\n            var rowsLeft = numRows;\n            return function (cursor, advance, resolve) {\n                if (--rowsLeft <= 0)\n                    advance(resolve);\n                return rowsLeft >= 0;\n            };\n        }, true);\n        return this;\n    };\n    Collection.prototype.until = function (filterFunction, bIncludeStopEntry) {\n        addFilter(this._ctx, function (cursor, advance, resolve) {\n            if (filterFunction(cursor.value)) {\n                advance(resolve);\n                return bIncludeStopEntry;\n            }\n            else {\n                return true;\n            }\n        });\n        return this;\n    };\n    Collection.prototype.first = function (cb) {\n        return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n    };\n    Collection.prototype.last = function (cb) {\n        return this.reverse().first(cb);\n    };\n    Collection.prototype.filter = function (filterFunction) {\n        addFilter(this._ctx, function (cursor) {\n            return filterFunction(cursor.value);\n        });\n        addMatchFilter(this._ctx, filterFunction);\n        return this;\n    };\n    Collection.prototype.and = function (filter) {\n        return this.filter(filter);\n    };\n    Collection.prototype.or = function (indexName) {\n        return new this.db.WhereClause(this._ctx.table, indexName, this);\n    };\n    Collection.prototype.reverse = function () {\n        this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n        if (this._ondirectionchange)\n            this._ondirectionchange(this._ctx.dir);\n        return this;\n    };\n    Collection.prototype.desc = function () {\n        return this.reverse();\n    };\n    Collection.prototype.eachKey = function (cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n    };\n    Collection.prototype.eachUniqueKey = function (cb) {\n        this._ctx.unique = \"unique\";\n        return this.eachKey(cb);\n    };\n    Collection.prototype.eachPrimaryKey = function (cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n    };\n    Collection.prototype.keys = function (cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        var a = [];\n        return this.each(function (item, cursor) {\n            a.push(cursor.key);\n        }).then(function () {\n            return a;\n        }).then(cb);\n    };\n    Collection.prototype.primaryKeys = function (cb) {\n        var ctx = this._ctx;\n        if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n            return this._read(function (trans) {\n                var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                return ctx.table.core.query({\n                    trans: trans,\n                    values: false,\n                    limit: ctx.limit,\n                    query: {\n                        index: index,\n                        range: ctx.range\n                    }\n                });\n            }).then(function (_a) {\n                var result = _a.result;\n                return result;\n            }).then(cb);\n        }\n        ctx.keysOnly = !ctx.isMatch;\n        var a = [];\n        return this.each(function (item, cursor) {\n            a.push(cursor.primaryKey);\n        }).then(function () {\n            return a;\n        }).then(cb);\n    };\n    Collection.prototype.uniqueKeys = function (cb) {\n        this._ctx.unique = \"unique\";\n        return this.keys(cb);\n    };\n    Collection.prototype.firstKey = function (cb) {\n        return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n    };\n    Collection.prototype.lastKey = function (cb) {\n        return this.reverse().firstKey(cb);\n    };\n    Collection.prototype.distinct = function () {\n        var ctx = this._ctx, idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n        if (!idx || !idx.multi)\n            return this;\n        var set = {};\n        addFilter(this._ctx, function (cursor) {\n            var strKey = cursor.primaryKey.toString();\n            var found = hasOwn(set, strKey);\n            set[strKey] = true;\n            return !found;\n        });\n        return this;\n    };\n    Collection.prototype.modify = function (changes) {\n        var _this = this;\n        var ctx = this._ctx;\n        return this._write(function (trans) {\n            var modifyer;\n            if (typeof changes === 'function') {\n                modifyer = changes;\n            }\n            else {\n                var keyPaths = keys(changes);\n                var numKeys = keyPaths.length;\n                modifyer = function (item) {\n                    var anythingModified = false;\n                    for (var i = 0; i < numKeys; ++i) {\n                        var keyPath = keyPaths[i];\n                        var val = changes[keyPath];\n                        var origVal = getByKeyPath(item, keyPath);\n                        if (val instanceof PropModification) {\n                            setByKeyPath(item, keyPath, val.execute(origVal));\n                            anythingModified = true;\n                        }\n                        else if (origVal !== val) {\n                            setByKeyPath(item, keyPath, val);\n                            anythingModified = true;\n                        }\n                    }\n                    return anythingModified;\n                };\n            }\n            var coreTable = ctx.table.core;\n            var _a = coreTable.schema.primaryKey, outbound = _a.outbound, extractKey = _a.extractKey;\n            var limit = _this.db._options.modifyChunkSize || 200;\n            var totalFailures = [];\n            var successCount = 0;\n            var failedKeys = [];\n            var applyMutateResult = function (expectedCount, res) {\n                var failures = res.failures, numFailures = res.numFailures;\n                successCount += expectedCount - numFailures;\n                for (var _i = 0, _a = keys(failures); _i < _a.length; _i++) {\n                    var pos = _a[_i];\n                    totalFailures.push(failures[pos]);\n                }\n            };\n            return _this.clone().primaryKeys().then(function (keys) {\n                var nextChunk = function (offset) {\n                    var count = Math.min(limit, keys.length - offset);\n                    return coreTable.getMany({\n                        trans: trans,\n                        keys: keys.slice(offset, offset + count),\n                        cache: \"immutable\"\n                    }).then(function (values) {\n                        var addValues = [];\n                        var putValues = [];\n                        var putKeys = outbound ? [] : null;\n                        var deleteKeys = [];\n                        for (var i = 0; i < count; ++i) {\n                            var origValue = values[i];\n                            var ctx_1 = {\n                                value: deepClone(origValue),\n                                primKey: keys[offset + i]\n                            };\n                            if (modifyer.call(ctx_1, ctx_1.value, ctx_1) !== false) {\n                                if (ctx_1.value == null) {\n                                    deleteKeys.push(keys[offset + i]);\n                                }\n                                else if (!outbound && cmp(extractKey(origValue), extractKey(ctx_1.value)) !== 0) {\n                                    deleteKeys.push(keys[offset + i]);\n                                    addValues.push(ctx_1.value);\n                                }\n                                else {\n                                    putValues.push(ctx_1.value);\n                                    if (outbound)\n                                        putKeys.push(keys[offset + i]);\n                                }\n                            }\n                        }\n                        var criteria = isPlainKeyRange(ctx) &&\n                            ctx.limit === Infinity &&\n                            (typeof changes !== 'function' || changes === deleteCallback) && {\n                            index: ctx.index,\n                            range: ctx.range\n                        };\n                        return Promise.resolve(addValues.length > 0 &&\n                            coreTable.mutate({ trans: trans, type: 'add', values: addValues })\n                                .then(function (res) {\n                                for (var pos in res.failures) {\n                                    deleteKeys.splice(parseInt(pos), 1);\n                                }\n                                applyMutateResult(addValues.length, res);\n                            })).then(function () { return (putValues.length > 0 || (criteria && typeof changes === 'object')) &&\n                            coreTable.mutate({\n                                trans: trans,\n                                type: 'put',\n                                keys: putKeys,\n                                values: putValues,\n                                criteria: criteria,\n                                changeSpec: typeof changes !== 'function'\n                                    && changes\n                            }).then(function (res) { return applyMutateResult(putValues.length, res); }); }).then(function () { return (deleteKeys.length > 0 || (criteria && changes === deleteCallback)) &&\n                            coreTable.mutate({\n                                trans: trans,\n                                type: 'delete',\n                                keys: deleteKeys,\n                                criteria: criteria\n                            }).then(function (res) { return applyMutateResult(deleteKeys.length, res); }); }).then(function () {\n                            return keys.length > offset + count && nextChunk(offset + limit);\n                        });\n                    });\n                };\n                return nextChunk(0).then(function () {\n                    if (totalFailures.length > 0)\n                        throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys);\n                    return keys.length;\n                });\n            });\n        });\n    };\n    Collection.prototype.delete = function () {\n        var ctx = this._ctx, range = ctx.range;\n        if (isPlainKeyRange(ctx) &&\n            (ctx.isPrimKey || range.type === 3 ))\n         {\n            return this._write(function (trans) {\n                var primaryKey = ctx.table.core.schema.primaryKey;\n                var coreRange = range;\n                return ctx.table.core.count({ trans: trans, query: { index: primaryKey, range: coreRange } }).then(function (count) {\n                    return ctx.table.core.mutate({ trans: trans, type: 'deleteRange', range: coreRange })\n                        .then(function (_a) {\n                        var failures = _a.failures; _a.lastResult; _a.results; var numFailures = _a.numFailures;\n                        if (numFailures)\n                            throw new ModifyError(\"Could not delete some values\", Object.keys(failures).map(function (pos) { return failures[pos]; }), count - numFailures);\n                        return count - numFailures;\n                    });\n                });\n            });\n        }\n        return this.modify(deleteCallback);\n    };\n    return Collection;\n}());\nvar deleteCallback = function (value, ctx) { return ctx.value = null; };\n\nfunction createCollectionConstructor(db) {\n    return makeClassConstructor(Collection.prototype, function Collection(whereClause, keyRangeGenerator) {\n        this.db = db;\n        var keyRange = AnyRange, error = null;\n        if (keyRangeGenerator)\n            try {\n                keyRange = keyRangeGenerator();\n            }\n            catch (ex) {\n                error = ex;\n            }\n        var whereCtx = whereClause._ctx;\n        var table = whereCtx.table;\n        var readingHook = table.hook.reading.fire;\n        this._ctx = {\n            table: table,\n            index: whereCtx.index,\n            isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n            range: keyRange,\n            keysOnly: false,\n            dir: \"next\",\n            unique: \"\",\n            algorithm: null,\n            filter: null,\n            replayFilter: null,\n            justLimit: true,\n            isMatch: null,\n            offset: 0,\n            limit: Infinity,\n            error: error,\n            or: whereCtx.or,\n            valueMapper: readingHook !== mirror ? readingHook : null\n        };\n    });\n}\n\nfunction simpleCompare(a, b) {\n    return a < b ? -1 : a === b ? 0 : 1;\n}\nfunction simpleCompareReverse(a, b) {\n    return a > b ? -1 : a === b ? 0 : 1;\n}\n\nfunction fail(collectionOrWhereClause, err, T) {\n    var collection = collectionOrWhereClause instanceof WhereClause ?\n        new collectionOrWhereClause.Collection(collectionOrWhereClause) :\n        collectionOrWhereClause;\n    collection._ctx.error = T ? new T(err) : new TypeError(err);\n    return collection;\n}\nfunction emptyCollection(whereClause) {\n    return new whereClause.Collection(whereClause, function () { return rangeEqual(\"\"); }).limit(0);\n}\nfunction upperFactory(dir) {\n    return dir === \"next\" ?\n        function (s) { return s.toUpperCase(); } :\n        function (s) { return s.toLowerCase(); };\n}\nfunction lowerFactory(dir) {\n    return dir === \"next\" ?\n        function (s) { return s.toLowerCase(); } :\n        function (s) { return s.toUpperCase(); };\n}\nfunction nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n    var length = Math.min(key.length, lowerNeedle.length);\n    var llp = -1;\n    for (var i = 0; i < length; ++i) {\n        var lwrKeyChar = lowerKey[i];\n        if (lwrKeyChar !== lowerNeedle[i]) {\n            if (cmp(key[i], upperNeedle[i]) < 0)\n                return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n            if (cmp(key[i], lowerNeedle[i]) < 0)\n                return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n            if (llp >= 0)\n                return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n            return null;\n        }\n        if (cmp(key[i], lwrKeyChar) < 0)\n            llp = i;\n    }\n    if (length < lowerNeedle.length && dir === \"next\")\n        return key + upperNeedle.substr(key.length);\n    if (length < key.length && dir === \"prev\")\n        return key.substr(0, upperNeedle.length);\n    return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n}\nfunction addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n    var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix, needlesLen = needles.length;\n    if (!needles.every(function (s) { return typeof s === 'string'; })) {\n        return fail(whereClause, STRING_EXPECTED);\n    }\n    function initDirection(dir) {\n        upper = upperFactory(dir);\n        lower = lowerFactory(dir);\n        compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n        var needleBounds = needles.map(function (needle) {\n            return { lower: lower(needle), upper: upper(needle) };\n        }).sort(function (a, b) {\n            return compare(a.lower, b.lower);\n        });\n        upperNeedles = needleBounds.map(function (nb) { return nb.upper; });\n        lowerNeedles = needleBounds.map(function (nb) { return nb.lower; });\n        direction = dir;\n        nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n    }\n    initDirection(\"next\");\n    var c = new whereClause.Collection(whereClause, function () { return createRange(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix); });\n    c._ondirectionchange = function (direction) {\n        initDirection(direction);\n    };\n    var firstPossibleNeedle = 0;\n    c._addAlgorithm(function (cursor, advance, resolve) {\n        var key = cursor.key;\n        if (typeof key !== 'string')\n            return false;\n        var lowerKey = lower(key);\n        if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n            return true;\n        }\n        else {\n            var lowestPossibleCasing = null;\n            for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                if (casing === null && lowestPossibleCasing === null)\n                    firstPossibleNeedle = i + 1;\n                else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                    lowestPossibleCasing = casing;\n                }\n            }\n            if (lowestPossibleCasing !== null) {\n                advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n            }\n            else {\n                advance(resolve);\n            }\n            return false;\n        }\n    });\n    return c;\n}\nfunction createRange(lower, upper, lowerOpen, upperOpen) {\n    return {\n        type: 2 ,\n        lower: lower,\n        upper: upper,\n        lowerOpen: lowerOpen,\n        upperOpen: upperOpen\n    };\n}\nfunction rangeEqual(value) {\n    return {\n        type: 1 ,\n        lower: value,\n        upper: value\n    };\n}\n\nvar WhereClause =  (function () {\n    function WhereClause() {\n    }\n    Object.defineProperty(WhereClause.prototype, \"Collection\", {\n        get: function () {\n            return this._ctx.table.db.Collection;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    WhereClause.prototype.between = function (lower, upper, includeLower, includeUpper) {\n        includeLower = includeLower !== false;\n        includeUpper = includeUpper === true;\n        try {\n            if ((this._cmp(lower, upper) > 0) ||\n                (this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n                return emptyCollection(this);\n            return new this.Collection(this, function () { return createRange(lower, upper, !includeLower, !includeUpper); });\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n    };\n    WhereClause.prototype.equals = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return rangeEqual(value); });\n    };\n    WhereClause.prototype.above = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(value, undefined, true); });\n    };\n    WhereClause.prototype.aboveOrEqual = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(value, undefined, false); });\n    };\n    WhereClause.prototype.below = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(undefined, value, false, true); });\n    };\n    WhereClause.prototype.belowOrEqual = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(undefined, value); });\n    };\n    WhereClause.prototype.startsWith = function (str) {\n        if (typeof str !== 'string')\n            return fail(this, STRING_EXPECTED);\n        return this.between(str, str + maxString, true, true);\n    };\n    WhereClause.prototype.startsWithIgnoreCase = function (str) {\n        if (str === \"\")\n            return this.startsWith(str);\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return x.indexOf(a[0]) === 0; }, [str], maxString);\n    };\n    WhereClause.prototype.equalsIgnoreCase = function (str) {\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return x === a[0]; }, [str], \"\");\n    };\n    WhereClause.prototype.anyOfIgnoreCase = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return emptyCollection(this);\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return a.indexOf(x) !== -1; }, set, \"\");\n    };\n    WhereClause.prototype.startsWithAnyOfIgnoreCase = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return emptyCollection(this);\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return a.some(function (n) { return x.indexOf(n) === 0; }); }, set, maxString);\n    };\n    WhereClause.prototype.anyOf = function () {\n        var _this = this;\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        var compare = this._cmp;\n        try {\n            set.sort(compare);\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        if (set.length === 0)\n            return emptyCollection(this);\n        var c = new this.Collection(this, function () { return createRange(set[0], set[set.length - 1]); });\n        c._ondirectionchange = function (direction) {\n            compare = (direction === \"next\" ?\n                _this._ascending :\n                _this._descending);\n            set.sort(compare);\n        };\n        var i = 0;\n        c._addAlgorithm(function (cursor, advance, resolve) {\n            var key = cursor.key;\n            while (compare(key, set[i]) > 0) {\n                ++i;\n                if (i === set.length) {\n                    advance(resolve);\n                    return false;\n                }\n            }\n            if (compare(key, set[i]) === 0) {\n                return true;\n            }\n            else {\n                advance(function () { cursor.continue(set[i]); });\n                return false;\n            }\n        });\n        return c;\n    };\n    WhereClause.prototype.notEqual = function (value) {\n        return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], { includeLowers: false, includeUppers: false });\n    };\n    WhereClause.prototype.noneOf = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return new this.Collection(this);\n        try {\n            set.sort(this._ascending);\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        var ranges = set.reduce(function (res, val) { return res ?\n            res.concat([[res[res.length - 1][1], val]]) :\n            [[minKey, val]]; }, null);\n        ranges.push([set[set.length - 1], this.db._maxKey]);\n        return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n    };\n    WhereClause.prototype.inAnyRange = function (ranges, options) {\n        var _this = this;\n        var cmp = this._cmp, ascending = this._ascending, descending = this._descending, min = this._min, max = this._max;\n        if (ranges.length === 0)\n            return emptyCollection(this);\n        if (!ranges.every(function (range) {\n            return range[0] !== undefined &&\n                range[1] !== undefined &&\n                ascending(range[0], range[1]) <= 0;\n        })) {\n            return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n        }\n        var includeLowers = !options || options.includeLowers !== false;\n        var includeUppers = options && options.includeUppers === true;\n        function addRange(ranges, newRange) {\n            var i = 0, l = ranges.length;\n            for (; i < l; ++i) {\n                var range = ranges[i];\n                if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                    range[0] = min(range[0], newRange[0]);\n                    range[1] = max(range[1], newRange[1]);\n                    break;\n                }\n            }\n            if (i === l)\n                ranges.push(newRange);\n            return ranges;\n        }\n        var sortDirection = ascending;\n        function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n        var set;\n        try {\n            set = ranges.reduce(addRange, []);\n            set.sort(rangeSorter);\n        }\n        catch (ex) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        var rangePos = 0;\n        var keyIsBeyondCurrentEntry = includeUppers ?\n            function (key) { return ascending(key, set[rangePos][1]) > 0; } :\n            function (key) { return ascending(key, set[rangePos][1]) >= 0; };\n        var keyIsBeforeCurrentEntry = includeLowers ?\n            function (key) { return descending(key, set[rangePos][0]) > 0; } :\n            function (key) { return descending(key, set[rangePos][0]) >= 0; };\n        function keyWithinCurrentRange(key) {\n            return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n        }\n        var checkKey = keyIsBeyondCurrentEntry;\n        var c = new this.Collection(this, function () { return createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers); });\n        c._ondirectionchange = function (direction) {\n            if (direction === \"next\") {\n                checkKey = keyIsBeyondCurrentEntry;\n                sortDirection = ascending;\n            }\n            else {\n                checkKey = keyIsBeforeCurrentEntry;\n                sortDirection = descending;\n            }\n            set.sort(rangeSorter);\n        };\n        c._addAlgorithm(function (cursor, advance, resolve) {\n            var key = cursor.key;\n            while (checkKey(key)) {\n                ++rangePos;\n                if (rangePos === set.length) {\n                    advance(resolve);\n                    return false;\n                }\n            }\n            if (keyWithinCurrentRange(key)) {\n                return true;\n            }\n            else if (_this._cmp(key, set[rangePos][1]) === 0 || _this._cmp(key, set[rangePos][0]) === 0) {\n                return false;\n            }\n            else {\n                advance(function () {\n                    if (sortDirection === ascending)\n                        cursor.continue(set[rangePos][0]);\n                    else\n                        cursor.continue(set[rangePos][1]);\n                });\n                return false;\n            }\n        });\n        return c;\n    };\n    WhereClause.prototype.startsWithAnyOf = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (!set.every(function (s) { return typeof s === 'string'; })) {\n            return fail(this, \"startsWithAnyOf() only works with strings\");\n        }\n        if (set.length === 0)\n            return emptyCollection(this);\n        return this.inAnyRange(set.map(function (str) { return [str, str + maxString]; }));\n    };\n    return WhereClause;\n}());\n\nfunction createWhereClauseConstructor(db) {\n    return makeClassConstructor(WhereClause.prototype, function WhereClause(table, index, orCollection) {\n        this.db = db;\n        this._ctx = {\n            table: table,\n            index: index === \":id\" ? null : index,\n            or: orCollection\n        };\n        this._cmp = this._ascending = cmp;\n        this._descending = function (a, b) { return cmp(b, a); };\n        this._max = function (a, b) { return cmp(a, b) > 0 ? a : b; };\n        this._min = function (a, b) { return cmp(a, b) < 0 ? a : b; };\n        this._IDBKeyRange = db._deps.IDBKeyRange;\n        if (!this._IDBKeyRange)\n            throw new exceptions.MissingAPI();\n    });\n}\n\nfunction eventRejectHandler(reject) {\n    return wrap(function (event) {\n        preventDefault(event);\n        reject(event.target.error);\n        return false;\n    });\n}\nfunction preventDefault(event) {\n    if (event.stopPropagation)\n        event.stopPropagation();\n    if (event.preventDefault)\n        event.preventDefault();\n}\n\nvar DEXIE_STORAGE_MUTATED_EVENT_NAME = 'storagemutated';\nvar STORAGE_MUTATED_DOM_EVENT_NAME = 'x-storagemutated-1';\nvar globalEvents = Events(null, DEXIE_STORAGE_MUTATED_EVENT_NAME);\n\nvar Transaction =  (function () {\n    function Transaction() {\n    }\n    Transaction.prototype._lock = function () {\n        assert(!PSD.global);\n        ++this._reculock;\n        if (this._reculock === 1 && !PSD.global)\n            PSD.lockOwnerFor = this;\n        return this;\n    };\n    Transaction.prototype._unlock = function () {\n        assert(!PSD.global);\n        if (--this._reculock === 0) {\n            if (!PSD.global)\n                PSD.lockOwnerFor = null;\n            while (this._blockedFuncs.length > 0 && !this._locked()) {\n                var fnAndPSD = this._blockedFuncs.shift();\n                try {\n                    usePSD(fnAndPSD[1], fnAndPSD[0]);\n                }\n                catch (e) { }\n            }\n        }\n        return this;\n    };\n    Transaction.prototype._locked = function () {\n        return this._reculock && PSD.lockOwnerFor !== this;\n    };\n    Transaction.prototype.create = function (idbtrans) {\n        var _this = this;\n        if (!this.mode)\n            return this;\n        var idbdb = this.db.idbdb;\n        var dbOpenError = this.db._state.dbOpenError;\n        assert(!this.idbtrans);\n        if (!idbtrans && !idbdb) {\n            switch (dbOpenError && dbOpenError.name) {\n                case \"DatabaseClosedError\":\n                    throw new exceptions.DatabaseClosed(dbOpenError);\n                case \"MissingAPIError\":\n                    throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                default:\n                    throw new exceptions.OpenFailed(dbOpenError);\n            }\n        }\n        if (!this.active)\n            throw new exceptions.TransactionInactive();\n        assert(this._completion._state === null);\n        idbtrans = this.idbtrans = idbtrans ||\n            (this.db.core\n                ? this.db.core.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })\n                : idbdb.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability }));\n        idbtrans.onerror = wrap(function (ev) {\n            preventDefault(ev);\n            _this._reject(idbtrans.error);\n        });\n        idbtrans.onabort = wrap(function (ev) {\n            preventDefault(ev);\n            _this.active && _this._reject(new exceptions.Abort(idbtrans.error));\n            _this.active = false;\n            _this.on(\"abort\").fire(ev);\n        });\n        idbtrans.oncomplete = wrap(function () {\n            _this.active = false;\n            _this._resolve();\n            if ('mutatedParts' in idbtrans) {\n                globalEvents.storagemutated.fire(idbtrans[\"mutatedParts\"]);\n            }\n        });\n        return this;\n    };\n    Transaction.prototype._promise = function (mode, fn, bWriteLock) {\n        var _this = this;\n        if (mode === 'readwrite' && this.mode !== 'readwrite')\n            return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n        if (!this.active)\n            return rejection(new exceptions.TransactionInactive());\n        if (this._locked()) {\n            return new DexiePromise(function (resolve, reject) {\n                _this._blockedFuncs.push([function () {\n                        _this._promise(mode, fn, bWriteLock).then(resolve, reject);\n                    }, PSD]);\n            });\n        }\n        else if (bWriteLock) {\n            return newScope(function () {\n                var p = new DexiePromise(function (resolve, reject) {\n                    _this._lock();\n                    var rv = fn(resolve, reject, _this);\n                    if (rv && rv.then)\n                        rv.then(resolve, reject);\n                });\n                p.finally(function () { return _this._unlock(); });\n                p._lib = true;\n                return p;\n            });\n        }\n        else {\n            var p = new DexiePromise(function (resolve, reject) {\n                var rv = fn(resolve, reject, _this);\n                if (rv && rv.then)\n                    rv.then(resolve, reject);\n            });\n            p._lib = true;\n            return p;\n        }\n    };\n    Transaction.prototype._root = function () {\n        return this.parent ? this.parent._root() : this;\n    };\n    Transaction.prototype.waitFor = function (promiseLike) {\n        var root = this._root();\n        var promise = DexiePromise.resolve(promiseLike);\n        if (root._waitingFor) {\n            root._waitingFor = root._waitingFor.then(function () { return promise; });\n        }\n        else {\n            root._waitingFor = promise;\n            root._waitingQueue = [];\n            var store = root.idbtrans.objectStore(root.storeNames[0]);\n            (function spin() {\n                ++root._spinCount;\n                while (root._waitingQueue.length)\n                    (root._waitingQueue.shift())();\n                if (root._waitingFor)\n                    store.get(-Infinity).onsuccess = spin;\n            }());\n        }\n        var currentWaitPromise = root._waitingFor;\n        return new DexiePromise(function (resolve, reject) {\n            promise.then(function (res) { return root._waitingQueue.push(wrap(resolve.bind(null, res))); }, function (err) { return root._waitingQueue.push(wrap(reject.bind(null, err))); }).finally(function () {\n                if (root._waitingFor === currentWaitPromise) {\n                    root._waitingFor = null;\n                }\n            });\n        });\n    };\n    Transaction.prototype.abort = function () {\n        if (this.active) {\n            this.active = false;\n            if (this.idbtrans)\n                this.idbtrans.abort();\n            this._reject(new exceptions.Abort());\n        }\n    };\n    Transaction.prototype.table = function (tableName) {\n        var memoizedTables = (this._memoizedTables || (this._memoizedTables = {}));\n        if (hasOwn(memoizedTables, tableName))\n            return memoizedTables[tableName];\n        var tableSchema = this.schema[tableName];\n        if (!tableSchema) {\n            throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n        }\n        var transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n        transactionBoundTable.core = this.db.core.table(tableName);\n        memoizedTables[tableName] = transactionBoundTable;\n        return transactionBoundTable;\n    };\n    return Transaction;\n}());\n\nfunction createTransactionConstructor(db) {\n    return makeClassConstructor(Transaction.prototype, function Transaction(mode, storeNames, dbschema, chromeTransactionDurability, parent) {\n        var _this = this;\n        this.db = db;\n        this.mode = mode;\n        this.storeNames = storeNames;\n        this.schema = dbschema;\n        this.chromeTransactionDurability = chromeTransactionDurability;\n        this.idbtrans = null;\n        this.on = Events(this, \"complete\", \"error\", \"abort\");\n        this.parent = parent || null;\n        this.active = true;\n        this._reculock = 0;\n        this._blockedFuncs = [];\n        this._resolve = null;\n        this._reject = null;\n        this._waitingFor = null;\n        this._waitingQueue = null;\n        this._spinCount = 0;\n        this._completion = new DexiePromise(function (resolve, reject) {\n            _this._resolve = resolve;\n            _this._reject = reject;\n        });\n        this._completion.then(function () {\n            _this.active = false;\n            _this.on.complete.fire();\n        }, function (e) {\n            var wasActive = _this.active;\n            _this.active = false;\n            _this.on.error.fire(e);\n            _this.parent ?\n                _this.parent._reject(e) :\n                wasActive && _this.idbtrans && _this.idbtrans.abort();\n            return rejection(e);\n        });\n    });\n}\n\nfunction createIndexSpec(name, keyPath, unique, multi, auto, compound, isPrimKey) {\n    return {\n        name: name,\n        keyPath: keyPath,\n        unique: unique,\n        multi: multi,\n        auto: auto,\n        compound: compound,\n        src: (unique && !isPrimKey ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath)\n    };\n}\nfunction nameFromKeyPath(keyPath) {\n    return typeof keyPath === 'string' ?\n        keyPath :\n        keyPath ? ('[' + [].join.call(keyPath, '+') + ']') : \"\";\n}\n\nfunction createTableSchema(name, primKey, indexes) {\n    return {\n        name: name,\n        primKey: primKey,\n        indexes: indexes,\n        mappedClass: null,\n        idxByName: arrayToObject(indexes, function (index) { return [index.name, index]; })\n    };\n}\n\nfunction safariMultiStoreFix(storeNames) {\n    return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\nvar getMaxKey = function (IdbKeyRange) {\n    try {\n        IdbKeyRange.only([[]]);\n        getMaxKey = function () { return [[]]; };\n        return [[]];\n    }\n    catch (e) {\n        getMaxKey = function () { return maxString; };\n        return maxString;\n    }\n};\n\nfunction getKeyExtractor(keyPath) {\n    if (keyPath == null) {\n        return function () { return undefined; };\n    }\n    else if (typeof keyPath === 'string') {\n        return getSinglePathKeyExtractor(keyPath);\n    }\n    else {\n        return function (obj) { return getByKeyPath(obj, keyPath); };\n    }\n}\nfunction getSinglePathKeyExtractor(keyPath) {\n    var split = keyPath.split('.');\n    if (split.length === 1) {\n        return function (obj) { return obj[keyPath]; };\n    }\n    else {\n        return function (obj) { return getByKeyPath(obj, keyPath); };\n    }\n}\n\nfunction arrayify(arrayLike) {\n    return [].slice.call(arrayLike);\n}\nvar _id_counter = 0;\nfunction getKeyPathAlias(keyPath) {\n    return keyPath == null ?\n        \":id\" :\n        typeof keyPath === 'string' ?\n            keyPath :\n            \"[\".concat(keyPath.join('+'), \"]\");\n}\nfunction createDBCore(db, IdbKeyRange, tmpTrans) {\n    function extractSchema(db, trans) {\n        var tables = arrayify(db.objectStoreNames);\n        return {\n            schema: {\n                name: db.name,\n                tables: tables.map(function (table) { return trans.objectStore(table); }).map(function (store) {\n                    var keyPath = store.keyPath, autoIncrement = store.autoIncrement;\n                    var compound = isArray(keyPath);\n                    var outbound = keyPath == null;\n                    var indexByKeyPath = {};\n                    var result = {\n                        name: store.name,\n                        primaryKey: {\n                            name: null,\n                            isPrimaryKey: true,\n                            outbound: outbound,\n                            compound: compound,\n                            keyPath: keyPath,\n                            autoIncrement: autoIncrement,\n                            unique: true,\n                            extractKey: getKeyExtractor(keyPath)\n                        },\n                        indexes: arrayify(store.indexNames).map(function (indexName) { return store.index(indexName); })\n                            .map(function (index) {\n                            var name = index.name, unique = index.unique, multiEntry = index.multiEntry, keyPath = index.keyPath;\n                            var compound = isArray(keyPath);\n                            var result = {\n                                name: name,\n                                compound: compound,\n                                keyPath: keyPath,\n                                unique: unique,\n                                multiEntry: multiEntry,\n                                extractKey: getKeyExtractor(keyPath)\n                            };\n                            indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n                            return result;\n                        }),\n                        getIndexByKeyPath: function (keyPath) { return indexByKeyPath[getKeyPathAlias(keyPath)]; }\n                    };\n                    indexByKeyPath[\":id\"] = result.primaryKey;\n                    if (keyPath != null) {\n                        indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n                    }\n                    return result;\n                })\n            },\n            hasGetAll: tables.length > 0 && ('getAll' in trans.objectStore(tables[0])) &&\n                !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n                    !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n                    [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n        };\n    }\n    function makeIDBKeyRange(range) {\n        if (range.type === 3 )\n            return null;\n        if (range.type === 4 )\n            throw new Error(\"Cannot convert never type to IDBKeyRange\");\n        var lower = range.lower, upper = range.upper, lowerOpen = range.lowerOpen, upperOpen = range.upperOpen;\n        var idbRange = lower === undefined ?\n            upper === undefined ?\n                null :\n                IdbKeyRange.upperBound(upper, !!upperOpen) :\n            upper === undefined ?\n                IdbKeyRange.lowerBound(lower, !!lowerOpen) :\n                IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n        return idbRange;\n    }\n    function createDbCoreTable(tableSchema) {\n        var tableName = tableSchema.name;\n        function mutate(_a) {\n            var trans = _a.trans, type = _a.type, keys = _a.keys, values = _a.values, range = _a.range;\n            return new Promise(function (resolve, reject) {\n                resolve = wrap(resolve);\n                var store = trans.objectStore(tableName);\n                var outbound = store.keyPath == null;\n                var isAddOrPut = type === \"put\" || type === \"add\";\n                if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange')\n                    throw new Error(\"Invalid operation type: \" + type);\n                var length = (keys || values || { length: 1 }).length;\n                if (keys && values && keys.length !== values.length) {\n                    throw new Error(\"Given keys array must have same length as given values array.\");\n                }\n                if (length === 0)\n                    return resolve({ numFailures: 0, failures: {}, results: [], lastResult: undefined });\n                var req;\n                var reqs = [];\n                var failures = [];\n                var numFailures = 0;\n                var errorHandler = function (event) {\n                    ++numFailures;\n                    preventDefault(event);\n                };\n                if (type === 'deleteRange') {\n                    if (range.type === 4 )\n                        return resolve({ numFailures: numFailures, failures: failures, results: [], lastResult: undefined });\n                    if (range.type === 3 )\n                        reqs.push(req = store.clear());\n                    else\n                        reqs.push(req = store.delete(makeIDBKeyRange(range)));\n                }\n                else {\n                    var _a = isAddOrPut ?\n                        outbound ?\n                            [values, keys] :\n                            [values, null] :\n                        [keys, null], args1 = _a[0], args2 = _a[1];\n                    if (isAddOrPut) {\n                        for (var i = 0; i < length; ++i) {\n                            reqs.push(req = (args2 && args2[i] !== undefined ?\n                                store[type](args1[i], args2[i]) :\n                                store[type](args1[i])));\n                            req.onerror = errorHandler;\n                        }\n                    }\n                    else {\n                        for (var i = 0; i < length; ++i) {\n                            reqs.push(req = store[type](args1[i]));\n                            req.onerror = errorHandler;\n                        }\n                    }\n                }\n                var done = function (event) {\n                    var lastResult = event.target.result;\n                    reqs.forEach(function (req, i) { return req.error != null && (failures[i] = req.error); });\n                    resolve({\n                        numFailures: numFailures,\n                        failures: failures,\n                        results: type === \"delete\" ? keys : reqs.map(function (req) { return req.result; }),\n                        lastResult: lastResult\n                    });\n                };\n                req.onerror = function (event) {\n                    errorHandler(event);\n                    done(event);\n                };\n                req.onsuccess = done;\n            });\n        }\n        function openCursor(_a) {\n            var trans = _a.trans, values = _a.values, query = _a.query, reverse = _a.reverse, unique = _a.unique;\n            return new Promise(function (resolve, reject) {\n                resolve = wrap(resolve);\n                var index = query.index, range = query.range;\n                var store = trans.objectStore(tableName);\n                var source = index.isPrimaryKey ?\n                    store :\n                    store.index(index.name);\n                var direction = reverse ?\n                    unique ?\n                        \"prevunique\" :\n                        \"prev\" :\n                    unique ?\n                        \"nextunique\" :\n                        \"next\";\n                var req = values || !('openKeyCursor' in source) ?\n                    source.openCursor(makeIDBKeyRange(range), direction) :\n                    source.openKeyCursor(makeIDBKeyRange(range), direction);\n                req.onerror = eventRejectHandler(reject);\n                req.onsuccess = wrap(function (ev) {\n                    var cursor = req.result;\n                    if (!cursor) {\n                        resolve(null);\n                        return;\n                    }\n                    cursor.___id = ++_id_counter;\n                    cursor.done = false;\n                    var _cursorContinue = cursor.continue.bind(cursor);\n                    var _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n                    if (_cursorContinuePrimaryKey)\n                        _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n                    var _cursorAdvance = cursor.advance.bind(cursor);\n                    var doThrowCursorIsNotStarted = function () { throw new Error(\"Cursor not started\"); };\n                    var doThrowCursorIsStopped = function () { throw new Error(\"Cursor not stopped\"); };\n                    cursor.trans = trans;\n                    cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n                    cursor.fail = wrap(reject);\n                    cursor.next = function () {\n                        var _this = this;\n                        var gotOne = 1;\n                        return this.start(function () { return gotOne-- ? _this.continue() : _this.stop(); }).then(function () { return _this; });\n                    };\n                    cursor.start = function (callback) {\n                        var iterationPromise = new Promise(function (resolveIteration, rejectIteration) {\n                            resolveIteration = wrap(resolveIteration);\n                            req.onerror = eventRejectHandler(rejectIteration);\n                            cursor.fail = rejectIteration;\n                            cursor.stop = function (value) {\n                                cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                                resolveIteration(value);\n                            };\n                        });\n                        var guardedCallback = function () {\n                            if (req.result) {\n                                try {\n                                    callback();\n                                }\n                                catch (err) {\n                                    cursor.fail(err);\n                                }\n                            }\n                            else {\n                                cursor.done = true;\n                                cursor.start = function () { throw new Error(\"Cursor behind last entry\"); };\n                                cursor.stop();\n                            }\n                        };\n                        req.onsuccess = wrap(function (ev) {\n                            req.onsuccess = guardedCallback;\n                            guardedCallback();\n                        });\n                        cursor.continue = _cursorContinue;\n                        cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n                        cursor.advance = _cursorAdvance;\n                        guardedCallback();\n                        return iterationPromise;\n                    };\n                    resolve(cursor);\n                }, reject);\n            });\n        }\n        function query(hasGetAll) {\n            return function (request) {\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var trans = request.trans, values = request.values, limit = request.limit, query = request.query;\n                    var nonInfinitLimit = limit === Infinity ? undefined : limit;\n                    var index = query.index, range = query.range;\n                    var store = trans.objectStore(tableName);\n                    var source = index.isPrimaryKey ? store : store.index(index.name);\n                    var idbKeyRange = makeIDBKeyRange(range);\n                    if (limit === 0)\n                        return resolve({ result: [] });\n                    if (hasGetAll) {\n                        var req = values ?\n                            source.getAll(idbKeyRange, nonInfinitLimit) :\n                            source.getAllKeys(idbKeyRange, nonInfinitLimit);\n                        req.onsuccess = function (event) { return resolve({ result: event.target.result }); };\n                        req.onerror = eventRejectHandler(reject);\n                    }\n                    else {\n                        var count_1 = 0;\n                        var req_1 = values || !('openKeyCursor' in source) ?\n                            source.openCursor(idbKeyRange) :\n                            source.openKeyCursor(idbKeyRange);\n                        var result_1 = [];\n                        req_1.onsuccess = function (event) {\n                            var cursor = req_1.result;\n                            if (!cursor)\n                                return resolve({ result: result_1 });\n                            result_1.push(values ? cursor.value : cursor.primaryKey);\n                            if (++count_1 === limit)\n                                return resolve({ result: result_1 });\n                            cursor.continue();\n                        };\n                        req_1.onerror = eventRejectHandler(reject);\n                    }\n                });\n            };\n        }\n        return {\n            name: tableName,\n            schema: tableSchema,\n            mutate: mutate,\n            getMany: function (_a) {\n                var trans = _a.trans, keys = _a.keys;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var store = trans.objectStore(tableName);\n                    var length = keys.length;\n                    var result = new Array(length);\n                    var keyCount = 0;\n                    var callbackCount = 0;\n                    var req;\n                    var successHandler = function (event) {\n                        var req = event.target;\n                        if ((result[req._pos] = req.result) != null)\n                            ;\n                        if (++callbackCount === keyCount)\n                            resolve(result);\n                    };\n                    var errorHandler = eventRejectHandler(reject);\n                    for (var i = 0; i < length; ++i) {\n                        var key = keys[i];\n                        if (key != null) {\n                            req = store.get(keys[i]);\n                            req._pos = i;\n                            req.onsuccess = successHandler;\n                            req.onerror = errorHandler;\n                            ++keyCount;\n                        }\n                    }\n                    if (keyCount === 0)\n                        resolve(result);\n                });\n            },\n            get: function (_a) {\n                var trans = _a.trans, key = _a.key;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var store = trans.objectStore(tableName);\n                    var req = store.get(key);\n                    req.onsuccess = function (event) { return resolve(event.target.result); };\n                    req.onerror = eventRejectHandler(reject);\n                });\n            },\n            query: query(hasGetAll),\n            openCursor: openCursor,\n            count: function (_a) {\n                var query = _a.query, trans = _a.trans;\n                var index = query.index, range = query.range;\n                return new Promise(function (resolve, reject) {\n                    var store = trans.objectStore(tableName);\n                    var source = index.isPrimaryKey ? store : store.index(index.name);\n                    var idbKeyRange = makeIDBKeyRange(range);\n                    var req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n                    req.onsuccess = wrap(function (ev) { return resolve(ev.target.result); });\n                    req.onerror = eventRejectHandler(reject);\n                });\n            }\n        };\n    }\n    var _a = extractSchema(db, tmpTrans), schema = _a.schema, hasGetAll = _a.hasGetAll;\n    var tables = schema.tables.map(function (tableSchema) { return createDbCoreTable(tableSchema); });\n    var tableMap = {};\n    tables.forEach(function (table) { return tableMap[table.name] = table; });\n    return {\n        stack: \"dbcore\",\n        transaction: db.transaction.bind(db),\n        table: function (name) {\n            var result = tableMap[name];\n            if (!result)\n                throw new Error(\"Table '\".concat(name, \"' not found\"));\n            return tableMap[name];\n        },\n        MIN_KEY: -Infinity,\n        MAX_KEY: getMaxKey(IdbKeyRange),\n        schema: schema\n    };\n}\n\nfunction createMiddlewareStack(stackImpl, middlewares) {\n    return middlewares.reduce(function (down, _a) {\n        var create = _a.create;\n        return (__assign(__assign({}, down), create(down)));\n    }, stackImpl);\n}\nfunction createMiddlewareStacks(middlewares, idbdb, _a, tmpTrans) {\n    var IDBKeyRange = _a.IDBKeyRange; _a.indexedDB;\n    var dbcore = createMiddlewareStack(createDBCore(idbdb, IDBKeyRange, tmpTrans), middlewares.dbcore);\n    return {\n        dbcore: dbcore\n    };\n}\nfunction generateMiddlewareStacks(db, tmpTrans) {\n    var idbdb = tmpTrans.db;\n    var stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n    db.core = stacks.dbcore;\n    db.tables.forEach(function (table) {\n        var tableName = table.name;\n        if (db.core.schema.tables.some(function (tbl) { return tbl.name === tableName; })) {\n            table.core = db.core.table(tableName);\n            if (db[tableName] instanceof db.Table) {\n                db[tableName].core = table.core;\n            }\n        }\n    });\n}\n\nfunction setApiOnPlace(db, objs, tableNames, dbschema) {\n    tableNames.forEach(function (tableName) {\n        var schema = dbschema[tableName];\n        objs.forEach(function (obj) {\n            var propDesc = getPropertyDescriptor(obj, tableName);\n            if (!propDesc || (\"value\" in propDesc && propDesc.value === undefined)) {\n                if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n                    setProp(obj, tableName, {\n                        get: function () { return this.table(tableName); },\n                        set: function (value) {\n                            defineProperty(this, tableName, { value: value, writable: true, configurable: true, enumerable: true });\n                        }\n                    });\n                }\n                else {\n                    obj[tableName] = new db.Table(tableName, schema);\n                }\n            }\n        });\n    });\n}\nfunction removeTablesApi(db, objs) {\n    objs.forEach(function (obj) {\n        for (var key in obj) {\n            if (obj[key] instanceof db.Table)\n                delete obj[key];\n        }\n    });\n}\nfunction lowerVersionFirst(a, b) {\n    return a._cfg.version - b._cfg.version;\n}\nfunction runUpgraders(db, oldVersion, idbUpgradeTrans, reject) {\n    var globalSchema = db._dbSchema;\n    if (idbUpgradeTrans.objectStoreNames.contains('$meta') && !globalSchema.$meta) {\n        globalSchema.$meta = createTableSchema(\"$meta\", parseIndexSyntax(\"\")[0], []);\n        db._storeNames.push('$meta');\n    }\n    var trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n    trans.create(idbUpgradeTrans);\n    trans._completion.catch(reject);\n    var rejectTransaction = trans._reject.bind(trans);\n    var transless = PSD.transless || PSD;\n    newScope(function () {\n        PSD.trans = trans;\n        PSD.transless = transless;\n        if (oldVersion === 0) {\n            keys(globalSchema).forEach(function (tableName) {\n                createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n            });\n            generateMiddlewareStacks(db, idbUpgradeTrans);\n            DexiePromise.follow(function () { return db.on.populate.fire(trans); }).catch(rejectTransaction);\n        }\n        else {\n            generateMiddlewareStacks(db, idbUpgradeTrans);\n            return getExistingVersion(db, trans, oldVersion)\n                .then(function (oldVersion) { return updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans); })\n                .catch(rejectTransaction);\n        }\n    });\n}\nfunction patchCurrentVersion(db, idbUpgradeTrans) {\n    createMissingTables(db._dbSchema, idbUpgradeTrans);\n    if (idbUpgradeTrans.db.version % 10 === 0 && !idbUpgradeTrans.objectStoreNames.contains('$meta')) {\n        idbUpgradeTrans.db.createObjectStore('$meta').add(Math.ceil((idbUpgradeTrans.db.version / 10) - 1), 'version');\n    }\n    var globalSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n    adjustToExistingIndexNames(db, db._dbSchema, idbUpgradeTrans);\n    var diff = getSchemaDiff(globalSchema, db._dbSchema);\n    var _loop_1 = function (tableChange) {\n        if (tableChange.change.length || tableChange.recreate) {\n            console.warn(\"Unable to patch indexes of table \".concat(tableChange.name, \" because it has changes on the type of index or primary key.\"));\n            return { value: void 0 };\n        }\n        var store = idbUpgradeTrans.objectStore(tableChange.name);\n        tableChange.add.forEach(function (idx) {\n            if (debug)\n                console.debug(\"Dexie upgrade patch: Creating missing index \".concat(tableChange.name, \".\").concat(idx.src));\n            addIndex(store, idx);\n        });\n    };\n    for (var _i = 0, _a = diff.change; _i < _a.length; _i++) {\n        var tableChange = _a[_i];\n        var state_1 = _loop_1(tableChange);\n        if (typeof state_1 === \"object\")\n            return state_1.value;\n    }\n}\nfunction getExistingVersion(db, trans, oldVersion) {\n    if (trans.storeNames.includes('$meta')) {\n        return trans.table('$meta').get('version').then(function (metaVersion) {\n            return metaVersion != null ? metaVersion : oldVersion;\n        });\n    }\n    else {\n        return DexiePromise.resolve(oldVersion);\n    }\n}\nfunction updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans) {\n    var queue = [];\n    var versions = db._versions;\n    var globalSchema = db._dbSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n    var versToRun = versions.filter(function (v) { return v._cfg.version >= oldVersion; });\n    if (versToRun.length === 0) {\n        return DexiePromise.resolve();\n    }\n    versToRun.forEach(function (version) {\n        queue.push(function () {\n            var oldSchema = globalSchema;\n            var newSchema = version._cfg.dbschema;\n            adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n            adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n            globalSchema = db._dbSchema = newSchema;\n            var diff = getSchemaDiff(oldSchema, newSchema);\n            diff.add.forEach(function (tuple) {\n                createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n            });\n            diff.change.forEach(function (change) {\n                if (change.recreate) {\n                    throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                }\n                else {\n                    var store_1 = idbUpgradeTrans.objectStore(change.name);\n                    change.add.forEach(function (idx) { return addIndex(store_1, idx); });\n                    change.change.forEach(function (idx) {\n                        store_1.deleteIndex(idx.name);\n                        addIndex(store_1, idx);\n                    });\n                    change.del.forEach(function (idxName) { return store_1.deleteIndex(idxName); });\n                }\n            });\n            var contentUpgrade = version._cfg.contentUpgrade;\n            if (contentUpgrade && version._cfg.version > oldVersion) {\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                trans._memoizedTables = {};\n                var upgradeSchema_1 = shallowClone(newSchema);\n                diff.del.forEach(function (table) {\n                    upgradeSchema_1[table] = oldSchema[table];\n                });\n                removeTablesApi(db, [db.Transaction.prototype]);\n                setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema_1), upgradeSchema_1);\n                trans.schema = upgradeSchema_1;\n                var contentUpgradeIsAsync_1 = isAsyncFunction(contentUpgrade);\n                if (contentUpgradeIsAsync_1) {\n                    incrementExpectedAwaits();\n                }\n                var returnValue_1;\n                var promiseFollowed = DexiePromise.follow(function () {\n                    returnValue_1 = contentUpgrade(trans);\n                    if (returnValue_1) {\n                        if (contentUpgradeIsAsync_1) {\n                            var decrementor = decrementExpectedAwaits.bind(null, null);\n                            returnValue_1.then(decrementor, decrementor);\n                        }\n                    }\n                });\n                return (returnValue_1 && typeof returnValue_1.then === 'function' ?\n                    DexiePromise.resolve(returnValue_1) : promiseFollowed.then(function () { return returnValue_1; }));\n            }\n        });\n        queue.push(function (idbtrans) {\n            var newSchema = version._cfg.dbschema;\n            deleteRemovedTables(newSchema, idbtrans);\n            removeTablesApi(db, [db.Transaction.prototype]);\n            setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n            trans.schema = db._dbSchema;\n        });\n        queue.push(function (idbtrans) {\n            if (db.idbdb.objectStoreNames.contains('$meta')) {\n                if (Math.ceil(db.idbdb.version / 10) === version._cfg.version) {\n                    db.idbdb.deleteObjectStore('$meta');\n                    delete db._dbSchema.$meta;\n                    db._storeNames = db._storeNames.filter(function (name) { return name !== '$meta'; });\n                }\n                else {\n                    idbtrans.objectStore('$meta').put(version._cfg.version, 'version');\n                }\n            }\n        });\n    });\n    function runQueue() {\n        return queue.length ? DexiePromise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n            DexiePromise.resolve();\n    }\n    return runQueue().then(function () {\n        createMissingTables(globalSchema, idbUpgradeTrans);\n    });\n}\nfunction getSchemaDiff(oldSchema, newSchema) {\n    var diff = {\n        del: [],\n        add: [],\n        change: []\n    };\n    var table;\n    for (table in oldSchema) {\n        if (!newSchema[table])\n            diff.del.push(table);\n    }\n    for (table in newSchema) {\n        var oldDef = oldSchema[table], newDef = newSchema[table];\n        if (!oldDef) {\n            diff.add.push([table, newDef]);\n        }\n        else {\n            var change = {\n                name: table,\n                def: newDef,\n                recreate: false,\n                del: [],\n                add: [],\n                change: []\n            };\n            if ((\n            '' + (oldDef.primKey.keyPath || '')) !== ('' + (newDef.primKey.keyPath || '')) ||\n                (oldDef.primKey.auto !== newDef.primKey.auto)) {\n                change.recreate = true;\n                diff.change.push(change);\n            }\n            else {\n                var oldIndexes = oldDef.idxByName;\n                var newIndexes = newDef.idxByName;\n                var idxName = void 0;\n                for (idxName in oldIndexes) {\n                    if (!newIndexes[idxName])\n                        change.del.push(idxName);\n                }\n                for (idxName in newIndexes) {\n                    var oldIdx = oldIndexes[idxName], newIdx = newIndexes[idxName];\n                    if (!oldIdx)\n                        change.add.push(newIdx);\n                    else if (oldIdx.src !== newIdx.src)\n                        change.change.push(newIdx);\n                }\n                if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                    diff.change.push(change);\n                }\n            }\n        }\n    }\n    return diff;\n}\nfunction createTable(idbtrans, tableName, primKey, indexes) {\n    var store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ?\n        { keyPath: primKey.keyPath, autoIncrement: primKey.auto } :\n        { autoIncrement: primKey.auto });\n    indexes.forEach(function (idx) { return addIndex(store, idx); });\n    return store;\n}\nfunction createMissingTables(newSchema, idbtrans) {\n    keys(newSchema).forEach(function (tableName) {\n        if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n            if (debug)\n                console.debug('Dexie: Creating missing table', tableName);\n            createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n        }\n    });\n}\nfunction deleteRemovedTables(newSchema, idbtrans) {\n    [].slice.call(idbtrans.db.objectStoreNames).forEach(function (storeName) {\n        return newSchema[storeName] == null && idbtrans.db.deleteObjectStore(storeName);\n    });\n}\nfunction addIndex(store, idx) {\n    store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n}\nfunction buildGlobalSchema(db, idbdb, tmpTrans) {\n    var globalSchema = {};\n    var dbStoreNames = slice(idbdb.objectStoreNames, 0);\n    dbStoreNames.forEach(function (storeName) {\n        var store = tmpTrans.objectStore(storeName);\n        var keyPath = store.keyPath;\n        var primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", true, false, !!store.autoIncrement, keyPath && typeof keyPath !== \"string\", true);\n        var indexes = [];\n        for (var j = 0; j < store.indexNames.length; ++j) {\n            var idbindex = store.index(store.indexNames[j]);\n            keyPath = idbindex.keyPath;\n            var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== \"string\", false);\n            indexes.push(index);\n        }\n        globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n    });\n    return globalSchema;\n}\nfunction readGlobalSchema(db, idbdb, tmpTrans) {\n    db.verno = idbdb.version / 10;\n    var globalSchema = db._dbSchema = buildGlobalSchema(db, idbdb, tmpTrans);\n    db._storeNames = slice(idbdb.objectStoreNames, 0);\n    setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n}\nfunction verifyInstalledSchema(db, tmpTrans) {\n    var installedSchema = buildGlobalSchema(db, db.idbdb, tmpTrans);\n    var diff = getSchemaDiff(installedSchema, db._dbSchema);\n    return !(diff.add.length || diff.change.some(function (ch) { return ch.add.length || ch.change.length; }));\n}\nfunction adjustToExistingIndexNames(db, schema, idbtrans) {\n    var storeNames = idbtrans.db.objectStoreNames;\n    for (var i = 0; i < storeNames.length; ++i) {\n        var storeName = storeNames[i];\n        var store = idbtrans.objectStore(storeName);\n        db._hasGetAll = 'getAll' in store;\n        for (var j = 0; j < store.indexNames.length; ++j) {\n            var indexName = store.indexNames[j];\n            var keyPath = store.index(indexName).keyPath;\n            var dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n            if (schema[storeName]) {\n                var indexSpec = schema[storeName].idxByName[dexieName];\n                if (indexSpec) {\n                    indexSpec.name = indexName;\n                    delete schema[storeName].idxByName[dexieName];\n                    schema[storeName].idxByName[indexName] = indexSpec;\n                }\n            }\n        }\n    }\n    if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n        !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n        _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n        [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n        db._hasGetAll = false;\n    }\n}\nfunction parseIndexSyntax(primKeyAndIndexes) {\n    return primKeyAndIndexes.split(',').map(function (index, indexNum) {\n        index = index.trim();\n        var name = index.replace(/([&*]|\\+\\+)/g, \"\");\n        var keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n        return createIndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), indexNum === 0);\n    });\n}\n\nvar Version =  (function () {\n    function Version() {\n    }\n    Version.prototype._parseStoresSpec = function (stores, outSchema) {\n        keys(stores).forEach(function (tableName) {\n            if (stores[tableName] !== null) {\n                var indexes = parseIndexSyntax(stores[tableName]);\n                var primKey = indexes.shift();\n                primKey.unique = true;\n                if (primKey.multi)\n                    throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n                indexes.forEach(function (idx) {\n                    if (idx.auto)\n                        throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n                    if (!idx.keyPath)\n                        throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n                });\n                outSchema[tableName] = createTableSchema(tableName, primKey, indexes);\n            }\n        });\n    };\n    Version.prototype.stores = function (stores) {\n        var db = this.db;\n        this._cfg.storesSource = this._cfg.storesSource ?\n            extend(this._cfg.storesSource, stores) :\n            stores;\n        var versions = db._versions;\n        var storesSpec = {};\n        var dbschema = {};\n        versions.forEach(function (version) {\n            extend(storesSpec, version._cfg.storesSource);\n            dbschema = (version._cfg.dbschema = {});\n            version._parseStoresSpec(storesSpec, dbschema);\n        });\n        db._dbSchema = dbschema;\n        removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n        setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n        db._storeNames = keys(dbschema);\n        return this;\n    };\n    Version.prototype.upgrade = function (upgradeFunction) {\n        this._cfg.contentUpgrade = promisableChain(this._cfg.contentUpgrade || nop, upgradeFunction);\n        return this;\n    };\n    return Version;\n}());\n\nfunction createVersionConstructor(db) {\n    return makeClassConstructor(Version.prototype, function Version(versionNumber) {\n        this.db = db;\n        this._cfg = {\n            version: versionNumber,\n            storesSource: null,\n            dbschema: {},\n            tables: {},\n            contentUpgrade: null\n        };\n    });\n}\n\nfunction getDbNamesTable(indexedDB, IDBKeyRange) {\n    var dbNamesDB = indexedDB[\"_dbNamesDB\"];\n    if (!dbNamesDB) {\n        dbNamesDB = indexedDB[\"_dbNamesDB\"] = new Dexie$1(DBNAMES_DB, {\n            addons: [],\n            indexedDB: indexedDB,\n            IDBKeyRange: IDBKeyRange,\n        });\n        dbNamesDB.version(1).stores({ dbnames: \"name\" });\n    }\n    return dbNamesDB.table(\"dbnames\");\n}\nfunction hasDatabasesNative(indexedDB) {\n    return indexedDB && typeof indexedDB.databases === \"function\";\n}\nfunction getDatabaseNames(_a) {\n    var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n    return hasDatabasesNative(indexedDB)\n        ? Promise.resolve(indexedDB.databases()).then(function (infos) {\n            return infos\n                .map(function (info) { return info.name; })\n                .filter(function (name) { return name !== DBNAMES_DB; });\n        })\n        : getDbNamesTable(indexedDB, IDBKeyRange).toCollection().primaryKeys();\n}\nfunction _onDatabaseCreated(_a, name) {\n    var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n    !hasDatabasesNative(indexedDB) &&\n        name !== DBNAMES_DB &&\n        getDbNamesTable(indexedDB, IDBKeyRange).put({ name: name }).catch(nop);\n}\nfunction _onDatabaseDeleted(_a, name) {\n    var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n    !hasDatabasesNative(indexedDB) &&\n        name !== DBNAMES_DB &&\n        getDbNamesTable(indexedDB, IDBKeyRange).delete(name).catch(nop);\n}\n\nfunction vip(fn) {\n    return newScope(function () {\n        PSD.letThrough = true;\n        return fn();\n    });\n}\n\nfunction idbReady() {\n    var isSafari = !navigator.userAgentData &&\n        /Safari\\//.test(navigator.userAgent) &&\n        !/Chrom(e|ium)\\//.test(navigator.userAgent);\n    if (!isSafari || !indexedDB.databases)\n        return Promise.resolve();\n    var intervalId;\n    return new Promise(function (resolve) {\n        var tryIdb = function () { return indexedDB.databases().finally(resolve); };\n        intervalId = setInterval(tryIdb, 100);\n        tryIdb();\n    }).finally(function () { return clearInterval(intervalId); });\n}\n\nvar _a;\nfunction isEmptyRange(node) {\n    return !(\"from\" in node);\n}\nvar RangeSet = function (fromOrTree, to) {\n    if (this) {\n        extend(this, arguments.length ? { d: 1, from: fromOrTree, to: arguments.length > 1 ? to : fromOrTree } : { d: 0 });\n    }\n    else {\n        var rv = new RangeSet();\n        if (fromOrTree && (\"d\" in fromOrTree)) {\n            extend(rv, fromOrTree);\n        }\n        return rv;\n    }\n};\nprops(RangeSet.prototype, (_a = {\n        add: function (rangeSet) {\n            mergeRanges(this, rangeSet);\n            return this;\n        },\n        addKey: function (key) {\n            addRange(this, key, key);\n            return this;\n        },\n        addKeys: function (keys) {\n            var _this = this;\n            keys.forEach(function (key) { return addRange(_this, key, key); });\n            return this;\n        }\n    },\n    _a[iteratorSymbol] = function () {\n        return getRangeSetIterator(this);\n    },\n    _a));\nfunction addRange(target, from, to) {\n    var diff = cmp(from, to);\n    if (isNaN(diff))\n        return;\n    if (diff > 0)\n        throw RangeError();\n    if (isEmptyRange(target))\n        return extend(target, { from: from, to: to, d: 1 });\n    var left = target.l;\n    var right = target.r;\n    if (cmp(to, target.from) < 0) {\n        left\n            ? addRange(left, from, to)\n            : (target.l = { from: from, to: to, d: 1, l: null, r: null });\n        return rebalance(target);\n    }\n    if (cmp(from, target.to) > 0) {\n        right\n            ? addRange(right, from, to)\n            : (target.r = { from: from, to: to, d: 1, l: null, r: null });\n        return rebalance(target);\n    }\n    if (cmp(from, target.from) < 0) {\n        target.from = from;\n        target.l = null;\n        target.d = right ? right.d + 1 : 1;\n    }\n    if (cmp(to, target.to) > 0) {\n        target.to = to;\n        target.r = null;\n        target.d = target.l ? target.l.d + 1 : 1;\n    }\n    var rightWasCutOff = !target.r;\n    if (left && !target.l) {\n        mergeRanges(target, left);\n    }\n    if (right && rightWasCutOff) {\n        mergeRanges(target, right);\n    }\n}\nfunction mergeRanges(target, newSet) {\n    function _addRangeSet(target, _a) {\n        var from = _a.from, to = _a.to, l = _a.l, r = _a.r;\n        addRange(target, from, to);\n        if (l)\n            _addRangeSet(target, l);\n        if (r)\n            _addRangeSet(target, r);\n    }\n    if (!isEmptyRange(newSet))\n        _addRangeSet(target, newSet);\n}\nfunction rangesOverlap(rangeSet1, rangeSet2) {\n    var i1 = getRangeSetIterator(rangeSet2);\n    var nextResult1 = i1.next();\n    if (nextResult1.done)\n        return false;\n    var a = nextResult1.value;\n    var i2 = getRangeSetIterator(rangeSet1);\n    var nextResult2 = i2.next(a.from);\n    var b = nextResult2.value;\n    while (!nextResult1.done && !nextResult2.done) {\n        if (cmp(b.from, a.to) <= 0 && cmp(b.to, a.from) >= 0)\n            return true;\n        cmp(a.from, b.from) < 0\n            ? (a = (nextResult1 = i1.next(b.from)).value)\n            : (b = (nextResult2 = i2.next(a.from)).value);\n    }\n    return false;\n}\nfunction getRangeSetIterator(node) {\n    var state = isEmptyRange(node) ? null : { s: 0, n: node };\n    return {\n        next: function (key) {\n            var keyProvided = arguments.length > 0;\n            while (state) {\n                switch (state.s) {\n                    case 0:\n                        state.s = 1;\n                        if (keyProvided) {\n                            while (state.n.l && cmp(key, state.n.from) < 0)\n                                state = { up: state, n: state.n.l, s: 1 };\n                        }\n                        else {\n                            while (state.n.l)\n                                state = { up: state, n: state.n.l, s: 1 };\n                        }\n                    case 1:\n                        state.s = 2;\n                        if (!keyProvided || cmp(key, state.n.to) <= 0)\n                            return { value: state.n, done: false };\n                    case 2:\n                        if (state.n.r) {\n                            state.s = 3;\n                            state = { up: state, n: state.n.r, s: 0 };\n                            continue;\n                        }\n                    case 3:\n                        state = state.up;\n                }\n            }\n            return { done: true };\n        },\n    };\n}\nfunction rebalance(target) {\n    var _a, _b;\n    var diff = (((_a = target.r) === null || _a === void 0 ? void 0 : _a.d) || 0) - (((_b = target.l) === null || _b === void 0 ? void 0 : _b.d) || 0);\n    var r = diff > 1 ? \"r\" : diff < -1 ? \"l\" : \"\";\n    if (r) {\n        var l = r === \"r\" ? \"l\" : \"r\";\n        var rootClone = __assign({}, target);\n        var oldRootRight = target[r];\n        target.from = oldRootRight.from;\n        target.to = oldRootRight.to;\n        target[r] = oldRootRight[r];\n        rootClone[r] = oldRootRight[l];\n        target[l] = rootClone;\n        rootClone.d = computeDepth(rootClone);\n    }\n    target.d = computeDepth(target);\n}\nfunction computeDepth(_a) {\n    var r = _a.r, l = _a.l;\n    return (r ? (l ? Math.max(r.d, l.d) : r.d) : l ? l.d : 0) + 1;\n}\n\nfunction extendObservabilitySet(target, newSet) {\n    keys(newSet).forEach(function (part) {\n        if (target[part])\n            mergeRanges(target[part], newSet[part]);\n        else\n            target[part] = cloneSimpleObjectTree(newSet[part]);\n    });\n    return target;\n}\n\nfunction obsSetsOverlap(os1, os2) {\n    return os1.all || os2.all || Object.keys(os1).some(function (key) { return os2[key] && rangesOverlap(os2[key], os1[key]); });\n}\n\nvar cache = {};\n\nvar unsignaledParts = {};\nvar isTaskEnqueued = false;\nfunction signalSubscribersLazily(part, optimistic) {\n    extendObservabilitySet(unsignaledParts, part);\n    if (!isTaskEnqueued) {\n        isTaskEnqueued = true;\n        setTimeout(function () {\n            isTaskEnqueued = false;\n            var parts = unsignaledParts;\n            unsignaledParts = {};\n            signalSubscribersNow(parts, false);\n        }, 0);\n    }\n}\nfunction signalSubscribersNow(updatedParts, deleteAffectedCacheEntries) {\n    if (deleteAffectedCacheEntries === void 0) { deleteAffectedCacheEntries = false; }\n    var queriesToSignal = new Set();\n    if (updatedParts.all) {\n        for (var _i = 0, _a = Object.values(cache); _i < _a.length; _i++) {\n            var tblCache = _a[_i];\n            collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n        }\n    }\n    else {\n        for (var key in updatedParts) {\n            var parts = /^idb\\:\\/\\/(.*)\\/(.*)\\//.exec(key);\n            if (parts) {\n                var dbName = parts[1], tableName = parts[2];\n                var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                if (tblCache)\n                    collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n            }\n        }\n    }\n    queriesToSignal.forEach(function (requery) { return requery(); });\n}\nfunction collectTableSubscribers(tblCache, updatedParts, outQueriesToSignal, deleteAffectedCacheEntries) {\n    var updatedEntryLists = [];\n    for (var _i = 0, _a = Object.entries(tblCache.queries.query); _i < _a.length; _i++) {\n        var _b = _a[_i], indexName = _b[0], entries = _b[1];\n        var filteredEntries = [];\n        for (var _c = 0, entries_1 = entries; _c < entries_1.length; _c++) {\n            var entry = entries_1[_c];\n            if (obsSetsOverlap(updatedParts, entry.obsSet)) {\n                entry.subscribers.forEach(function (requery) { return outQueriesToSignal.add(requery); });\n            }\n            else if (deleteAffectedCacheEntries) {\n                filteredEntries.push(entry);\n            }\n        }\n        if (deleteAffectedCacheEntries)\n            updatedEntryLists.push([indexName, filteredEntries]);\n    }\n    if (deleteAffectedCacheEntries) {\n        for (var _d = 0, updatedEntryLists_1 = updatedEntryLists; _d < updatedEntryLists_1.length; _d++) {\n            var _e = updatedEntryLists_1[_d], indexName = _e[0], filteredEntries = _e[1];\n            tblCache.queries.query[indexName] = filteredEntries;\n        }\n    }\n}\n\nfunction dexieOpen(db) {\n    var state = db._state;\n    var indexedDB = db._deps.indexedDB;\n    if (state.isBeingOpened || db.idbdb)\n        return state.dbReadyPromise.then(function () { return state.dbOpenError ?\n            rejection(state.dbOpenError) :\n            db; });\n    state.isBeingOpened = true;\n    state.dbOpenError = null;\n    state.openComplete = false;\n    var openCanceller = state.openCanceller;\n    var nativeVerToOpen = Math.round(db.verno * 10);\n    var schemaPatchMode = false;\n    function throwIfCancelled() {\n        if (state.openCanceller !== openCanceller)\n            throw new exceptions.DatabaseClosed('db.open() was cancelled');\n    }\n    var resolveDbReady = state.dbReadyResolve,\n    upgradeTransaction = null, wasCreated = false;\n    var tryOpenDB = function () { return new DexiePromise(function (resolve, reject) {\n        throwIfCancelled();\n        if (!indexedDB)\n            throw new exceptions.MissingAPI();\n        var dbName = db.name;\n        var req = state.autoSchema || !nativeVerToOpen ?\n            indexedDB.open(dbName) :\n            indexedDB.open(dbName, nativeVerToOpen);\n        if (!req)\n            throw new exceptions.MissingAPI();\n        req.onerror = eventRejectHandler(reject);\n        req.onblocked = wrap(db._fireOnBlocked);\n        req.onupgradeneeded = wrap(function (e) {\n            upgradeTransaction = req.transaction;\n            if (state.autoSchema && !db._options.allowEmptyDB) {\n                req.onerror = preventDefault;\n                upgradeTransaction.abort();\n                req.result.close();\n                var delreq = indexedDB.deleteDatabase(dbName);\n                delreq.onsuccess = delreq.onerror = wrap(function () {\n                    reject(new exceptions.NoSuchDatabase(\"Database \".concat(dbName, \" doesnt exist\")));\n                });\n            }\n            else {\n                upgradeTransaction.onerror = eventRejectHandler(reject);\n                var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;\n                wasCreated = oldVer < 1;\n                db.idbdb = req.result;\n                if (schemaPatchMode) {\n                    patchCurrentVersion(db, upgradeTransaction);\n                }\n                runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n            }\n        }, reject);\n        req.onsuccess = wrap(function () {\n            upgradeTransaction = null;\n            var idbdb = db.idbdb = req.result;\n            var objectStoreNames = slice(idbdb.objectStoreNames);\n            if (objectStoreNames.length > 0)\n                try {\n                    var tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n                    if (state.autoSchema)\n                        readGlobalSchema(db, idbdb, tmpTrans);\n                    else {\n                        adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n                        if (!verifyInstalledSchema(db, tmpTrans) && !schemaPatchMode) {\n                            console.warn(\"Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this.\");\n                            idbdb.close();\n                            nativeVerToOpen = idbdb.version + 1;\n                            schemaPatchMode = true;\n                            return resolve(tryOpenDB());\n                        }\n                    }\n                    generateMiddlewareStacks(db, tmpTrans);\n                }\n                catch (e) {\n                }\n            connections.push(db);\n            idbdb.onversionchange = wrap(function (ev) {\n                state.vcFired = true;\n                db.on(\"versionchange\").fire(ev);\n            });\n            idbdb.onclose = wrap(function (ev) {\n                db.on(\"close\").fire(ev);\n            });\n            if (wasCreated)\n                _onDatabaseCreated(db._deps, dbName);\n            resolve();\n        }, reject);\n    }).catch(function (err) {\n        switch (err === null || err === void 0 ? void 0 : err.name) {\n            case \"UnknownError\":\n                if (state.PR1398_maxLoop > 0) {\n                    state.PR1398_maxLoop--;\n                    console.warn('Dexie: Workaround for Chrome UnknownError on open()');\n                    return tryOpenDB();\n                }\n                break;\n            case \"VersionError\":\n                if (nativeVerToOpen > 0) {\n                    nativeVerToOpen = 0;\n                    return tryOpenDB();\n                }\n                break;\n        }\n        return DexiePromise.reject(err);\n    }); };\n    return DexiePromise.race([\n        openCanceller,\n        (typeof navigator === 'undefined' ? DexiePromise.resolve() : idbReady()).then(tryOpenDB)\n    ]).then(function () {\n        throwIfCancelled();\n        state.onReadyBeingFired = [];\n        return DexiePromise.resolve(vip(function () { return db.on.ready.fire(db.vip); })).then(function fireRemainders() {\n            if (state.onReadyBeingFired.length > 0) {\n                var remainders_1 = state.onReadyBeingFired.reduce(promisableChain, nop);\n                state.onReadyBeingFired = [];\n                return DexiePromise.resolve(vip(function () { return remainders_1(db.vip); })).then(fireRemainders);\n            }\n        });\n    }).finally(function () {\n        if (state.openCanceller === openCanceller) {\n            state.onReadyBeingFired = null;\n            state.isBeingOpened = false;\n        }\n    }).catch(function (err) {\n        state.dbOpenError = err;\n        try {\n            upgradeTransaction && upgradeTransaction.abort();\n        }\n        catch (_a) { }\n        if (openCanceller === state.openCanceller) {\n            db._close();\n        }\n        return rejection(err);\n    }).finally(function () {\n        state.openComplete = true;\n        resolveDbReady();\n    }).then(function () {\n        if (wasCreated) {\n            var everything_1 = {};\n            db.tables.forEach(function (table) {\n                table.schema.indexes.forEach(function (idx) {\n                    if (idx.name)\n                        everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\").concat(idx.name)] = new RangeSet(-Infinity, [[[]]]);\n                });\n                everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\")] = everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/:dels\")] = new RangeSet(-Infinity, [[[]]]);\n            });\n            globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME).fire(everything_1);\n            signalSubscribersNow(everything_1, true);\n        }\n        return db;\n    });\n}\n\nfunction awaitIterator(iterator) {\n    var callNext = function (result) { return iterator.next(result); }, doThrow = function (error) { return iterator.throw(error); }, onSuccess = step(callNext), onError = step(doThrow);\n    function step(getNext) {\n        return function (val) {\n            var next = getNext(val), value = next.value;\n            return next.done ? value :\n                (!value || typeof value.then !== 'function' ?\n                    isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                    value.then(onSuccess, onError));\n        };\n    }\n    return step(callNext)();\n}\n\nfunction extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n    var i = arguments.length;\n    if (i < 2)\n        throw new exceptions.InvalidArgument(\"Too few arguments\");\n    var args = new Array(i - 1);\n    while (--i)\n        args[i - 1] = arguments[i];\n    scopeFunc = args.pop();\n    var tables = flatten(args);\n    return [mode, tables, scopeFunc];\n}\nfunction enterTransactionScope(db, mode, storeNames, parentTransaction, scopeFunc) {\n    return DexiePromise.resolve().then(function () {\n        var transless = PSD.transless || PSD;\n        var trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n        trans.explicit = true;\n        var zoneProps = {\n            trans: trans,\n            transless: transless\n        };\n        if (parentTransaction) {\n            trans.idbtrans = parentTransaction.idbtrans;\n        }\n        else {\n            try {\n                trans.create();\n                trans.idbtrans._explicit = true;\n                db._state.PR1398_maxLoop = 3;\n            }\n            catch (ex) {\n                if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                    console.warn('Dexie: Need to reopen db');\n                    db.close({ disableAutoOpen: false });\n                    return db.open().then(function () { return enterTransactionScope(db, mode, storeNames, null, scopeFunc); });\n                }\n                return rejection(ex);\n            }\n        }\n        var scopeFuncIsAsync = isAsyncFunction(scopeFunc);\n        if (scopeFuncIsAsync) {\n            incrementExpectedAwaits();\n        }\n        var returnValue;\n        var promiseFollowed = DexiePromise.follow(function () {\n            returnValue = scopeFunc.call(trans, trans);\n            if (returnValue) {\n                if (scopeFuncIsAsync) {\n                    var decrementor = decrementExpectedAwaits.bind(null, null);\n                    returnValue.then(decrementor, decrementor);\n                }\n                else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                    returnValue = awaitIterator(returnValue);\n                }\n            }\n        }, zoneProps);\n        return (returnValue && typeof returnValue.then === 'function' ?\n            DexiePromise.resolve(returnValue).then(function (x) { return trans.active ?\n                x\n                : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\")); })\n            : promiseFollowed.then(function () { return returnValue; })).then(function (x) {\n            if (parentTransaction)\n                trans._resolve();\n            return trans._completion.then(function () { return x; });\n        }).catch(function (e) {\n            trans._reject(e);\n            return rejection(e);\n        });\n    });\n}\n\nfunction pad(a, value, count) {\n    var result = isArray(a) ? a.slice() : [a];\n    for (var i = 0; i < count; ++i)\n        result.push(value);\n    return result;\n}\nfunction createVirtualIndexMiddleware(down) {\n    return __assign(__assign({}, down), { table: function (tableName) {\n            var table = down.table(tableName);\n            var schema = table.schema;\n            var indexLookup = {};\n            var allVirtualIndexes = [];\n            function addVirtualIndexes(keyPath, keyTail, lowLevelIndex) {\n                var keyPathAlias = getKeyPathAlias(keyPath);\n                var indexList = (indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || []);\n                var keyLength = keyPath == null ? 0 : typeof keyPath === 'string' ? 1 : keyPath.length;\n                var isVirtual = keyTail > 0;\n                var virtualIndex = __assign(__assign({}, lowLevelIndex), { name: isVirtual\n                        ? \"\".concat(keyPathAlias, \"(virtual-from:\").concat(lowLevelIndex.name, \")\")\n                        : lowLevelIndex.name, lowLevelIndex: lowLevelIndex, isVirtual: isVirtual, keyTail: keyTail, keyLength: keyLength, extractKey: getKeyExtractor(keyPath), unique: !isVirtual && lowLevelIndex.unique });\n                indexList.push(virtualIndex);\n                if (!virtualIndex.isPrimaryKey) {\n                    allVirtualIndexes.push(virtualIndex);\n                }\n                if (keyLength > 1) {\n                    var virtualKeyPath = keyLength === 2 ?\n                        keyPath[0] :\n                        keyPath.slice(0, keyLength - 1);\n                    addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n                }\n                indexList.sort(function (a, b) { return a.keyTail - b.keyTail; });\n                return virtualIndex;\n            }\n            var primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n            indexLookup[\":id\"] = [primaryKey];\n            for (var _i = 0, _a = schema.indexes; _i < _a.length; _i++) {\n                var index = _a[_i];\n                addVirtualIndexes(index.keyPath, 0, index);\n            }\n            function findBestIndex(keyPath) {\n                var result = indexLookup[getKeyPathAlias(keyPath)];\n                return result && result[0];\n            }\n            function translateRange(range, keyTail) {\n                return {\n                    type: range.type === 1  ?\n                        2  :\n                        range.type,\n                    lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n                    lowerOpen: true,\n                    upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n                    upperOpen: true\n                };\n            }\n            function translateRequest(req) {\n                var index = req.query.index;\n                return index.isVirtual ? __assign(__assign({}, req), { query: {\n                        index: index.lowLevelIndex,\n                        range: translateRange(req.query.range, index.keyTail)\n                    } }) : req;\n            }\n            var result = __assign(__assign({}, table), { schema: __assign(__assign({}, schema), { primaryKey: primaryKey, indexes: allVirtualIndexes, getIndexByKeyPath: findBestIndex }), count: function (req) {\n                    return table.count(translateRequest(req));\n                }, query: function (req) {\n                    return table.query(translateRequest(req));\n                }, openCursor: function (req) {\n                    var _a = req.query.index, keyTail = _a.keyTail, isVirtual = _a.isVirtual, keyLength = _a.keyLength;\n                    if (!isVirtual)\n                        return table.openCursor(req);\n                    function createVirtualCursor(cursor) {\n                        function _continue(key) {\n                            key != null ?\n                                cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) :\n                                req.unique ?\n                                    cursor.continue(cursor.key.slice(0, keyLength)\n                                        .concat(req.reverse\n                                        ? down.MIN_KEY\n                                        : down.MAX_KEY, keyTail)) :\n                                    cursor.continue();\n                        }\n                        var virtualCursor = Object.create(cursor, {\n                            continue: { value: _continue },\n                            continuePrimaryKey: {\n                                value: function (key, primaryKey) {\n                                    cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                                }\n                            },\n                            primaryKey: {\n                                get: function () {\n                                    return cursor.primaryKey;\n                                }\n                            },\n                            key: {\n                                get: function () {\n                                    var key = cursor.key;\n                                    return keyLength === 1 ?\n                                        key[0] :\n                                        key.slice(0, keyLength);\n                                }\n                            },\n                            value: {\n                                get: function () {\n                                    return cursor.value;\n                                }\n                            }\n                        });\n                        return virtualCursor;\n                    }\n                    return table.openCursor(translateRequest(req))\n                        .then(function (cursor) { return cursor && createVirtualCursor(cursor); });\n                } });\n            return result;\n        } });\n}\nvar virtualIndexMiddleware = {\n    stack: \"dbcore\",\n    name: \"VirtualIndexMiddleware\",\n    level: 1,\n    create: createVirtualIndexMiddleware\n};\n\nfunction getObjectDiff(a, b, rv, prfx) {\n    rv = rv || {};\n    prfx = prfx || '';\n    keys(a).forEach(function (prop) {\n        if (!hasOwn(b, prop)) {\n            rv[prfx + prop] = undefined;\n        }\n        else {\n            var ap = a[prop], bp = b[prop];\n            if (typeof ap === 'object' && typeof bp === 'object' && ap && bp) {\n                var apTypeName = toStringTag(ap);\n                var bpTypeName = toStringTag(bp);\n                if (apTypeName !== bpTypeName) {\n                    rv[prfx + prop] = b[prop];\n                }\n                else if (apTypeName === 'Object') {\n                    getObjectDiff(ap, bp, rv, prfx + prop + '.');\n                }\n                else if (ap !== bp) {\n                    rv[prfx + prop] = b[prop];\n                }\n            }\n            else if (ap !== bp)\n                rv[prfx + prop] = b[prop];\n        }\n    });\n    keys(b).forEach(function (prop) {\n        if (!hasOwn(a, prop)) {\n            rv[prfx + prop] = b[prop];\n        }\n    });\n    return rv;\n}\n\nfunction getEffectiveKeys(primaryKey, req) {\n    if (req.type === 'delete')\n        return req.keys;\n    return req.keys || req.values.map(primaryKey.extractKey);\n}\n\nvar hooksMiddleware = {\n    stack: \"dbcore\",\n    name: \"HooksMiddleware\",\n    level: 2,\n    create: function (downCore) { return (__assign(__assign({}, downCore), { table: function (tableName) {\n            var downTable = downCore.table(tableName);\n            var primaryKey = downTable.schema.primaryKey;\n            var tableMiddleware = __assign(__assign({}, downTable), { mutate: function (req) {\n                    var dxTrans = PSD.trans;\n                    var _a = dxTrans.table(tableName).hook, deleting = _a.deleting, creating = _a.creating, updating = _a.updating;\n                    switch (req.type) {\n                        case 'add':\n                            if (creating.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                        case 'put':\n                            if (creating.fire === nop && updating.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                        case 'delete':\n                            if (deleting.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                        case 'deleteRange':\n                            if (deleting.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return deleteRange(req); }, true);\n                    }\n                    return downTable.mutate(req);\n                    function addPutOrDelete(req) {\n                        var dxTrans = PSD.trans;\n                        var keys = req.keys || getEffectiveKeys(primaryKey, req);\n                        if (!keys)\n                            throw new Error(\"Keys missing\");\n                        req = req.type === 'add' || req.type === 'put' ? __assign(__assign({}, req), { keys: keys }) : __assign({}, req);\n                        if (req.type !== 'delete')\n                            req.values = __spreadArray([], req.values, true);\n                        if (req.keys)\n                            req.keys = __spreadArray([], req.keys, true);\n                        return getExistingValues(downTable, req, keys).then(function (existingValues) {\n                            var contexts = keys.map(function (key, i) {\n                                var existingValue = existingValues[i];\n                                var ctx = { onerror: null, onsuccess: null };\n                                if (req.type === 'delete') {\n                                    deleting.fire.call(ctx, key, existingValue, dxTrans);\n                                }\n                                else if (req.type === 'add' || existingValue === undefined) {\n                                    var generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                                    if (key == null && generatedPrimaryKey != null) {\n                                        key = generatedPrimaryKey;\n                                        req.keys[i] = key;\n                                        if (!primaryKey.outbound) {\n                                            setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                                        }\n                                    }\n                                }\n                                else {\n                                    var objectDiff = getObjectDiff(existingValue, req.values[i]);\n                                    var additionalChanges_1 = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                                    if (additionalChanges_1) {\n                                        var requestedValue_1 = req.values[i];\n                                        Object.keys(additionalChanges_1).forEach(function (keyPath) {\n                                            if (hasOwn(requestedValue_1, keyPath)) {\n                                                requestedValue_1[keyPath] = additionalChanges_1[keyPath];\n                                            }\n                                            else {\n                                                setByKeyPath(requestedValue_1, keyPath, additionalChanges_1[keyPath]);\n                                            }\n                                        });\n                                    }\n                                }\n                                return ctx;\n                            });\n                            return downTable.mutate(req).then(function (_a) {\n                                var failures = _a.failures, results = _a.results, numFailures = _a.numFailures, lastResult = _a.lastResult;\n                                for (var i = 0; i < keys.length; ++i) {\n                                    var primKey = results ? results[i] : keys[i];\n                                    var ctx = contexts[i];\n                                    if (primKey == null) {\n                                        ctx.onerror && ctx.onerror(failures[i]);\n                                    }\n                                    else {\n                                        ctx.onsuccess && ctx.onsuccess(req.type === 'put' && existingValues[i] ?\n                                            req.values[i] :\n                                            primKey\n                                        );\n                                    }\n                                }\n                                return { failures: failures, results: results, numFailures: numFailures, lastResult: lastResult };\n                            }).catch(function (error) {\n                                contexts.forEach(function (ctx) { return ctx.onerror && ctx.onerror(error); });\n                                return Promise.reject(error);\n                            });\n                        });\n                    }\n                    function deleteRange(req) {\n                        return deleteNextChunk(req.trans, req.range, 10000);\n                    }\n                    function deleteNextChunk(trans, range, limit) {\n                        return downTable.query({ trans: trans, values: false, query: { index: primaryKey, range: range }, limit: limit })\n                            .then(function (_a) {\n                            var result = _a.result;\n                            return addPutOrDelete({ type: 'delete', keys: result, trans: trans }).then(function (res) {\n                                if (res.numFailures > 0)\n                                    return Promise.reject(res.failures[0]);\n                                if (result.length < limit) {\n                                    return { failures: [], numFailures: 0, lastResult: undefined };\n                                }\n                                else {\n                                    return deleteNextChunk(trans, __assign(__assign({}, range), { lower: result[result.length - 1], lowerOpen: true }), limit);\n                                }\n                            });\n                        });\n                    }\n                } });\n            return tableMiddleware;\n        } })); }\n};\nfunction getExistingValues(table, req, effectiveKeys) {\n    return req.type === \"add\"\n        ? Promise.resolve([])\n        : table.getMany({ trans: req.trans, keys: effectiveKeys, cache: \"immutable\" });\n}\n\nfunction getFromTransactionCache(keys, cache, clone) {\n    try {\n        if (!cache)\n            return null;\n        if (cache.keys.length < keys.length)\n            return null;\n        var result = [];\n        for (var i = 0, j = 0; i < cache.keys.length && j < keys.length; ++i) {\n            if (cmp(cache.keys[i], keys[j]) !== 0)\n                continue;\n            result.push(clone ? deepClone(cache.values[i]) : cache.values[i]);\n            ++j;\n        }\n        return result.length === keys.length ? result : null;\n    }\n    catch (_a) {\n        return null;\n    }\n}\nvar cacheExistingValuesMiddleware = {\n    stack: \"dbcore\",\n    level: -1,\n    create: function (core) {\n        return {\n            table: function (tableName) {\n                var table = core.table(tableName);\n                return __assign(__assign({}, table), { getMany: function (req) {\n                        if (!req.cache) {\n                            return table.getMany(req);\n                        }\n                        var cachedResult = getFromTransactionCache(req.keys, req.trans[\"_cache\"], req.cache === \"clone\");\n                        if (cachedResult) {\n                            return DexiePromise.resolve(cachedResult);\n                        }\n                        return table.getMany(req).then(function (res) {\n                            req.trans[\"_cache\"] = {\n                                keys: req.keys,\n                                values: req.cache === \"clone\" ? deepClone(res) : res,\n                            };\n                            return res;\n                        });\n                    }, mutate: function (req) {\n                        if (req.type !== \"add\")\n                            req.trans[\"_cache\"] = null;\n                        return table.mutate(req);\n                    } });\n            },\n        };\n    },\n};\n\nfunction isCachableContext(ctx, table) {\n    return (ctx.trans.mode === 'readonly' &&\n        !!ctx.subscr &&\n        !ctx.trans.explicit &&\n        ctx.trans.db._options.cache !== 'disabled' &&\n        !table.schema.primaryKey.outbound);\n}\n\nfunction isCachableRequest(type, req) {\n    switch (type) {\n        case 'query':\n            return req.values && !req.unique;\n        case 'get':\n            return false;\n        case 'getMany':\n            return false;\n        case 'count':\n            return false;\n        case 'openCursor':\n            return false;\n    }\n}\n\nvar observabilityMiddleware = {\n    stack: \"dbcore\",\n    level: 0,\n    name: \"Observability\",\n    create: function (core) {\n        var dbName = core.schema.name;\n        var FULL_RANGE = new RangeSet(core.MIN_KEY, core.MAX_KEY);\n        return __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                if (PSD.subscr && mode !== 'readonly') {\n                    throw new exceptions.ReadOnly(\"Readwrite transaction in liveQuery context. Querier source: \".concat(PSD.querier));\n                }\n                return core.transaction(stores, mode, options);\n            }, table: function (tableName) {\n                var table = core.table(tableName);\n                var schema = table.schema;\n                var primaryKey = schema.primaryKey, indexes = schema.indexes;\n                var extractKey = primaryKey.extractKey, outbound = primaryKey.outbound;\n                var indexesWithAutoIncPK = primaryKey.autoIncrement && indexes.filter(function (index) { return index.compound && index.keyPath.includes(primaryKey.keyPath); });\n                var tableClone = __assign(__assign({}, table), { mutate: function (req) {\n                        var trans = req.trans;\n                        var mutatedParts = req.mutatedParts || (req.mutatedParts = {});\n                        var getRangeSet = function (indexName) {\n                            var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                            return (mutatedParts[part] ||\n                                (mutatedParts[part] = new RangeSet()));\n                        };\n                        var pkRangeSet = getRangeSet(\"\");\n                        var delsRangeSet = getRangeSet(\":dels\");\n                        var type = req.type;\n                        var _a = req.type === \"deleteRange\"\n                            ? [req.range]\n                            : req.type === \"delete\"\n                                ? [req.keys]\n                                : req.values.length < 50\n                                    ? [getEffectiveKeys(primaryKey, req).filter(function (id) { return id; }), req.values]\n                                    : [], keys = _a[0], newObjs = _a[1];\n                        var oldCache = req.trans[\"_cache\"];\n                        if (isArray(keys)) {\n                            pkRangeSet.addKeys(keys);\n                            var oldObjs = type === 'delete' || keys.length === newObjs.length ? getFromTransactionCache(keys, oldCache) : null;\n                            if (!oldObjs) {\n                                delsRangeSet.addKeys(keys);\n                            }\n                            if (oldObjs || newObjs) {\n                                trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs);\n                            }\n                        }\n                        else if (keys) {\n                            var range = { from: keys.lower, to: keys.upper };\n                            delsRangeSet.add(range);\n                            pkRangeSet.add(range);\n                        }\n                        else {\n                            pkRangeSet.add(FULL_RANGE);\n                            delsRangeSet.add(FULL_RANGE);\n                            schema.indexes.forEach(function (idx) { return getRangeSet(idx.name).add(FULL_RANGE); });\n                        }\n                        return table.mutate(req).then(function (res) {\n                            if (keys && (req.type === 'add' || req.type === 'put')) {\n                                pkRangeSet.addKeys(res.results);\n                                if (indexesWithAutoIncPK) {\n                                    indexesWithAutoIncPK.forEach(function (idx) {\n                                        var idxVals = req.values.map(function (v) { return idx.extractKey(v); });\n                                        var pkPos = idx.keyPath.findIndex(function (prop) { return prop === primaryKey.keyPath; });\n                                        res.results.forEach(function (pk) { return idxVals[pkPos] = pk; });\n                                        getRangeSet(idx.name).addKeys(idxVals);\n                                    });\n                                }\n                            }\n                            trans.mutatedParts = extendObservabilitySet(trans.mutatedParts || {}, mutatedParts);\n                            return res;\n                        });\n                    } });\n                var getRange = function (_a) {\n                    var _b, _c;\n                    var _d = _a.query, index = _d.index, range = _d.range;\n                    return [\n                        index,\n                        new RangeSet((_b = range.lower) !== null && _b !== void 0 ? _b : core.MIN_KEY, (_c = range.upper) !== null && _c !== void 0 ? _c : core.MAX_KEY),\n                    ];\n                };\n                var readSubscribers = {\n                    get: function (req) { return [primaryKey, new RangeSet(req.key)]; },\n                    getMany: function (req) { return [primaryKey, new RangeSet().addKeys(req.keys)]; },\n                    count: getRange,\n                    query: getRange,\n                    openCursor: getRange,\n                };\n                keys(readSubscribers).forEach(function (method) {\n                    tableClone[method] = function (req) {\n                        var subscr = PSD.subscr;\n                        var isLiveQuery = !!subscr;\n                        var cachable = isCachableContext(PSD, table) && isCachableRequest(method, req);\n                        var obsSet = cachable\n                            ? req.obsSet = {}\n                            : subscr;\n                        if (isLiveQuery) {\n                            var getRangeSet = function (indexName) {\n                                var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                                return (obsSet[part] ||\n                                    (obsSet[part] = new RangeSet()));\n                            };\n                            var pkRangeSet_1 = getRangeSet(\"\");\n                            var delsRangeSet_1 = getRangeSet(\":dels\");\n                            var _a = readSubscribers[method](req), queriedIndex = _a[0], queriedRanges = _a[1];\n                            if (method === 'query' && queriedIndex.isPrimaryKey && !req.values) {\n                                delsRangeSet_1.add(queriedRanges);\n                            }\n                            else {\n                                getRangeSet(queriedIndex.name || \"\").add(queriedRanges);\n                            }\n                            if (!queriedIndex.isPrimaryKey) {\n                                if (method === \"count\") {\n                                    delsRangeSet_1.add(FULL_RANGE);\n                                }\n                                else {\n                                    var keysPromise_1 = method === \"query\" &&\n                                        outbound &&\n                                        req.values &&\n                                        table.query(__assign(__assign({}, req), { values: false }));\n                                    return table[method].apply(this, arguments).then(function (res) {\n                                        if (method === \"query\") {\n                                            if (outbound && req.values) {\n                                                return keysPromise_1.then(function (_a) {\n                                                    var resultingKeys = _a.result;\n                                                    pkRangeSet_1.addKeys(resultingKeys);\n                                                    return res;\n                                                });\n                                            }\n                                            var pKeys = req.values\n                                                ? res.result.map(extractKey)\n                                                : res.result;\n                                            if (req.values) {\n                                                pkRangeSet_1.addKeys(pKeys);\n                                            }\n                                            else {\n                                                delsRangeSet_1.addKeys(pKeys);\n                                            }\n                                        }\n                                        else if (method === \"openCursor\") {\n                                            var cursor_1 = res;\n                                            var wantValues_1 = req.values;\n                                            return (cursor_1 &&\n                                                Object.create(cursor_1, {\n                                                    key: {\n                                                        get: function () {\n                                                            delsRangeSet_1.addKey(cursor_1.primaryKey);\n                                                            return cursor_1.key;\n                                                        },\n                                                    },\n                                                    primaryKey: {\n                                                        get: function () {\n                                                            var pkey = cursor_1.primaryKey;\n                                                            delsRangeSet_1.addKey(pkey);\n                                                            return pkey;\n                                                        },\n                                                    },\n                                                    value: {\n                                                        get: function () {\n                                                            wantValues_1 && pkRangeSet_1.addKey(cursor_1.primaryKey);\n                                                            return cursor_1.value;\n                                                        },\n                                                    },\n                                                }));\n                                        }\n                                        return res;\n                                    });\n                                }\n                            }\n                        }\n                        return table[method].apply(this, arguments);\n                    };\n                });\n                return tableClone;\n            } });\n    },\n};\nfunction trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs) {\n    function addAffectedIndex(ix) {\n        var rangeSet = getRangeSet(ix.name || \"\");\n        function extractKey(obj) {\n            return obj != null ? ix.extractKey(obj) : null;\n        }\n        var addKeyOrKeys = function (key) { return ix.multiEntry && isArray(key)\n            ? key.forEach(function (key) { return rangeSet.addKey(key); })\n            : rangeSet.addKey(key); };\n        (oldObjs || newObjs).forEach(function (_, i) {\n            var oldKey = oldObjs && extractKey(oldObjs[i]);\n            var newKey = newObjs && extractKey(newObjs[i]);\n            if (cmp(oldKey, newKey) !== 0) {\n                if (oldKey != null)\n                    addKeyOrKeys(oldKey);\n                if (newKey != null)\n                    addKeyOrKeys(newKey);\n            }\n        });\n    }\n    schema.indexes.forEach(addAffectedIndex);\n}\n\nfunction adjustOptimisticFromFailures(tblCache, req, res) {\n    if (res.numFailures === 0)\n        return req;\n    if (req.type === 'deleteRange') {\n        return null;\n    }\n    var numBulkOps = req.keys\n        ? req.keys.length\n        : 'values' in req && req.values\n            ? req.values.length\n            : 1;\n    if (res.numFailures === numBulkOps) {\n        return null;\n    }\n    var clone = __assign({}, req);\n    if (isArray(clone.keys)) {\n        clone.keys = clone.keys.filter(function (_, i) { return !(i in res.failures); });\n    }\n    if ('values' in clone && isArray(clone.values)) {\n        clone.values = clone.values.filter(function (_, i) { return !(i in res.failures); });\n    }\n    return clone;\n}\n\nfunction isAboveLower(key, range) {\n    return range.lower === undefined\n        ? true\n        : range.lowerOpen\n            ? cmp(key, range.lower) > 0\n            : cmp(key, range.lower) >= 0;\n}\nfunction isBelowUpper(key, range) {\n    return range.upper === undefined\n        ? true\n        : range.upperOpen\n            ? cmp(key, range.upper) < 0\n            : cmp(key, range.upper) <= 0;\n}\nfunction isWithinRange(key, range) {\n    return isAboveLower(key, range) && isBelowUpper(key, range);\n}\n\nfunction applyOptimisticOps(result, req, ops, table, cacheEntry, immutable) {\n    if (!ops || ops.length === 0)\n        return result;\n    var index = req.query.index;\n    var multiEntry = index.multiEntry;\n    var queryRange = req.query.range;\n    var primaryKey = table.schema.primaryKey;\n    var extractPrimKey = primaryKey.extractKey;\n    var extractIndex = index.extractKey;\n    var extractLowLevelIndex = (index.lowLevelIndex || index).extractKey;\n    var finalResult = ops.reduce(function (result, op) {\n        var modifedResult = result;\n        var includedValues = op.type === 'add' || op.type === 'put'\n            ? op.values.filter(function (v) {\n                var key = extractIndex(v);\n                return multiEntry && isArray(key)\n                    ? key.some(function (k) { return isWithinRange(k, queryRange); })\n                    : isWithinRange(key, queryRange);\n            }).map(function (v) {\n                v = deepClone(v);\n                if (immutable)\n                    Object.freeze(v);\n                return v;\n            })\n            : [];\n        switch (op.type) {\n            case 'add':\n                modifedResult = result.concat(req.values\n                    ? includedValues\n                    : includedValues.map(function (v) { return extractPrimKey(v); }));\n                break;\n            case 'put':\n                var keySet_1 = new RangeSet().addKeys(op.values.map(function (v) { return extractPrimKey(v); }));\n                modifedResult = result\n                    .filter(function (item) {\n                    var key = req.values ? extractPrimKey(item) : item;\n                    return !rangesOverlap(new RangeSet(key), keySet_1);\n                })\n                    .concat(req.values\n                    ? includedValues\n                    : includedValues.map(function (v) { return extractPrimKey(v); }));\n                break;\n            case 'delete':\n                var keysToDelete_1 = new RangeSet().addKeys(op.keys);\n                modifedResult = result.filter(function (item) {\n                    var key = req.values ? extractPrimKey(item) : item;\n                    return !rangesOverlap(new RangeSet(key), keysToDelete_1);\n                });\n                break;\n            case 'deleteRange':\n                var range_1 = op.range;\n                modifedResult = result.filter(function (item) { return !isWithinRange(extractPrimKey(item), range_1); });\n                break;\n        }\n        return modifedResult;\n    }, result);\n    if (finalResult === result)\n        return result;\n    finalResult.sort(function (a, b) {\n        return cmp(extractLowLevelIndex(a), extractLowLevelIndex(b)) ||\n            cmp(extractPrimKey(a), extractPrimKey(b));\n    });\n    if (req.limit && req.limit < Infinity) {\n        if (finalResult.length > req.limit) {\n            finalResult.length = req.limit;\n        }\n        else if (result.length === req.limit && finalResult.length < req.limit) {\n            cacheEntry.dirty = true;\n        }\n    }\n    return immutable ? Object.freeze(finalResult) : finalResult;\n}\n\nfunction areRangesEqual(r1, r2) {\n    return (cmp(r1.lower, r2.lower) === 0 &&\n        cmp(r1.upper, r2.upper) === 0 &&\n        !!r1.lowerOpen === !!r2.lowerOpen &&\n        !!r1.upperOpen === !!r2.upperOpen);\n}\n\nfunction compareLowers(lower1, lower2, lowerOpen1, lowerOpen2) {\n    if (lower1 === undefined)\n        return lower2 !== undefined ? -1 : 0;\n    if (lower2 === undefined)\n        return 1;\n    var c = cmp(lower1, lower2);\n    if (c === 0) {\n        if (lowerOpen1 && lowerOpen2)\n            return 0;\n        if (lowerOpen1)\n            return 1;\n        if (lowerOpen2)\n            return -1;\n    }\n    return c;\n}\nfunction compareUppers(upper1, upper2, upperOpen1, upperOpen2) {\n    if (upper1 === undefined)\n        return upper2 !== undefined ? 1 : 0;\n    if (upper2 === undefined)\n        return -1;\n    var c = cmp(upper1, upper2);\n    if (c === 0) {\n        if (upperOpen1 && upperOpen2)\n            return 0;\n        if (upperOpen1)\n            return -1;\n        if (upperOpen2)\n            return 1;\n    }\n    return c;\n}\nfunction isSuperRange(r1, r2) {\n    return (compareLowers(r1.lower, r2.lower, r1.lowerOpen, r2.lowerOpen) <= 0 &&\n        compareUppers(r1.upper, r2.upper, r1.upperOpen, r2.upperOpen) >= 0);\n}\n\nfunction findCompatibleQuery(dbName, tableName, type, req) {\n    var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n    if (!tblCache)\n        return [];\n    var queries = tblCache.queries[type];\n    if (!queries)\n        return [null, false, tblCache, null];\n    var indexName = req.query ? req.query.index.name : null;\n    var entries = queries[indexName || ''];\n    if (!entries)\n        return [null, false, tblCache, null];\n    switch (type) {\n        case 'query':\n            var equalEntry = entries.find(function (entry) {\n                return entry.req.limit === req.limit &&\n                    entry.req.values === req.values &&\n                    areRangesEqual(entry.req.query.range, req.query.range);\n            });\n            if (equalEntry)\n                return [\n                    equalEntry,\n                    true,\n                    tblCache,\n                    entries,\n                ];\n            var superEntry = entries.find(function (entry) {\n                var limit = 'limit' in entry.req ? entry.req.limit : Infinity;\n                return (limit >= req.limit &&\n                    (req.values ? entry.req.values : true) &&\n                    isSuperRange(entry.req.query.range, req.query.range));\n            });\n            return [superEntry, false, tblCache, entries];\n        case 'count':\n            var countQuery = entries.find(function (entry) {\n                return areRangesEqual(entry.req.query.range, req.query.range);\n            });\n            return [countQuery, !!countQuery, tblCache, entries];\n    }\n}\n\nfunction subscribeToCacheEntry(cacheEntry, container, requery, signal) {\n    cacheEntry.subscribers.add(requery);\n    signal.addEventListener(\"abort\", function () {\n        cacheEntry.subscribers.delete(requery);\n        if (cacheEntry.subscribers.size === 0) {\n            enqueForDeletion(cacheEntry, container);\n        }\n    });\n}\nfunction enqueForDeletion(cacheEntry, container) {\n    setTimeout(function () {\n        if (cacheEntry.subscribers.size === 0) {\n            delArrayItem(container, cacheEntry);\n        }\n    }, 3000);\n}\n\nvar cacheMiddleware = {\n    stack: 'dbcore',\n    level: 0,\n    name: 'Cache',\n    create: function (core) {\n        var dbName = core.schema.name;\n        var coreMW = __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                var idbtrans = core.transaction(stores, mode, options);\n                if (mode === 'readwrite') {\n                    var ac_1 = new AbortController();\n                    var signal = ac_1.signal;\n                    var endTransaction = function (wasCommitted) { return function () {\n                        ac_1.abort();\n                        if (mode === 'readwrite') {\n                            var affectedSubscribers_1 = new Set();\n                            for (var _i = 0, stores_1 = stores; _i < stores_1.length; _i++) {\n                                var storeName = stores_1[_i];\n                                var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(storeName)];\n                                if (tblCache) {\n                                    var table = core.table(storeName);\n                                    var ops = tblCache.optimisticOps.filter(function (op) { return op.trans === idbtrans; });\n                                    if (idbtrans._explicit && wasCommitted && idbtrans.mutatedParts) {\n                                        for (var _a = 0, _b = Object.values(tblCache.queries.query); _a < _b.length; _a++) {\n                                            var entries = _b[_a];\n                                            for (var _c = 0, _d = entries.slice(); _c < _d.length; _c++) {\n                                                var entry = _d[_c];\n                                                if (obsSetsOverlap(entry.obsSet, idbtrans.mutatedParts)) {\n                                                    delArrayItem(entries, entry);\n                                                    entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                }\n                                            }\n                                        }\n                                    }\n                                    else if (ops.length > 0) {\n                                        tblCache.optimisticOps = tblCache.optimisticOps.filter(function (op) { return op.trans !== idbtrans; });\n                                        for (var _e = 0, _f = Object.values(tblCache.queries.query); _e < _f.length; _e++) {\n                                            var entries = _f[_e];\n                                            for (var _g = 0, _h = entries.slice(); _g < _h.length; _g++) {\n                                                var entry = _h[_g];\n                                                if (entry.res != null &&\n                                                    idbtrans.mutatedParts\n) {\n                                                    if (wasCommitted && !entry.dirty) {\n                                                        var freezeResults = Object.isFrozen(entry.res);\n                                                        var modRes = applyOptimisticOps(entry.res, entry.req, ops, table, entry, freezeResults);\n                                                        if (entry.dirty) {\n                                                            delArrayItem(entries, entry);\n                                                            entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                        }\n                                                        else if (modRes !== entry.res) {\n                                                            entry.res = modRes;\n                                                            entry.promise = DexiePromise.resolve({ result: modRes });\n                                                        }\n                                                    }\n                                                    else {\n                                                        if (entry.dirty) {\n                                                            delArrayItem(entries, entry);\n                                                        }\n                                                        entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                            affectedSubscribers_1.forEach(function (requery) { return requery(); });\n                        }\n                    }; };\n                    idbtrans.addEventListener('abort', endTransaction(false), {\n                        signal: signal,\n                    });\n                    idbtrans.addEventListener('error', endTransaction(false), {\n                        signal: signal,\n                    });\n                    idbtrans.addEventListener('complete', endTransaction(true), {\n                        signal: signal,\n                    });\n                }\n                return idbtrans;\n            }, table: function (tableName) {\n                var downTable = core.table(tableName);\n                var primKey = downTable.schema.primaryKey;\n                var tableMW = __assign(__assign({}, downTable), { mutate: function (req) {\n                        var trans = PSD.trans;\n                        if (primKey.outbound ||\n                            trans.db._options.cache === 'disabled' ||\n                            trans.explicit\n                        ) {\n                            return downTable.mutate(req);\n                        }\n                        var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                        if (!tblCache)\n                            return downTable.mutate(req);\n                        var promise = downTable.mutate(req);\n                        if ((req.type === 'add' || req.type === 'put') && (req.values.length >= 50 || getEffectiveKeys(primKey, req).some(function (key) { return key == null; }))) {\n                            promise.then(function (res) {\n                                var reqWithResolvedKeys = __assign(__assign({}, req), { values: req.values.map(function (value, i) {\n                                        var _a;\n                                        var valueWithKey = ((_a = primKey.keyPath) === null || _a === void 0 ? void 0 : _a.includes('.'))\n                                            ? deepClone(value)\n                                            : __assign({}, value);\n                                        setByKeyPath(valueWithKey, primKey.keyPath, res.results[i]);\n                                        return valueWithKey;\n                                    }) });\n                                var adjustedReq = adjustOptimisticFromFailures(tblCache, reqWithResolvedKeys, res);\n                                tblCache.optimisticOps.push(adjustedReq);\n                                queueMicrotask(function () { return req.mutatedParts && signalSubscribersLazily(req.mutatedParts); });\n                            });\n                        }\n                        else {\n                            tblCache.optimisticOps.push(req);\n                            req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                            promise.then(function (res) {\n                                if (res.numFailures > 0) {\n                                    delArrayItem(tblCache.optimisticOps, req);\n                                    var adjustedReq = adjustOptimisticFromFailures(tblCache, req, res);\n                                    if (adjustedReq) {\n                                        tblCache.optimisticOps.push(adjustedReq);\n                                    }\n                                    req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                }\n                            });\n                            promise.catch(function () {\n                                delArrayItem(tblCache.optimisticOps, req);\n                                req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                            });\n                        }\n                        return promise;\n                    }, query: function (req) {\n                        var _a;\n                        if (!isCachableContext(PSD, downTable) || !isCachableRequest(\"query\", req))\n                            return downTable.query(req);\n                        var freezeResults = ((_a = PSD.trans) === null || _a === void 0 ? void 0 : _a.db._options.cache) === 'immutable';\n                        var _b = PSD, requery = _b.requery, signal = _b.signal;\n                        var _c = findCompatibleQuery(dbName, tableName, 'query', req), cacheEntry = _c[0], exactMatch = _c[1], tblCache = _c[2], container = _c[3];\n                        if (cacheEntry && exactMatch) {\n                            cacheEntry.obsSet = req.obsSet;\n                        }\n                        else {\n                            var promise = downTable.query(req).then(function (res) {\n                                var result = res.result;\n                                if (cacheEntry)\n                                    cacheEntry.res = result;\n                                if (freezeResults) {\n                                    for (var i = 0, l = result.length; i < l; ++i) {\n                                        Object.freeze(result[i]);\n                                    }\n                                    Object.freeze(result);\n                                }\n                                else {\n                                    res.result = deepClone(result);\n                                }\n                                return res;\n                            }).catch(function (error) {\n                                if (container && cacheEntry)\n                                    delArrayItem(container, cacheEntry);\n                                return Promise.reject(error);\n                            });\n                            cacheEntry = {\n                                obsSet: req.obsSet,\n                                promise: promise,\n                                subscribers: new Set(),\n                                type: 'query',\n                                req: req,\n                                dirty: false,\n                            };\n                            if (container) {\n                                container.push(cacheEntry);\n                            }\n                            else {\n                                container = [cacheEntry];\n                                if (!tblCache) {\n                                    tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)] = {\n                                        queries: {\n                                            query: {},\n                                            count: {},\n                                        },\n                                        objs: new Map(),\n                                        optimisticOps: [],\n                                        unsignaledParts: {}\n                                    };\n                                }\n                                tblCache.queries.query[req.query.index.name || ''] = container;\n                            }\n                        }\n                        subscribeToCacheEntry(cacheEntry, container, requery, signal);\n                        return cacheEntry.promise.then(function (res) {\n                            return {\n                                result: applyOptimisticOps(res.result, req, tblCache === null || tblCache === void 0 ? void 0 : tblCache.optimisticOps, downTable, cacheEntry, freezeResults),\n                            };\n                        });\n                    } });\n                return tableMW;\n            } });\n        return coreMW;\n    },\n};\n\nfunction vipify(target, vipDb) {\n    return new Proxy(target, {\n        get: function (target, prop, receiver) {\n            if (prop === 'db')\n                return vipDb;\n            return Reflect.get(target, prop, receiver);\n        }\n    });\n}\n\nvar Dexie$1 =  (function () {\n    function Dexie(name, options) {\n        var _this = this;\n        this._middlewares = {};\n        this.verno = 0;\n        var deps = Dexie.dependencies;\n        this._options = options = __assign({\n            addons: Dexie.addons, autoOpen: true,\n            indexedDB: deps.indexedDB, IDBKeyRange: deps.IDBKeyRange, cache: 'cloned' }, options);\n        this._deps = {\n            indexedDB: options.indexedDB,\n            IDBKeyRange: options.IDBKeyRange\n        };\n        var addons = options.addons;\n        this._dbSchema = {};\n        this._versions = [];\n        this._storeNames = [];\n        this._allTables = {};\n        this.idbdb = null;\n        this._novip = this;\n        var state = {\n            dbOpenError: null,\n            isBeingOpened: false,\n            onReadyBeingFired: null,\n            openComplete: false,\n            dbReadyResolve: nop,\n            dbReadyPromise: null,\n            cancelOpen: nop,\n            openCanceller: null,\n            autoSchema: true,\n            PR1398_maxLoop: 3,\n            autoOpen: options.autoOpen,\n        };\n        state.dbReadyPromise = new DexiePromise(function (resolve) {\n            state.dbReadyResolve = resolve;\n        });\n        state.openCanceller = new DexiePromise(function (_, reject) {\n            state.cancelOpen = reject;\n        });\n        this._state = state;\n        this.name = name;\n        this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", \"close\", { ready: [promisableChain, nop] });\n        this.on.ready.subscribe = override(this.on.ready.subscribe, function (subscribe) {\n            return function (subscriber, bSticky) {\n                Dexie.vip(function () {\n                    var state = _this._state;\n                    if (state.openComplete) {\n                        if (!state.dbOpenError)\n                            DexiePromise.resolve().then(subscriber);\n                        if (bSticky)\n                            subscribe(subscriber);\n                    }\n                    else if (state.onReadyBeingFired) {\n                        state.onReadyBeingFired.push(subscriber);\n                        if (bSticky)\n                            subscribe(subscriber);\n                    }\n                    else {\n                        subscribe(subscriber);\n                        var db_1 = _this;\n                        if (!bSticky)\n                            subscribe(function unsubscribe() {\n                                db_1.on.ready.unsubscribe(subscriber);\n                                db_1.on.ready.unsubscribe(unsubscribe);\n                            });\n                    }\n                });\n            };\n        });\n        this.Collection = createCollectionConstructor(this);\n        this.Table = createTableConstructor(this);\n        this.Transaction = createTransactionConstructor(this);\n        this.Version = createVersionConstructor(this);\n        this.WhereClause = createWhereClauseConstructor(this);\n        this.on(\"versionchange\", function (ev) {\n            if (ev.newVersion > 0)\n                console.warn(\"Another connection wants to upgrade database '\".concat(_this.name, \"'. Closing db now to resume the upgrade.\"));\n            else\n                console.warn(\"Another connection wants to delete database '\".concat(_this.name, \"'. Closing db now to resume the delete request.\"));\n            _this.close({ disableAutoOpen: false });\n        });\n        this.on(\"blocked\", function (ev) {\n            if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n                console.warn(\"Dexie.delete('\".concat(_this.name, \"') was blocked\"));\n            else\n                console.warn(\"Upgrade '\".concat(_this.name, \"' blocked by other connection holding version \").concat(ev.oldVersion / 10));\n        });\n        this._maxKey = getMaxKey(options.IDBKeyRange);\n        this._createTransaction = function (mode, storeNames, dbschema, parentTransaction) { return new _this.Transaction(mode, storeNames, dbschema, _this._options.chromeTransactionDurability, parentTransaction); };\n        this._fireOnBlocked = function (ev) {\n            _this.on(\"blocked\").fire(ev);\n            connections\n                .filter(function (c) { return c.name === _this.name && c !== _this && !c._state.vcFired; })\n                .map(function (c) { return c.on(\"versionchange\").fire(ev); });\n        };\n        this.use(cacheExistingValuesMiddleware);\n        this.use(cacheMiddleware);\n        this.use(observabilityMiddleware);\n        this.use(virtualIndexMiddleware);\n        this.use(hooksMiddleware);\n        var vipDB = new Proxy(this, {\n            get: function (_, prop, receiver) {\n                if (prop === '_vip')\n                    return true;\n                if (prop === 'table')\n                    return function (tableName) { return vipify(_this.table(tableName), vipDB); };\n                var rv = Reflect.get(_, prop, receiver);\n                if (rv instanceof Table)\n                    return vipify(rv, vipDB);\n                if (prop === 'tables')\n                    return rv.map(function (t) { return vipify(t, vipDB); });\n                if (prop === '_createTransaction')\n                    return function () {\n                        var tx = rv.apply(this, arguments);\n                        return vipify(tx, vipDB);\n                    };\n                return rv;\n            }\n        });\n        this.vip = vipDB;\n        addons.forEach(function (addon) { return addon(_this); });\n    }\n    Dexie.prototype.version = function (versionNumber) {\n        if (isNaN(versionNumber) || versionNumber < 0.1)\n            throw new exceptions.Type(\"Given version is not a positive number\");\n        versionNumber = Math.round(versionNumber * 10) / 10;\n        if (this.idbdb || this._state.isBeingOpened)\n            throw new exceptions.Schema(\"Cannot add version when database is open\");\n        this.verno = Math.max(this.verno, versionNumber);\n        var versions = this._versions;\n        var versionInstance = versions.filter(function (v) { return v._cfg.version === versionNumber; })[0];\n        if (versionInstance)\n            return versionInstance;\n        versionInstance = new this.Version(versionNumber);\n        versions.push(versionInstance);\n        versions.sort(lowerVersionFirst);\n        versionInstance.stores({});\n        this._state.autoSchema = false;\n        return versionInstance;\n    };\n    Dexie.prototype._whenReady = function (fn) {\n        var _this = this;\n        return (this.idbdb && (this._state.openComplete || PSD.letThrough || this._vip)) ? fn() : new DexiePromise(function (resolve, reject) {\n            if (_this._state.openComplete) {\n                return reject(new exceptions.DatabaseClosed(_this._state.dbOpenError));\n            }\n            if (!_this._state.isBeingOpened) {\n                if (!_this._state.autoOpen) {\n                    reject(new exceptions.DatabaseClosed());\n                    return;\n                }\n                _this.open().catch(nop);\n            }\n            _this._state.dbReadyPromise.then(resolve, reject);\n        }).then(fn);\n    };\n    Dexie.prototype.use = function (_a) {\n        var stack = _a.stack, create = _a.create, level = _a.level, name = _a.name;\n        if (name)\n            this.unuse({ stack: stack, name: name });\n        var middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n        middlewares.push({ stack: stack, create: create, level: level == null ? 10 : level, name: name });\n        middlewares.sort(function (a, b) { return a.level - b.level; });\n        return this;\n    };\n    Dexie.prototype.unuse = function (_a) {\n        var stack = _a.stack, name = _a.name, create = _a.create;\n        if (stack && this._middlewares[stack]) {\n            this._middlewares[stack] = this._middlewares[stack].filter(function (mw) {\n                return create ? mw.create !== create :\n                    name ? mw.name !== name :\n                        false;\n            });\n        }\n        return this;\n    };\n    Dexie.prototype.open = function () {\n        var _this = this;\n        return usePSD(globalPSD,\n        function () { return dexieOpen(_this); });\n    };\n    Dexie.prototype._close = function () {\n        var state = this._state;\n        var idx = connections.indexOf(this);\n        if (idx >= 0)\n            connections.splice(idx, 1);\n        if (this.idbdb) {\n            try {\n                this.idbdb.close();\n            }\n            catch (e) { }\n            this.idbdb = null;\n        }\n        if (!state.isBeingOpened) {\n            state.dbReadyPromise = new DexiePromise(function (resolve) {\n                state.dbReadyResolve = resolve;\n            });\n            state.openCanceller = new DexiePromise(function (_, reject) {\n                state.cancelOpen = reject;\n            });\n        }\n    };\n    Dexie.prototype.close = function (_a) {\n        var _b = _a === void 0 ? { disableAutoOpen: true } : _a, disableAutoOpen = _b.disableAutoOpen;\n        var state = this._state;\n        if (disableAutoOpen) {\n            if (state.isBeingOpened) {\n                state.cancelOpen(new exceptions.DatabaseClosed());\n            }\n            this._close();\n            state.autoOpen = false;\n            state.dbOpenError = new exceptions.DatabaseClosed();\n        }\n        else {\n            this._close();\n            state.autoOpen = this._options.autoOpen ||\n                state.isBeingOpened;\n            state.openComplete = false;\n            state.dbOpenError = null;\n        }\n    };\n    Dexie.prototype.delete = function (closeOptions) {\n        var _this = this;\n        if (closeOptions === void 0) { closeOptions = { disableAutoOpen: true }; }\n        var hasInvalidArguments = arguments.length > 0 && typeof arguments[0] !== 'object';\n        var state = this._state;\n        return new DexiePromise(function (resolve, reject) {\n            var doDelete = function () {\n                _this.close(closeOptions);\n                var req = _this._deps.indexedDB.deleteDatabase(_this.name);\n                req.onsuccess = wrap(function () {\n                    _onDatabaseDeleted(_this._deps, _this.name);\n                    resolve();\n                });\n                req.onerror = eventRejectHandler(reject);\n                req.onblocked = _this._fireOnBlocked;\n            };\n            if (hasInvalidArguments)\n                throw new exceptions.InvalidArgument(\"Invalid closeOptions argument to db.delete()\");\n            if (state.isBeingOpened) {\n                state.dbReadyPromise.then(doDelete);\n            }\n            else {\n                doDelete();\n            }\n        });\n    };\n    Dexie.prototype.backendDB = function () {\n        return this.idbdb;\n    };\n    Dexie.prototype.isOpen = function () {\n        return this.idbdb !== null;\n    };\n    Dexie.prototype.hasBeenClosed = function () {\n        var dbOpenError = this._state.dbOpenError;\n        return dbOpenError && (dbOpenError.name === 'DatabaseClosed');\n    };\n    Dexie.prototype.hasFailed = function () {\n        return this._state.dbOpenError !== null;\n    };\n    Dexie.prototype.dynamicallyOpened = function () {\n        return this._state.autoSchema;\n    };\n    Object.defineProperty(Dexie.prototype, \"tables\", {\n        get: function () {\n            var _this = this;\n            return keys(this._allTables).map(function (name) { return _this._allTables[name]; });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Dexie.prototype.transaction = function () {\n        var args = extractTransactionArgs.apply(this, arguments);\n        return this._transaction.apply(this, args);\n    };\n    Dexie.prototype._transaction = function (mode, tables, scopeFunc) {\n        var _this = this;\n        var parentTransaction = PSD.trans;\n        if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1)\n            parentTransaction = null;\n        var onlyIfCompatible = mode.indexOf('?') !== -1;\n        mode = mode.replace('!', '').replace('?', '');\n        var idbMode, storeNames;\n        try {\n            storeNames = tables.map(function (table) {\n                var storeName = table instanceof _this.Table ? table.name : table;\n                if (typeof storeName !== 'string')\n                    throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                return storeName;\n            });\n            if (mode == \"r\" || mode === READONLY)\n                idbMode = READONLY;\n            else if (mode == \"rw\" || mode == READWRITE)\n                idbMode = READWRITE;\n            else\n                throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n            if (parentTransaction) {\n                if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n                    if (onlyIfCompatible) {\n                        parentTransaction = null;\n                    }\n                    else\n                        throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                }\n                if (parentTransaction) {\n                    storeNames.forEach(function (storeName) {\n                        if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                            if (onlyIfCompatible) {\n                                parentTransaction = null;\n                            }\n                            else\n                                throw new exceptions.SubTransaction(\"Table \" + storeName +\n                                    \" not included in parent transaction.\");\n                        }\n                    });\n                }\n                if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                    parentTransaction = null;\n                }\n            }\n        }\n        catch (e) {\n            return parentTransaction ?\n                parentTransaction._promise(null, function (_, reject) { reject(e); }) :\n                rejection(e);\n        }\n        var enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n        return (parentTransaction ?\n            parentTransaction._promise(idbMode, enterTransaction, \"lock\") :\n            PSD.trans ?\n                usePSD(PSD.transless, function () { return _this._whenReady(enterTransaction); }) :\n                this._whenReady(enterTransaction));\n    };\n    Dexie.prototype.table = function (tableName) {\n        if (!hasOwn(this._allTables, tableName)) {\n            throw new exceptions.InvalidTable(\"Table \".concat(tableName, \" does not exist\"));\n        }\n        return this._allTables[tableName];\n    };\n    return Dexie;\n}());\n\nvar symbolObservable = typeof Symbol !== \"undefined\" && \"observable\" in Symbol\n    ? Symbol.observable\n    : \"@@observable\";\nvar Observable =  (function () {\n    function Observable(subscribe) {\n        this._subscribe = subscribe;\n    }\n    Observable.prototype.subscribe = function (x, error, complete) {\n        return this._subscribe(!x || typeof x === \"function\" ? { next: x, error: error, complete: complete } : x);\n    };\n    Observable.prototype[symbolObservable] = function () {\n        return this;\n    };\n    return Observable;\n}());\n\nvar domDeps;\ntry {\n    domDeps = {\n        indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n        IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n    };\n}\ncatch (e) {\n    domDeps = { indexedDB: null, IDBKeyRange: null };\n}\n\nfunction liveQuery(querier) {\n    var hasValue = false;\n    var currentValue;\n    var observable = new Observable(function (observer) {\n        var scopeFuncIsAsync = isAsyncFunction(querier);\n        function execute(ctx) {\n            var wasRootExec = beginMicroTickScope();\n            try {\n                if (scopeFuncIsAsync) {\n                    incrementExpectedAwaits();\n                }\n                var rv = newScope(querier, ctx);\n                if (scopeFuncIsAsync) {\n                    rv = rv.finally(decrementExpectedAwaits);\n                }\n                return rv;\n            }\n            finally {\n                wasRootExec && endMicroTickScope();\n            }\n        }\n        var closed = false;\n        var abortController;\n        var accumMuts = {};\n        var currentObs = {};\n        var subscription = {\n            get closed() {\n                return closed;\n            },\n            unsubscribe: function () {\n                if (closed)\n                    return;\n                closed = true;\n                if (abortController)\n                    abortController.abort();\n                if (startedListening)\n                    globalEvents.storagemutated.unsubscribe(mutationListener);\n            },\n        };\n        observer.start && observer.start(subscription);\n        var startedListening = false;\n        var doQuery = function () { return execInGlobalContext(_doQuery); };\n        function shouldNotify() {\n            return obsSetsOverlap(currentObs, accumMuts);\n        }\n        var mutationListener = function (parts) {\n            extendObservabilitySet(accumMuts, parts);\n            if (shouldNotify()) {\n                doQuery();\n            }\n        };\n        var _doQuery = function () {\n            if (closed ||\n                !domDeps.indexedDB)\n             {\n                return;\n            }\n            accumMuts = {};\n            var subscr = {};\n            if (abortController)\n                abortController.abort();\n            abortController = new AbortController();\n            var ctx = {\n                subscr: subscr,\n                signal: abortController.signal,\n                requery: doQuery,\n                querier: querier,\n                trans: null\n            };\n            var ret = execute(ctx);\n            Promise.resolve(ret).then(function (result) {\n                hasValue = true;\n                currentValue = result;\n                if (closed || ctx.signal.aborted) {\n                    return;\n                }\n                accumMuts = {};\n                currentObs = subscr;\n                if (!objectIsEmpty(currentObs) && !startedListening) {\n                    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, mutationListener);\n                    startedListening = true;\n                }\n                execInGlobalContext(function () { return !closed && observer.next && observer.next(result); });\n            }, function (err) {\n                hasValue = false;\n                if (!['DatabaseClosedError', 'AbortError'].includes(err === null || err === void 0 ? void 0 : err.name)) {\n                    if (!closed)\n                        execInGlobalContext(function () {\n                            if (closed)\n                                return;\n                            observer.error && observer.error(err);\n                        });\n                }\n            });\n        };\n        setTimeout(doQuery, 0);\n        return subscription;\n    });\n    observable.hasValue = function () { return hasValue; };\n    observable.getValue = function () { return currentValue; };\n    return observable;\n}\n\nvar Dexie = Dexie$1;\nprops(Dexie, __assign(__assign({}, fullNameExceptions), {\n    delete: function (databaseName) {\n        var db = new Dexie(databaseName, { addons: [] });\n        return db.delete();\n    },\n    exists: function (name) {\n        return new Dexie(name, { addons: [] }).open().then(function (db) {\n            db.close();\n            return true;\n        }).catch('NoSuchDatabaseError', function () { return false; });\n    },\n    getDatabaseNames: function (cb) {\n        try {\n            return getDatabaseNames(Dexie.dependencies).then(cb);\n        }\n        catch (_a) {\n            return rejection(new exceptions.MissingAPI());\n        }\n    },\n    defineClass: function () {\n        function Class(content) {\n            extend(this, content);\n        }\n        return Class;\n    }, ignoreTransaction: function (scopeFunc) {\n        return PSD.trans ?\n            usePSD(PSD.transless, scopeFunc) :\n            scopeFunc();\n    }, vip: vip, async: function (generatorFn) {\n        return function () {\n            try {\n                var rv = awaitIterator(generatorFn.apply(this, arguments));\n                if (!rv || typeof rv.then !== 'function')\n                    return DexiePromise.resolve(rv);\n                return rv;\n            }\n            catch (e) {\n                return rejection(e);\n            }\n        };\n    }, spawn: function (generatorFn, args, thiz) {\n        try {\n            var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n            if (!rv || typeof rv.then !== 'function')\n                return DexiePromise.resolve(rv);\n            return rv;\n        }\n        catch (e) {\n            return rejection(e);\n        }\n    },\n    currentTransaction: {\n        get: function () { return PSD.trans || null; }\n    }, waitFor: function (promiseOrFunction, optionalTimeout) {\n        var promise = DexiePromise.resolve(typeof promiseOrFunction === 'function' ?\n            Dexie.ignoreTransaction(promiseOrFunction) :\n            promiseOrFunction)\n            .timeout(optionalTimeout || 60000);\n        return PSD.trans ?\n            PSD.trans.waitFor(promise) :\n            promise;\n    },\n    Promise: DexiePromise,\n    debug: {\n        get: function () { return debug; },\n        set: function (value) {\n            setDebug(value);\n        }\n    },\n    derive: derive, extend: extend, props: props, override: override,\n    Events: Events, on: globalEvents, liveQuery: liveQuery, extendObservabilitySet: extendObservabilitySet,\n    getByKeyPath: getByKeyPath, setByKeyPath: setByKeyPath, delByKeyPath: delByKeyPath, shallowClone: shallowClone, deepClone: deepClone, getObjectDiff: getObjectDiff, cmp: cmp, asap: asap$1,\n    minKey: minKey,\n    addons: [],\n    connections: connections,\n    errnames: errnames,\n    dependencies: domDeps, cache: cache,\n    semVer: DEXIE_VERSION, version: DEXIE_VERSION.split('.')\n        .map(function (n) { return parseInt(n); })\n        .reduce(function (p, c, i) { return p + (c / Math.pow(10, i * 2)); }) }));\nDexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\n\nif (typeof dispatchEvent !== 'undefined' && typeof addEventListener !== 'undefined') {\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (updatedParts) {\n        if (!propagatingLocally) {\n            var event_1;\n            event_1 = new CustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, {\n                detail: updatedParts\n            });\n            propagatingLocally = true;\n            dispatchEvent(event_1);\n            propagatingLocally = false;\n        }\n    });\n    addEventListener(STORAGE_MUTATED_DOM_EVENT_NAME, function (_a) {\n        var detail = _a.detail;\n        if (!propagatingLocally) {\n            propagateLocally(detail);\n        }\n    });\n}\nfunction propagateLocally(updateParts) {\n    var wasMe = propagatingLocally;\n    try {\n        propagatingLocally = true;\n        globalEvents.storagemutated.fire(updateParts);\n        signalSubscribersNow(updateParts, true);\n    }\n    finally {\n        propagatingLocally = wasMe;\n    }\n}\nvar propagatingLocally = false;\n\nvar bc;\nvar createBC = function () { };\nif (typeof BroadcastChannel !== 'undefined') {\n    createBC = function () {\n        bc = new BroadcastChannel(STORAGE_MUTATED_DOM_EVENT_NAME);\n        bc.onmessage = function (ev) { return ev.data && propagateLocally(ev.data); };\n    };\n    createBC();\n    if (typeof bc.unref === 'function') {\n        bc.unref();\n    }\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (changedParts) {\n        if (!propagatingLocally) {\n            bc.postMessage(changedParts);\n        }\n    });\n}\n\nif (typeof addEventListener !== 'undefined') {\n    addEventListener('pagehide', function (event) {\n        if (!Dexie$1.disableBfCache && event.persisted) {\n            if (debug)\n                console.debug('Dexie: handling persisted pagehide');\n            bc === null || bc === void 0 ? void 0 : bc.close();\n            for (var _i = 0, connections_1 = connections; _i < connections_1.length; _i++) {\n                var db = connections_1[_i];\n                db.close({ disableAutoOpen: false });\n            }\n        }\n    });\n    addEventListener('pageshow', function (event) {\n        if (!Dexie$1.disableBfCache && event.persisted) {\n            if (debug)\n                console.debug('Dexie: handling persisted pageshow');\n            createBC();\n            propagateLocally({ all: new RangeSet(-Infinity, [[]]) });\n        }\n    });\n}\n\nfunction add(value) {\n    return new PropModification({ add: value });\n}\n\nfunction remove(value) {\n    return new PropModification({ remove: value });\n}\n\nfunction replacePrefix(a, b) {\n    return new PropModification({ replacePrefix: [a, b] });\n}\n\nDexiePromise.rejectionMapper = mapError;\nsetDebug(debug);\n\nexport { Dexie$1 as Dexie, Entity, PropModSymbol, PropModification, RangeSet, add, cmp, Dexie$1 as default, liveQuery, mergeRanges, rangesOverlap, remove, replacePrefix };\n//# sourceMappingURL=dexie.mjs.map\n"],"names":["extendStatics","d","b","p","__extends","__","__assign","t","s","i","n","__spreadArray","to","from","pack","l","ar","_global","keys","isArray","extend","obj","extension","key","getProto","_hasOwn","hasOwn","prop","props","proto","setProp","defineProperty","functionOrGetSet","options","derive","Child","Parent","getOwnPropertyDescriptor","getPropertyDescriptor","pd","_slice","slice","args","start","end","override","origFunc","overridedFactory","assert","asap$1","fn","arrayToObject","array","extractor","result","item","nameAndValue","getByKeyPath","keyPath","rv","val","period","innerObj","setByKeyPath","value","currentKeyPath","remainingKeyPath","delByKeyPath","kp","shallowClone","m","concat","flatten","a","intrinsicTypeNames","num","intrinsicTypes","cloneSimpleObjectTree","o","k","v","objectIsEmpty","circularRefs","deepClone","any","innerDeepClone","x","toString","toStringTag","iteratorSymbol","getIteratorOf","delArrayItem","NO_CHAR_ARRAY","getArrayOf","arrayLike","it","isAsyncFunction","dexieErrorNames","idbDomErrorNames","errorList","defaultTexts","DexieError","name","msg","getMultiErrorMessage","failures","ModifyError","successCount","failedKeys","BulkError","pos","errnames","BaseException","exceptions","fullName","msgOrInner","inner","exceptionMap","mapError","domError","message","fullNameExceptions","nop","mirror","pureFunctionChain","f1","f2","callBoth","on1","on2","hookCreatingChain","res","onsuccess","onerror","res2","hookDeletingChain","hookUpdatingChain","modifications","reverseStoppableEventChain","promisableChain","thiz","debug","setDebug","filter","INTERNAL","ZONE_ECHO_LIMIT","_a$1","globalP","nativeP","resolvedNativePromise","nativePromiseProto","resolvedGlobalPromise","nativePromiseThen","NativePromise","patchGlobalPromise","schedulePhysicalTick","physicalTick","asap","callback","microtickQueue","needsNewPhysicalTick","isOutsideMicroTick","unhandledErrors","rejectingErrors","rejectionMapper","globalPSD","PSD","numScheduledCalls","tickFinalizers","DexiePromise","psd","handleRejection","executePromiseTask","thenProp","microTaskId","totalEchoes","then","onFulfilled","onRejected","_this","possibleAwait","cleanup","decrementExpectedAwaits","resolve","reject","propagateToListener","Listener","nativeAwaitCompatibleWrap","type","handler","err","PromiseReject","onFinally","ms","handle","snapShot","zone","values","onPossibleParallellAsync","remaining","newScope","usePSD","zoneProps","run_at_end_of_this_or_next_physical_tick","possiblePromises","results","reason","failure","promise","shouldExecuteTick","beginMicroTickScope","propagateAllListeners","endMicroTickScope","ex","addPossiblyUnhandledError","listeners","len","finalizePhysicalTick","listener","cb","callListener","ret","markErrorAsHandled","e","wasRootExec","callbacks","unhandledErrs","finalizers","finalizer","wrap","errorCatcher","outerScope","switchToZone","task","taskCounter","zoneStack","zoneEchoes","zone_id_counter","a1","a2","parent","incrementExpectedAwaits","possiblePromise","rejection","zoneEnterEcho","targetZone","zoneLeaveEcho","bEnteringZone","currentZone","GlobalPromise","targetEnv","a3","outerZone","execInGlobalContext","tempTransaction","db","mode","storeNames","trans","DEXIE_VERSION","maxString","minKey","INVALID_KEY_ARGUMENT","STRING_EXPECTED","connections","DBNAMES_DB","READONLY","READWRITE","combine","filter1","filter2","AnyRange","workaroundForUndefinedPrimKey","Entity","cmp","ta","tb","compareUint8Arrays","getUint8Array","compareArrays","al","bl","tsTag","Table","writeLocked","tableName","checkTableInTransaction","keyOrCrit","indexOrCrit","keyPaths","compoundIndex","ix","keyPathsInValidOrder","idxByName","idb","equals","_a","prevIndex","prevFilterFn","index","idx","filterFunction","thenShortcut","offset","numRows","constructor","_super","class_1","inheritedProps","propName","readHook","Class","content","auto","objToAdd","lastResult","keyOrObject","objects","keysOrOptions","wantResults","numObjects","objectsToAdd","numFailures","objectsToPut","keysAndChanges","coreTable","entry","changeSpecs","offsetMap","objs","resultKeys","resultObjs","changes","_i","_b","numEntries","mappedOffset","numKeys","Events","ctx","evs","eventName","subscriber","add","chainFunction","defaultFunction","addConfiguredEvents","context","cfg","makeClassConstructor","prototype","createTableConstructor","tableSchema","isPlainKeyRange","ignoreLimitFilter","addFilter","addReplayFilter","factory","isLimitFilter","curr","addMatchFilter","getIndexOrStore","coreSchema","openCursor","iter","coreTrans","set_1","union","cursor","advance","primaryKey","iterate","cursorPromise","valueMapper","mappedFn","c","wrappedFn","advancer","PropModification","spec","term","subtrahend_1","prefixToReplace","Collection","count","parts","lastPart","lastIndex","getval","order","sorter","aVal","bVal","valueMapper_1","a_1","offsetLeft","rowsLeft","bIncludeStopEntry","indexName","set","strKey","found","modifyer","anythingModified","origVal","outbound","extractKey","limit","totalFailures","applyMutateResult","expectedCount","nextChunk","addValues","putValues","putKeys","deleteKeys","origValue","ctx_1","criteria","deleteCallback","range","coreRange","createCollectionConstructor","whereClause","keyRangeGenerator","keyRange","error","whereCtx","table","readingHook","simpleCompare","simpleCompareReverse","fail","collectionOrWhereClause","T","collection","WhereClause","emptyCollection","rangeEqual","upperFactory","dir","lowerFactory","nextCasing","lowerKey","upperNeedle","lowerNeedle","length","llp","lwrKeyChar","addIgnoreCaseAlgorithm","match","needles","suffix","upper","lower","compare","upperNeedles","lowerNeedles","direction","nextKeySuffix","needlesLen","initDirection","needleBounds","needle","nb","createRange","firstPossibleNeedle","lowestPossibleCasing","casing","lowerOpen","upperOpen","includeLower","includeUpper","str","ranges","ascending","descending","min","max","includeLowers","includeUppers","addRange","newRange","sortDirection","rangeSorter","rangePos","keyIsBeyondCurrentEntry","keyIsBeforeCurrentEntry","keyWithinCurrentRange","checkKey","createWhereClauseConstructor","orCollection","eventRejectHandler","event","preventDefault","DEXIE_STORAGE_MUTATED_EVENT_NAME","STORAGE_MUTATED_DOM_EVENT_NAME","globalEvents","Transaction","fnAndPSD","idbtrans","idbdb","dbOpenError","ev","bWriteLock","promiseLike","root","store","spin","currentWaitPromise","memoizedTables","transactionBoundTable","createTransactionConstructor","dbschema","chromeTransactionDurability","wasActive","createIndexSpec","unique","multi","compound","isPrimKey","nameFromKeyPath","createTableSchema","primKey","indexes","safariMultiStoreFix","getMaxKey","IdbKeyRange","getKeyExtractor","getSinglePathKeyExtractor","split","arrayify","_id_counter","getKeyPathAlias","createDBCore","tmpTrans","extractSchema","tables","autoIncrement","indexByKeyPath","multiEntry","makeIDBKeyRange","idbRange","createDbCoreTable","mutate","isAddOrPut","req","reqs","errorHandler","args1","args2","done","query","reverse","source","_cursorContinue","_cursorContinuePrimaryKey","_cursorAdvance","doThrowCursorIsNotStarted","doThrowCursorIsStopped","gotOne","iterationPromise","resolveIteration","rejectIteration","guardedCallback","hasGetAll","request","nonInfinitLimit","idbKeyRange","count_1","req_1","result_1","keyCount","callbackCount","successHandler","schema","tableMap","createMiddlewareStack","stackImpl","middlewares","down","create","createMiddlewareStacks","IDBKeyRange","dbcore","generateMiddlewareStacks","stacks","tbl","setApiOnPlace","tableNames","propDesc","removeTablesApi","lowerVersionFirst","runUpgraders","oldVersion","idbUpgradeTrans","globalSchema","parseIndexSyntax","rejectTransaction","transless","createTable","getExistingVersion","updateTablesAndIndexes","patchCurrentVersion","createMissingTables","buildGlobalSchema","adjustToExistingIndexNames","diff","getSchemaDiff","_loop_1","tableChange","addIndex","state_1","metaVersion","queue","versions","versToRun","version","oldSchema","newSchema","tuple","change","store_1","idxName","contentUpgrade","upgradeSchema_1","contentUpgradeIsAsync_1","returnValue_1","promiseFollowed","decrementor","deleteRemovedTables","runQueue","oldDef","newDef","oldIndexes","newIndexes","oldIdx","newIdx","storeName","dbStoreNames","j","idbindex","readGlobalSchema","verifyInstalledSchema","installedSchema","ch","dexieName","indexSpec","primKeyAndIndexes","indexNum","Version","stores","outSchema","storesSpec","upgradeFunction","createVersionConstructor","versionNumber","getDbNamesTable","indexedDB","dbNamesDB","Dexie$1","hasDatabasesNative","getDatabaseNames","infos","info","_onDatabaseCreated","_onDatabaseDeleted","vip","idbReady","isSafari","intervalId","tryIdb","isEmptyRange","node","RangeSet","fromOrTree","rangeSet","mergeRanges","getRangeSetIterator","target","left","right","rebalance","rightWasCutOff","newSet","_addRangeSet","r","rangesOverlap","rangeSet1","rangeSet2","i1","nextResult1","i2","nextResult2","state","keyProvided","rootClone","oldRootRight","computeDepth","extendObservabilitySet","part","obsSetsOverlap","os1","os2","cache","unsignaledParts","isTaskEnqueued","signalSubscribersLazily","optimistic","signalSubscribersNow","updatedParts","deleteAffectedCacheEntries","queriesToSignal","tblCache","collectTableSubscribers","dbName","requery","outQueriesToSignal","updatedEntryLists","entries","filteredEntries","_c","entries_1","_d","updatedEntryLists_1","_e","dexieOpen","openCanceller","nativeVerToOpen","schemaPatchMode","throwIfCancelled","resolveDbReady","upgradeTransaction","wasCreated","tryOpenDB","delreq","oldVer","objectStoreNames","fireRemainders","remainders_1","everything_1","awaitIterator","iterator","callNext","doThrow","onSuccess","step","onError","getNext","next","extractTransactionArgs","_tableArgs_","scopeFunc","enterTransactionScope","parentTransaction","scopeFuncIsAsync","returnValue","pad","createVirtualIndexMiddleware","indexLookup","allVirtualIndexes","addVirtualIndexes","keyTail","lowLevelIndex","keyPathAlias","indexList","keyLength","isVirtual","virtualIndex","virtualKeyPath","findBestIndex","translateRange","translateRequest","createVirtualCursor","_continue","virtualCursor","virtualIndexMiddleware","getObjectDiff","prfx","ap","bp","apTypeName","bpTypeName","getEffectiveKeys","hooksMiddleware","downCore","downTable","tableMiddleware","dxTrans","deleting","creating","updating","addPutOrDelete","deleteRange","getExistingValues","existingValues","contexts","existingValue","generatedPrimaryKey","objectDiff","additionalChanges_1","requestedValue_1","deleteNextChunk","effectiveKeys","getFromTransactionCache","clone","cacheExistingValuesMiddleware","core","cachedResult","isCachableContext","isCachableRequest","observabilityMiddleware","FULL_RANGE","indexesWithAutoIncPK","tableClone","mutatedParts","getRangeSet","pkRangeSet","delsRangeSet","id","newObjs","oldCache","oldObjs","trackAffectedIndexes","idxVals","pkPos","pk","getRange","readSubscribers","method","subscr","isLiveQuery","cachable","obsSet","pkRangeSet_1","delsRangeSet_1","queriedIndex","queriedRanges","keysPromise_1","resultingKeys","pKeys","cursor_1","wantValues_1","pkey","addAffectedIndex","addKeyOrKeys","_","oldKey","newKey","adjustOptimisticFromFailures","numBulkOps","isAboveLower","isBelowUpper","isWithinRange","applyOptimisticOps","ops","cacheEntry","immutable","queryRange","extractPrimKey","extractIndex","extractLowLevelIndex","finalResult","op","modifedResult","includedValues","keySet_1","keysToDelete_1","range_1","areRangesEqual","r1","r2","compareLowers","lower1","lower2","lowerOpen1","lowerOpen2","compareUppers","upper1","upper2","upperOpen1","upperOpen2","isSuperRange","findCompatibleQuery","queries","equalEntry","superEntry","countQuery","subscribeToCacheEntry","container","signal","enqueForDeletion","cacheMiddleware","coreMW","ac_1","endTransaction","wasCommitted","affectedSubscribers_1","stores_1","_f","_g","_h","freezeResults","modRes","tableMW","reqWithResolvedKeys","valueWithKey","adjustedReq","exactMatch","vipify","vipDb","receiver","Dexie","deps","addons","subscribe","bSticky","db_1","unsubscribe","vipDB","tx","addon","versionInstance","stack","level","mw","disableAutoOpen","closeOptions","hasInvalidArguments","doDelete","onlyIfCompatible","idbMode","enterTransaction","symbolObservable","Observable","complete","domDeps","liveQuery","querier","hasValue","currentValue","observable","observer","execute","closed","abortController","accumMuts","currentObs","subscription","startedListening","mutationListener","doQuery","_doQuery","shouldNotify","databaseName","generatorFn","promiseOrFunction","optionalTimeout","propagatingLocally","event_1","detail","propagateLocally","updateParts","wasMe","bc","createBC","changedParts","connections_1"],"mappings":"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","x_google_ignoreList":[0]}